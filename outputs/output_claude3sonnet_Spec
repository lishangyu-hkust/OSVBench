
Syscall sys_map_page_desc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_page_desc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 25.045s

OK

Syscall sys_map_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_proc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 22.669s

OK

Syscall sys_map_dev:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_dev (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 24.417s

OK

Syscall sys_map_file:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_file (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 24.310s

OK

Syscall sys_alloc_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pd (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 39.497s

OK

Syscall sys_alloc_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pt (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 40.796s

OK

Syscall sys_alloc_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 39.017s

OK

Syscall sys_copy_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_copy_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_copy_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 61, in sys_copy_frame
    new.pages[to].data = lambda idx, oldfn: old.pages[frm].data(idx)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 11.999s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_protect_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_protect_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 11.975s

OK

Syscall sys_free_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     5,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              6,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 5,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 6,
                      pages_owner.1(to.0) == current.0,
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pd (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pd (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 page_index.1!1233 = 0,
 from.0 = 8,
 (uintptr)@file_table.0 = 0,
 pn.3!1234 = 2053,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 2251799805329408,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 2053,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 index.1 = 8,
 pages_ptr_to_int.0 = 2251799805329408,
 k!1639 = [else ->
           If(ULE(16, Var(0)),
              If(ULE(17, Var(0)),
                 If(ULE(20, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       20),
                    17),
                 16),
              1)],
 procs_nr_ports.3 = [1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [16 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [32 -> 256,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 2048],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_fd.0 = [(0, 16) -> 2147483648,
                                       else -> 16],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 pages_owner.1 = [0 -> 16,
                  32 -> 16,
                  8 -> 16,
                  2053 -> 16,
                  256 -> 32,
                  2048 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 @pages.0 = [(0, 2053, 0) -> 82433,
             (0, 8, 8) -> 2251799813738497,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [1 -> 0,
                    20 -> 0,
                    32 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  32 -> 0,
                  20 -> 0,
                  1 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       20 -> 0,
                       32 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::pid.0!1647 = [(0, 2048) ->
                                        32,
                                        (0, 256) -> 32,
                                        else -> 16],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 pages_data.1 = [(2053, 0) -> 82433,
                 else -> 2251799813738497],
 procs_nr_intremaps.3 = [1 -> 0,
                         20 -> 0,
                         32 -> 0,
                         17 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 32],
 procs_nr_children.3 = [1 -> 0,
                        20 -> 0,
                        32 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [32 -> 2048,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        20 -> 0,
                        32 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1645 = [(0, 32) ->
                                        4,
                                        (0, 8) -> 5,
                                        (0, 2053) -> 6,
                                        else -> 2],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [0 -> 2,
                 32 -> 4,
                 8 -> 5,
                 2053 -> 6,
                 256 -> 2,
                 2048 -> 2,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
... != []

----------------------------------------------------------------------
Ran 1 test in 20.734s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_free_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     6,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              7,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 6,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 7,
                      pages_owner.1(to.0) == current.0,
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 from.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 4398047039488,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 page_index.1!1235 = 64,
 to.0 = 17,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 8,
 pn.3!1236 = 17,
 index.1 = 0,
 pages_ptr_to_int.0 = 4398047039488,
 @proc_table->struct.proc::page_table_root.0!1802 = [(0, 32) ->
                                        32,
                                        else -> 1024],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 64],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1798(Var(0),
                                        k!1792(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    12 -> 0,
                    10 -> 0,
                    16 -> 0,
                    9 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::type.0!1799 = [(0,
                                        1024) ->
                                        4,
                                        (0, 0) -> 6,
                                        (0, 17) -> 7,
                                        (0, 32) -> 4,
                                        else -> 2],
 @proc_table->struct.proc::state.0!1800 = [(0, 8) -> 3,
                                        else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [(17, 64) -> 1, else -> 4398047109121],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1803(Var(0),
                                        k!1792(Var(1)))],
 procs_io_bitmap_a.1 = [10 -> 64,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1799(Var(0),
                                        k!1793(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 @page_desc_table->struct.page_desc::pid.0!1801 = [(0, 32) ->
                                        32,
                                        (0, 1) -> 32,
                                        (0, 128) -> 32,
                                        (0, 2) -> 10,
                                        (0, 64) -> 10,
                                        else -> 8],
 procs_page_table_root.1 = [8 -> 1024,
                            32 -> 32,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   12 -> 0,
                   10 -> 0,
                   16 -> 0,
                   9 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 2],
 procs_nr_ports.3 = [1 -> 0,
                     12 -> 0,
                     10 -> 0,
                     16 -> 0,
                     9 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [8 -> 512,
                  32 -> 128,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [8 -> 512,
                32 -> 1,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [10 -> 2,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [512 -> 8,
                  1024 -> 8,
                  0 -> 8,
                  17 -> 8,
                  128 -> 32,
                  1 -> 32,
                  32 -> 32,
                  2 -> 10,
                  64 -> 10,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 17, 64) -> 1,
             (0, 0, 0) -> 4398047109121,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 8],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [8 -> 3,
                  10 -> 0,
                  1 -> 0,
                  12 -> 0,
                  16 -> 0,
                  9 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       12 -> 0,
                       10 -> 0,
                       16 -> 0,
                       9 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [1 -> 0,
                     12 -> 0,
                     10 -> 0,
                     16 -> 0,
                     9 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         12 -> 0,
                         10 -> 0,
                         16 -> 0,
                         9 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.772s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_free_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     7,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              3,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 7,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 3,
                      pages_owner.1(to.0) == current.0,
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 page_index.1!1107 = 1,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 from.0 = 4096,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 32768,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pn.3!1108 = 1,
 to.0 = 1,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 32,
 index.1 = 0,
 pages_ptr_to_int.0 = 32768,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 36865],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1521(Var(0),
                                        k!1515(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 36865],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    48 -> 0,
                    36 -> 0,
                    33 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 36865],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 36865],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 36865],
 procs_ipc_size.1 = [else -> 36865],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 36865],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 36865],
 pages_data.1 = [(1, 1) -> 1, else -> 36865],
 files_refcnt.4 = [else -> 36865],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [32 -> 0,
                        48 -> 2,
                        36 -> 32,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1522(Var(0),
                                        k!1516(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 k!1516 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(16, Var(0)),
                       If(ULE(32, Var(0)),
                          If(ULE(512, Var(0)),
                             If(ULE(4096, Var(0)),
                                If(ULE(8193, Var(0)),
                                   8193,
                                   4096),
                                512),
                             32),
                          16),
                       4),
                    2),
                 1),
              0)],
 @page_desc_table->struct.page_desc::pid.0!1524 = [(0, 32) ->
                                        36,
                                        (0, 4) -> 36,
                                        (0, 2) -> 48,
                                        (0, 512) -> 48,
                                        else -> 32],
 procs_page_table_root.1 = [32 -> 16,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 k!1515 = [else ->
           If(ULE(32, Var(0)),
              If(ULE(33, Var(0)),
                 If(ULE(36, Var(0)),
                    If(ULE(48, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          48),
                       36),
                    33),
                 32),
              1)],
 procs_nr_fds.3 = [1 -> 0,
                   48 -> 0,
                   36 -> 0,
                   33 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::type.0!1522 = [(0, 16) ->
                                        4,
                                        (0, 4096) -> 7,
                                        (0, 1) -> 3,
                                        else -> 2],
 procs_intr.1 = [else -> 36865],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 36865],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1525(Var(0),
                                        k!1515(Var(1)))],
 procs_nr_ports.3 = [1 -> 0,
                     48 -> 0,
                     36 -> 0,
                     33 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 36865],
 procs_stack.1 = [32 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0!1521 = [(0, 36) ->
                                        32,
                                        (0, 48) -> 2,
                                        else -> 0],
 procs_hvm.1 = [32 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [32 -> 0,
                        48 -> 512,
                        36 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 36865],
 pages_owner.1 = [0 -> 32,
                  16 -> 32,
                  4096 -> 32,
                  1 -> 32,
                  512 -> 48,
                  2 -> 48,
                  4 -> 36,
                  32 -> 36,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_b.0!1525 = [(0, 36) ->
                                        4,
                                        (0, 48) -> 512,
                                        else -> 0],
 @pages.0 = [(0, 1, 1) -> 1,
             (0, 4096, 0) -> 36865,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 32],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [32 -> 3,
                  1 -> 0,
                  36 -> 0,
                  48 -> 0,
                  33 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.783s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_reclaim_page:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.4, page_index.1],
       Implies(And(ULT(pn.4, 8192), ULT(page_index.1, 512)),
               @pages.0(0, pn.4, page_index.1) ==
               If(And(Not(ULE(8192, pn.3)),
                      Not(pages_type.1(pn.3) == 0),
                      And(Not(pages_owner.1(pn.3) <= 0),
                          Not(64 <= pages_owner.1(pn.3))),
                      procs_state.1(pages_owner.1(pn.3)) ==
                      5,
                      procs_nr_devs.3(pages_owner.1(pn.3)) ==
                      0),
                  If(pn.3 == pn.4,
                     0,
                     pages_data.1(pn.4, page_index.1)),
                  pages_data.1(pn.4, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_page (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_page (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 page_index.1!1060 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pn.4!1061 = 1,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 10,
 pn.3 = 1,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 10],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 1024],
 @proc_table->struct.proc::ipc_page.0 = [else -> 10],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 @page_desc_table->struct.page_desc::pid.0!1480 = [(0, 1) ->
                                        1,
                                        (0, 1024) -> 12,
                                        (0, 4) -> 12,
                                        else -> 10],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    16 -> 0,
                    12 -> 0,
                    32 -> 0,
                    11 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 10],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 10],
 @proc_table.3 = [else -> 10],
 procs_ppid.1 = [else -> 10],
 procs_ipc_size.1 = [else -> 10],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 10],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 10],
 pages_data.1 = [else -> 9223372036854775808],
 files_refcnt.4 = [else -> 10],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 128],
 procs_io_bitmap_a.1 = [12 -> 1024,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1478(Var(0),
                                        k!1473(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 k!1473 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(4, Var(0)),
                 If(ULE(33, Var(0)),
                    If(ULE(128, Var(0)),
                       If(ULE(1024, Var(0)),
                          If(ULE(8193, Var(0)), 8193, 1024),
                          128),
                       33),
                    4),
                 1),
              0)],
 procs_page_table_root.1 = [10 -> 33,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 k!1472 = [else ->
           If(ULE(10, Var(0)),
              If(ULE(11, Var(0)),
                 If(ULE(12, Var(0)),
                    If(ULE(16, Var(0)),
                       If(ULE(32, Var(0)),
                          If(ULE(64, Var(0)),
                             If(ULE(65, Var(0)), 65, 64),
                             32),
                          16),
                       12),
                    11),
                 10),
              1)],
 procs_nr_fds.3 = [16 -> 0,
                   12 -> 0,
                   32 -> 0,
                   11 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 10],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 10],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 4],
 procs_nr_ports.3 = [16 -> 0,
                     12 -> 0,
                     32 -> 0,
                     11 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 10],
 procs_stack.1 = [10 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [10 -> 128,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [12 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [(0, 10) -> 2147483648,
                                       else -> 16],
 @io_table.0 = [else -> 10],
 pages_owner.1 = [0 -> 10,
                  128 -> 10,
                  33 -> 10,
                  1 -> 1,
                  4 -> 12,
                  1024 -> 12,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 1, 0) -> 9223372036854775808,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 10],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [10 -> 3,
                  1 -> 5,
                  12 -> 0,
                  32 -> 0,
                  16 -> 0,
                  11 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [16 -> 0,
                       12 -> 0,
                       32 -> 0,
                       11 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1479 = [(0, 10) -> 3,
                                        (0, 1) -> 5,
                                        else -> 0],
 @page_desc_table.0 = [else -> 10],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [16 -> 0,
                     12 -> 0,
                     32 -> 0,
                     11 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [16 -> 0,
                         12 -> 0,
                         32 -> 0,
                         11 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [16 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 15.218s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_set_runnable:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_set_runnable (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_set_runnable (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 56, in sys_set_runnable
    new.procs[pid].ready.next = old.current
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 3.219s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall switch_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_switch_proc (__main__.HV6) ... ERROR

======================================================================
ERROR: test_switch_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 61, in switch_proc
    old.procs[old.current].ready.prev)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 6.835s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_kill:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_kill (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_kill (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 63, in sys_kill
    new.procs[pid].ready.prev,
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 4.474s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_reap:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_reap (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 15.357s

OK

Syscall sys_reparent:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(pid.3 > 0, pid.3 < 64),
    procs_state.1(procs_ppid.1(pid.3)) == 5,
    Or(procs_state.1(1) == 2, procs_state.1(1) == 3)) ==
(If(Not(ULE(63, 18446744073709551615 + pid.3)),
    If(Not(ULE(63,
               18446744073709551615 +
               @proc_table->struct.proc::ppid.0(0, pid.3))),
       If(@proc_table->struct.proc::state.0(0,
                                        @proc_table->struct.proc::ppid.0(0,
                                        pid.3)) ==
          5,
          If(Extract(63,
                     1,
                     @proc_table->struct.proc::state.0(0, 1)) ==
             1,
             0,
             4294967274),
          4294967274),
       4294967274),
    4294967293) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reparent (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reparent (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 8,
 pid.3 = 32,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1415(Var(0),
                                        k!1409(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1416(Var(0),
                                        k!1409(Var(1)))],
 @proc_table->struct.proc::state.0!1418 = [(0, 8) -> 3,
                                        (0, 1) -> 2,
                                        else -> 0],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [16 -> 0,
                    32 -> 0,
                    10 -> 0,
                    4 -> 0,
                    9 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::pid.0!1419 = [(0, 256) ->
                                        1,
                                        (0, 2048) -> 1,
                                        (0, 1024) -> 2,
                                        (0, 128) -> 2,
                                        (0, 8) -> 2,
                                        (0, 2049) -> 16,
                                        (0, 64) -> 16,
                                        (0, 512) -> 10,
                                        (0, 16) -> 10,
                                        else -> 8],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 128],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1422(Var(0),
                                        k!1409(Var(1)))],
 @page_desc_table->struct.page_desc::type.0!1417 = [(0, 0) ->
                                        4,
                                        (0, 1024) -> 4,
                                        (0, 256) -> 4,
                                        else -> 2],
 procs_io_bitmap_a.1 = [16 -> 2049,
                        10 -> 512,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [(0, 32) -> 128,
                                     else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1417(Var(0),
                                        k!1410(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::io_bitmap_b.0!1420 = [(0, 10) ->
                                        16,
                                        else -> 64],
 procs_page_table_root.1 = [8 -> 0,
                            1 -> 256,
                            2 -> 1024,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 @proc_table->struct.proc::hvm.0!1422 = [(0, 1) -> 2048,
                                        (0, 2) -> 128,
                                        else -> 2],
 procs_nr_fds.3 = [16 -> 0,
                   32 -> 0,
                   10 -> 0,
                   4 -> 0,
                   9 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1420(Var(0),
                                        k!1409(Var(1)))],
 @proc_table->struct.proc::io_bitmap_a.0!1415 = [(0, 10) ->
                                        512,
                                        else -> 2049],
 procs_nr_ports.3 = [16 -> 0,
                     32 -> 0,
                     10 -> 0,
                     4 -> 0,
                     9 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [8 -> 1,
                  1 -> 2048,
                  2 -> 8,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [8 -> 2,
                1 -> 2048,
                2 -> 128,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [16 -> 64,
                        10 -> 16,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [1 -> 8,
                  2 -> 8,
                  0 -> 8,
                  2048 -> 1,
                  256 -> 1,
                  8 -> 2,
                  128 -> 2,
                  1024 -> 2,
                  64 -> 16,
                  2049 -> 16,
                  16 -> 10,
                  512 -> 10,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 8],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [8 -> 3,
                  128 -> 5,
                  1 -> 2,
                  16 -> 0,
                  32 -> 0,
                  10 -> 0,
                  4 -> 0,
                  9 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [16 -> 0,
                       32 -> 0,
                       10 -> 0,
                       4 -> 0,
                       9 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
... != []

----------------------------------------------------------------------
Ran 1 test in 8.104s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall recv_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_recv_proc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 17.456s

OK

Syscall call_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(63, 18446744073709551615 + pid.3)),
                  If(@proc_table->struct.proc::state.0(0,
                                        pid.3) ==
                     4,
                     If(Not(ULE(8192, inpn.0)),
                        If(@page_desc_table->struct.page_desc::pid.0(0,
                                        inpn.0) ==
                           @current.0(0),
                           If(Not(And(Extract(63,
                                        13,
                                        size.0) ==
                                      0,
                                      ULE(Extract(12,
                                        0,
                                        size.0),
                                        4096))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1),
                              If(Not(ULE(8192, outpn.0)),
                                 If(@page_desc_table->struct.page_desc::pid.0(0,
                                        outpn.0) ==
                                    @current.0(0),
                                    If(@page_desc_table->struct.page_desc::type.0(0,
                                        outpn.0) ==
                                       3,
                                       If(Not(ULE(16,
                                        outfd.0)),
                                        If(Not(ULE(127,
                                        18446744073709551615 +
                                        @proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, outfd.0)))),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                        If(Or(@proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        0,
                                        @proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        @current.0(0)),
                                        If(And(pn.3 ==
                                        If(@current.0(0) ==
                                        pid.3,
                                        outpn.0,
                                        @proc_table->struct.proc::ipc_page.0(0,
                                        pid.3)),
                                        Not(ULE(size.0,
                                        page_index.1))),
                                        @pages.0(0,
                                        inpn.0,
                                        page_index.1),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                        If(Or(@proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        0,
                                        @proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        @current.0(0)),
                                        If(And(pn.3 ==
                                        If(@current.0(0) ==
                                        pid.3,
                                        outpn.0,
                                        @proc_table->struct.proc::ipc_page.0(0,
                                        pid.3)),
                                        Not(ULE(size.0,
                                        page_index.1))),
                                        @pages.0(0,
                                        inpn.0,
                                        page_index.1),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(And(Not(pid.3 <= 0), Not(64 <= pid.3)),
                      procs_state.1(pid.3) == 4,
                      Not(ULE(8192, inpn.0)),
                      pages_owner.1(inpn.0) == current.0,
                      And(Extract(63, 13, size.0) == 0,
                          ULE(Extract(12, 0, size.0), 4096)),
                      Not(ULE(8192, outpn.0)),
                      pages_owner.1(outpn.0) == current.0,
                      pages_type.1(outpn.0) == 3,
                      Or(Not(And(0 <= outfd.0,
                                 Not(16 <= outfd.0))),
                         And(And(0 <= outfd.0,
                                 Not(16 <= outfd.0)),
                             Or(procs_ofile.1(current.0,
                                        outfd.0) ==
                                0,
                                Not(And(Not(procs_ofile.1(current.0,
                                        outfd.0) ==
                                        0),
                                        Not(ULE(128,
                                        procs_ofile.1(current.0,
                                        outfd.0)))))))),
                      Or(procs_ipc_from.1(pid.3) == 0,
                         procs_ipc_from.1(pid.3) ==
                         current.0),
                      Not(pid.3 == current.0)),
                  If(pn.3 ==
                     If(current.0 == pid.3,
                        outpn.0,
                        procs_ipc_page.1(pid.3)),
                     pages_data.1(inpn.0, page_index.1),
                     pages_data.1(pn.3, page_index.1)),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_call_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_call_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 inpn.0 = 1,
 proc_table_ptr_to_int.0 = 0,
 size.0 = 1,
 outpn.0 = 1,
 outfd.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 pid.3 = 32,
 page_index.1!1086 = 256,
 pages_ptr_to_int.0 = 0,
 pn.3!1087 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 0],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1309(Var(0),
                                        k!1303(Var(1)))],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1310(Var(0),
                                        k!1303(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [(0, 32) -> 16,
                                        else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [48 -> 0,
                    1 -> 0,
                    24 -> 0,
                    36 -> 0,
                    33 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 @proc_table->struct.proc::state.0!1312 = [(0, 16) -> 3,
                                        (0, 32) -> 4,
                                        else -> 0],
 @page_desc_table->struct.page_desc::type.0!1311 = [(0,
                                        1024) ->
                                        4,
                                        (0, 0) -> 3,
                                        (0, 2048) -> 4,
                                        (0, 1) -> 3,
                                        else -> 2],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 procs_ipc_from.1 = [else -> 16],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 @proc_table->struct.proc::io_bitmap_a.0!1309 = [(0, 17) ->
                                        544,
                                        else -> 32],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [(1, 256) -> 1, else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1316(Var(0),
                                        k!1303(Var(1)))],
 procs_io_bitmap_a.1 = [24 -> 32,
                        17 -> 544,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 k!1304 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(128, Var(0)),
                          If(ULE(512, Var(0)),
                             If(ULE(544, Var(0)),
                                If(ULE(1024, Var(0)),
                                   If(ULE(1026, Var(0)),
                                      If(ULE(2048, Var(0)),
                                        If(ULE(4096, Var(0)),
                                        If(ULE(8193, Var(0)),
                                        8193,
                                        4096),
                                        2048),
                                        1026),
                                      1024),
                                   544),
                                512),
                             128),
                          32),
                       4),
                    2),
                 1),
              0)],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1311(Var(0),
                                        k!1304(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 k!1303 = [else ->
           If(ULE(16, Var(0)),
              If(ULE(17, Var(0)),
                 If(ULE(24, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(33, Var(0)),
                          If(ULE(36, Var(0)),
                             If(ULE(48, Var(0)),
                                If(ULE(65, Var(0)), 65, 48),
                                36),
                             33),
                          32),
                       24),
                    17),
                 16),
              1)],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::io_bitmap_b.0!1314 = [(0, 17) ->
                                        4,
                                        else -> 1026],
 procs_page_table_root.1 = [16 -> 1024,
                            32 -> 2048,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [48 -> 0,
                   1 -> 0,
                   24 -> 0,
                   36 -> 0,
                   33 -> 0,
                   17 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1314(Var(0),
                                        k!1303(Var(1)))],
 procs_nr_ports.3 = [48 -> 0,
                     1 -> 0,
                     24 -> 0,
                     36 -> 0,
                     33 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 512,
                  32 -> 4096,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [16 -> 2,
                32 -> 128,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [24 -> 1026,
                        17 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [(0, 32) -> 2147483648,
                                       else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [512 -> 16,
                  2 -> 16,
                  1024 -> 16,
                  1 -> 16,
... != []

----------------------------------------------------------------------
Ran 1 test in 58.889s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_create:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_create (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 5.524s

OK

Syscall sys_close:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_close (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 18.128s

OK

Syscall sys_dup:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_dup (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 18.912s

OK

Syscall sys_lseek:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_lseek (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 4.180s

OK

Syscall sys_map_pcipage:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_map_pcipage (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_map_pcipage (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 43, in sys_map_pcipage
    old.pcipages[pcipn].owner == old.pci[old.pcipages[pcipn].owner].owner,
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 823, in __eq__
    return BoolRef(Z3_mk_eq(self.ctx_ref(), a.as_ast(), b.as_ast()), self.ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3core.py", line 1560, in Z3_mk_eq
    raise Z3Exception(lib().Z3_get_error_msg(a0, err))
Z3Exception: Sorts (_ BitVec 16) and (_ BitVec 64) are incompatible

----------------------------------------------------------------------
Ran 1 test in 10.785s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_root:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_iommu_root (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 9.259s

OK

Syscall sys_alloc_iommu_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           8,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 0,
                      Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 8,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pdpt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pdpt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 pn.3!1109 = 2048,
 (uintptr)@proc_table.0 = 0,
 page_index.1!1108 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 2048,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 220059393926156,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 32,
 index.1 = 0,
 pages_ptr_to_int.0 = 220059393926156,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 512],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1533(Var(0),
                                        k!1527(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    33 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @proc_table->struct.proc::page_table_root.0!1537 = [(0, 48) ->
                                        1152,
                                        else -> 128],
 k!1528 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(8, Var(0)),
                    If(ULE(128, Var(0)),
                       If(ULE(256, Var(0)),
                          If(ULE(512, Var(0)),
                             If(ULE(1024, Var(0)),
                                If(ULE(1152, Var(0)),
                                   If(ULE(2048, Var(0)),
                                      If(ULE(8193, Var(0)),
                                        8193,
                                        2048),
                                      1152),
                                   1024),
                                512),
                             256),
                          128),
                       8),
                    2),
                 1),
              0)],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 k!1527 = [else ->
           If(ULE(32, Var(0)),
              If(ULE(33, Var(0)),
                 If(ULE(36, Var(0)),
                    If(ULE(48, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          48),
                       36),
                    33),
                 32),
              1)],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1538(Var(0),
                                        k!1527(Var(1)))],
 procs_io_bitmap_a.1 = [32 -> 512,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1534(Var(0),
                                        k!1528(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [32 -> 128,
                            48 -> 1152,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   33 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::pid.0!1536 = [(0, 0) ->
                                        0,
                                        (0, 1152) -> 48,
                                        (0, 256) -> 48,
                                        (0, 8) -> 48,
                                        else -> 32],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 2],
 procs_nr_ports.3 = [1 -> 0,
                     33 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [32 -> 1,
                  48 -> 8,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [32 -> 1024,
                48 -> 256,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [32 -> 2,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [1 -> 32,
                  1024 -> 32,
                  128 -> 32,
                  2048 -> 32,
                  0 -> 0,
                  2 -> 32,
                  512 -> 32,
                  8 -> 48,
                  256 -> 48,
                  1152 -> 48,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 2048, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 32],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [32 -> 3,
                  36 -> 33554432,
                  1 -> 0,
                  33 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @proc_table->struct.proc::stack.0!1533 = [(0, 48) -> 8,
                                        else -> 1],
 procs_nr_vectors.3 = [1 -> 0,
                       33 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [1 -> 0,
                     33 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 21.690s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           9,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 0,
                      Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 9,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pd (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pd (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 1,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 18014398526783489,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pn.3!1118 = 1,
 page_index.1!1117 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 32,
 to.0 = 0,
 index.1 = 0,
 pages_ptr_to_int.0 = 18014398526783489,
 procs_nr_ports.3 = [1 -> 0,
                     36 -> 0,
                     48 -> 0,
                     33 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [32 -> 2,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [32 -> 4,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 4398046515328],
 @pci_table.0 = [else -> 4398046515328],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        4398046515328],
 @proc_table->struct.proc::ipc_page.0 = [else ->
                                        4398046515328],
 @proc_table->struct.proc::stack.0 = [else -> 2],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [2 -> 32,
                  4 -> 32,
                  1024 -> 32,
                  1 -> 32,
                  0 -> 0,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 4398046515328],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 k!1529 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(1024, Var(0)),
                       If(ULE(8193, Var(0)), 8193, 1024),
                       4),
                    2),
                 1),
              0)],
 @pages.0 = [(0, 1, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [1 -> 0,
                    36 -> 0,
                    48 -> 0,
                    33 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 32],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 k!1528 = [else ->
           If(ULE(32, Var(0)),
              If(ULE(33, Var(0)),
                 If(ULE(36, Var(0)),
                    If(ULE(48, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          48),
                       36),
                    33),
                 32),
              1)],
 procs_ipc_val.1 = [else -> 4398046515328],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [32 -> 3,
                  1 -> 0,
                  36 -> 0,
                  48 -> 0,
                  33 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 4398046515328],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 4398046515328],
 procs_ipc_size.1 = [else -> 4398046515328],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       36 -> 0,
                       48 -> 0,
                       33 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 4398046515328],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 4398046515328],
 procs_nr_pages.3 = [1 -> 0,
                     36 -> 0,
                     48 -> 0,
                     33 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 pages_data.1 = [else -> 0],
 procs_nr_intremaps.3 = [1 -> 0,
                         36 -> 0,
                         48 -> 0,
                         33 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 1024],
 procs_nr_children.3 = [1 -> 0,
                        36 -> 0,
                        48 -> 0,
                        33 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 files_refcnt.4 = [else -> 4398046515328],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 4],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        36 -> 0,
                        48 -> 0,
                        33 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 4398046515328],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::state.0!1535 = [(0, 32) -> 3,
                                        else -> 0],
 @page_desc_table->struct.page_desc::type.0!1534 = [(0,
                                        1024) ->
                                        4,
                                        (0, 0) -> 0,
                                        (0, 1) -> 9,
                                        else -> 2],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [2 -> 2,
                 4 -> 2,
                 1024 -> 4,
                 0 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.537s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           10,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 0,
                      pages_type.1(from.0) == 10,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 page_index.1!1320 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 pn.3!1321 = 64,
 (uintptr)@file_table.0 = 0,
 from.0 = 64,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 842088055040,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 576,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 2,
 index.1 = 0,
 pages_ptr_to_int.0 = 842088055040,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 1024],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 2],
 @proc_table->struct.proc::ipc_page.0 = [else -> 1024],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1820(Var(0),
                                        k!1814(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    4 -> 0,
                    32 -> 0,
                    3 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 1024],
 @page_desc_table->struct.page_desc::pid.0!1823 = [(0, 576) ->
                                        9223372036854775810,
                                        (0, 256) -> 1,
                                        (0, 512) -> 1,
                                        (0, 1024) -> 1,
                                        (0, 2) -> 32,
                                        (0, 32) -> 32,
                                        else -> 2],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 1024],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 1024],
 procs_ipc_size.1 = [else -> 1024],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 1024],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 @proc_table->struct.proc::page_table_root.0!1824 = [(0, 1) ->
                                        256,
                                        else -> 0],
 dmapages_type.1 = [else -> 1024],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 1024],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1825(Var(0),
                                        k!1814(Var(1)))],
 procs_io_bitmap_a.1 = [32 -> 2,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::hvm.0!1825 = [(0, 1) -> 512,
                                        else -> 8],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::stack.0!1820 = [(0, 1) -> 1024,
                                        else -> 8],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1821(Var(0),
                                        k!1815(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 k!1815 = [else ->
           If(ULE(2, Var(0)),
              If(ULE(8, Var(0)),
                 If(ULE(32, Var(0)),
                    If(ULE(64, Var(0)),
                       If(ULE(256, Var(0)),
                          If(ULE(512, Var(0)),
                             If(ULE(576, Var(0)),
                                If(ULE(1024, Var(0)),
                                   If(ULE(8193, Var(0)),
                                      8193,
                                      1024),
                                   576),
                                512),
                             256),
                          64),
                       32),
                    8),
                 2),
              0)],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [2 -> 0,
                            1 -> 256,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 k!1814 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(3, Var(0)),
                    If(ULE(4, Var(0)),
                       If(ULE(32, Var(0)),
                          If(ULE(64, Var(0)),
                             If(ULE(65, Var(0)), 65, 64),
                             32),
                          4),
                       3),
                    2),
                 1),
              0)],
 procs_nr_fds.3 = [1 -> 0,
                   4 -> 0,
                   32 -> 0,
                   3 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 1024],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 1024],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 32],
 procs_nr_ports.3 = [1 -> 0,
                     4 -> 0,
                     32 -> 0,
                     3 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 1024],
 procs_stack.1 = [2 -> 8,
                  1 -> 1024,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [2 -> 8,
                1 -> 512,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [32 -> 32,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 1024],
 pages_owner.1 = [8 -> 2,
                  0 -> 2,
                  64 -> 2,
                  576 -> 9223372036854775810,
                  1024 -> 1,
                  512 -> 1,
                  256 -> 1,
                  32 -> 32,
                  2 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 64, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 2],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [2 -> 3,
                  4 -> 0,
                  32 -> 0,
                  3 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       4 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.811s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(512, to.0)),
                  If(@dmapage_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           11,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                       (uintptr)@dmapages.0 +
                                       (to.0*32768)/8 |
                                       perm.0,
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(512, to.0)),
                      dmapages_type.1(to.0) == 0,
                      Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 11,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     dmapages_ptr_to_int.0 + to.0 << 12 |
                     perm.0,
                     pages_data.1(pn.3, page_index.1)),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 pn.3!1109 = 1,
 (uintptr)@proc_table.0 = 0,
 page_index.1!1108 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 1,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 70368746274888,
 file_table_ptr_to_int.0 = 0,
 to.0 = 0,
 (uintptr)@dmapages.0 = 70368746274888,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1520(Var(0),
                                        k!1514(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [4 -> 0,
                    32 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 0],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [4 -> 4,
                        32 -> 32,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [(0, 0) ->
                                        0,
                                        else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1521(Var(0),
                                        k!1515(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table->struct.proc::io_bitmap_a.0!1520 = [(0, 4) -> 4,
                                        else -> 32],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 @page_desc_table->struct.page_desc::type.0!1521 = [(0, 512) ->
                                        4,
                                        (0, 1) -> 11,
                                        else -> 2],
 procs_page_table_root.1 = [1 -> 512,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 k!1515 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(4, Var(0)),
                 If(ULE(32, Var(0)),
                    If(ULE(128, Var(0)),
                       If(ULE(512, Var(0)),
                          If(ULE(8193, Var(0)), 8193, 512),
                          128),
                       32),
                    4),
                 1),
              0)],
 procs_nr_fds.3 = [4 -> 0,
                   32 -> 0,
                   2 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 k!1514 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    2),
                 1),
              0)],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1524(Var(0),
                                        k!1514(Var(1)))],
 procs_nr_ports.3 = [4 -> 0,
                     32 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [1 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [4 -> 4,
                        32 -> 128,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [0 -> 1,
                  512 -> 1,
                  1 -> 1,
                  4 -> 4,
                  128 -> 32,
                  32 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1522 = [(0, 1) -> 3,
                                        else -> 0],
 @proc_table->struct.proc::io_bitmap_b.0!1524 = [(0, 4) -> 4,
                                        else -> 128],
 @pages.0 = [(0, 1, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  4 -> 0,
                  32 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [4 -> 0,
                       32 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [4 -> 0,
                     32 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [4 -> 0,
                         32 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
... != []

----------------------------------------------------------------------
Ran 1 test in 14.001s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_map_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_iommu_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 12.843s

OK

Syscall sys_reclaim_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(ULT(dmapn.1, 512),
    dmapages_type.1(dmapn.1) != 0,
    And(UGT(dmapages_owner.1(dmapn.1), 0),
        ULT(dmapages_owner.1(dmapn.1), 64),
        procs_state.1(dmapages_owner.1(dmapn.1)) == 5),
    False) ==
(If(Not(ULE(512, dmapn.1)),
    If(@dmapage_desc_table->struct.page_desc::type.0(0,
                                        dmapn.1) ==
       0,
       4294967274,
       If(Not(ULE(63,
                  18446744073709551615 +
                  @dmapage_desc_table->struct.page_desc::pid.0(0,
                                        dmapn.1))),
          If(@proc_table->struct.proc::state.0(0,
                                        @dmapage_desc_table->struct.page_desc::pid.0(0,
                                        dmapn.1)) ==
             5,
             If(@proc_table->struct.proc::nr_devs.0(0,
                                        @dmapage_desc_table->struct.page_desc::pid.0(0,
                                        dmapn.1)) ==
                0,
                0,
                4294967280),
             4294967283),
          4294967283)),
    4294967274) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_iommu_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_iommu_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 dmapn.1 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 2,
 pages_ptr_to_int.0 = 0,
 procs_nr_ports.3 = [1 -> 0,
                     3 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [2 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [2 -> 2,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [2 -> 16,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 32],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [1 -> 2,
                  2 -> 2,
                  0 -> 2,
                  16 -> 2,
                  32 -> 2,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [4 -> 0,
                    1 -> 0,
                    3 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 2],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [2 -> 3,
                  4 -> 5,
                  1 -> 0,
                  3 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 dmapages_owner.1 = [else -> 4],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 @proc_table.3 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!608 = [(0, 0) ->
                                        4,
                                        else -> 2],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       3 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 1],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [1 -> 0,
                     3 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         3 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        3 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 files_refcnt.4 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 2],
 procs_io_bitmap_a.1 = [2 -> 32,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_nr_dmapages.3 = [1 -> 0,
                        3 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @dmapage_desc_table->struct.page_desc::type.0 = [(0, 0) ->
                                        1,
                                        else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 k!603 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(2, Var(0)),
                If(ULE(16, Var(0)),
                   If(ULE(32, Var(0)),
                      If(ULE(8193, Var(0)), 8193, 32),
                      16),
                   2),
                1),
             0)],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 k!602 = [else ->
          If(ULE(2, Var(0)),
             If(ULE(3, Var(0)),
                If(ULE(4, Var(0)),
                   If(ULE(65, Var(0)), 65, 4),
                   3),
                2),
             1)],
 files_type.1 = [else -> 8192],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [1 -> 2,
                 2 -> 2,
                 0 -> 4,
                 16 -> 2,
                 32 -> 2,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!608(Var(0),
                                        k!603(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::state.0!609 = [(0, 2) -> 3,
                                        (0, 4) -> 5,
                                        else -> 0],
 procs_page_table_root.1 = [2 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 procs_ofile.1 = [else ->
                  @proc_table.0(0,
                                Var(0),
                                Concat(0, Var(1)))],
 pcipages_valid.1 = [else -> False],
... != []

----------------------------------------------------------------------
Ran 1 test in 5.776s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_reclaim_iommu_root:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(pci_owner.1(devid.1) > 0, pci_owner.1(devid.1) < 64),
    procs_state.1(pci_owner.1(devid.1)) == 5,
    False) ==
(If(Not(ULE(63,
            18446744073709551615 +
            @pci_table.0(0, Concat(0, devid.1)))),
    If(@proc_table->struct.proc::state.0(0,
                                        @pci_table.0(0,
                                        Concat(0, devid.1))) ==
       5,
       If(@proc_table->struct.proc::nr_intremaps.0(0,
                                        @pci_table.0(0,
                                        Concat(0, devid.1))) ==
          0,
          0,
          4294967280),
       4294967283),
    4294967283) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_iommu_root (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_iommu_root (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 devid.1 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = True,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = True,
 current.0 = 16,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 2],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 64],
 @proc_table->struct.proc::stack.0 = [else -> 1],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    18 -> 0,
                    24 -> 0,
                    20 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 1],
 procs_io_bitmap_a.1 = [20 -> 64,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!871(Var(0),
                                        k!866(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 pci_owner.1 = [0 -> 32,
                else -> @pci_table.0(0, Concat(0, Var(0)))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 procs_page_table_root.1 = [16 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   18 -> 0,
                   24 -> 0,
                   20 -> 0,
                   17 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 4],
 @proc_table->struct.proc::state.0!872 = [(0, 16) -> 3,
                                        (0, 32) -> 5,
                                        else -> 0],
 @pci_table.0 = [else -> 32],
 procs_nr_ports.3 = [1 -> 0,
                     18 -> 0,
                     24 -> 0,
                     20 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [16 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [16 -> 1,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [20 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 0],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [1 -> 16,
                  0 -> 16,
                  2 -> 16,
                  4 -> 20,
                  64 -> 20,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::pid.0!873 = [(0, 64) ->
                                        20,
                                        (0, 4) -> 20,
                                        else -> 16],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 16],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  32 -> 5,
                  1 -> 0,
                  20 -> 0,
                  18 -> 0,
                  24 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 k!866 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(2, Var(0)),
                If(ULE(4, Var(0)),
                   If(ULE(64, Var(0)),
                      If(ULE(8193, Var(0)), 8193, 64),
                      4),
                   2),
                1),
             0)],
 k!865 = [else ->
          If(ULE(16, Var(0)),
             If(ULE(17, Var(0)),
                If(ULE(18, Var(0)),
                   If(ULE(20, Var(0)),
                      If(ULE(24, Var(0)),
                         If(ULE(32, Var(0)),
                            If(ULE(65, Var(0)), 65, 32),
                            24),
                         20),
                      18),
                   17),
                16),
             1)],
 procs_nr_vectors.3 = [1 -> 0,
                       18 -> 0,
                       24 -> 0,
                       20 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [16 -> 2,
                     else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [1 -> 0,
                     18 -> 0,
                     24 -> 0,
                     20 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [32 -> 0,
                         1 -> 0,
                         18 -> 0,
                         24 -> 0,
                         20 -> 0,
                         17 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
... != []

----------------------------------------------------------------------
Ran 1 test in 3.597s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_vector:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_vector (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 2.499s

OK

Syscall sys_reclaim_vector:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(vectors_owner.1(vector.1) > 0,
        vectors_owner.1(vector.1) < 64),
    procs_state.1(vectors_owner.1(vector.1)) == 5,
    False) ==
(If(Not(ULE(63,
            18446744073709551615 +
            @vector_table.0(0, Concat(0, vector.1)))),
    If(@proc_table->struct.proc::state.0(0,
                                        @vector_table.0(0,
                                        Concat(0, vector.1))) ==
       5,
       If(@proc_table->struct.proc::nr_intremaps.0(0,
                                        @vector_table.0(0,
                                        Concat(0, vector.1))) ==
          0,
          0,
          4294967280),
       4294967283),
    4294967283) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_vector (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_vector (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 vector.1 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 40,
 pages_ptr_to_int.0 = 0,
 procs_nr_ports.3 = [1 -> 0,
                     48 -> 0,
                     44 -> 0,
                     41 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [40 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [40 -> 1,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [1 -> 40,
                  0 -> 40,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    48 -> 0,
                    44 -> 0,
                    41 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 40],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [40 -> 3,
                  32 -> 5,
                  1 -> 0,
                  48 -> 0,
                  44 -> 0,
                  41 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       48 -> 0,
                       44 -> 0,
                       41 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     48 -> 0,
                     44 -> 0,
                     41 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [32 -> 0,
                         1 -> 0,
                         48 -> 0,
                         44 -> 0,
                         41 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        48 -> 0,
                        44 -> 0,
                        41 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 vectors_owner.1 = [0 -> 32,
                    else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 1],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        48 -> 0,
                        44 -> 0,
                        41 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::state.0!879 = [(0, 40) -> 3,
                                        (0, 32) -> 5,
                                        else -> 0],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 files_type.1 = [else -> 8192],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [1 -> 2,
                 0 -> 4,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!878(Var(0),
                                        k!873(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [40 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 procs_ofile.1 = [else ->
                  @proc_table.0(0,
                                Var(0),
                                Concat(0, Var(1)))],
 pcipages_valid.1 = [else -> False],
 @proc_table.0 = [else -> 1],
 @proc_table.4 = [else -> 0],
 @proc_table->struct.proc::state.0 = [else ->
                                      @proc_table->struct.proc::state.0!879(Var(0),
                                        k!872(Var(1)))],
 procs_nr_fds.3 = [1 -> 0,
                   48 -> 0,
                   44 -> 0,
                   41 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_ipc_fd.1 = [else ->
                   @proc_table->struct.proc::ipc_fd.0(0,
... != []

----------------------------------------------------------------------
Ran 1 test in 4.270s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_intremap:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
iotlbinv.0 == iotlbinv.1
does not imply
iotlbinv.0 ==
If(And(Not(ULE(8, index.1)),
       intremaps_state.1(index.1) == 0,
       pci_owner.1(devid.1) == current.0,
       vectors_owner.1(vector.1) == current.0),
   True,
   iotlbinv.1)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_intremap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_intremap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 devid.1 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 vector.1 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 4,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 @pci_table.0 = [else -> 4],
 procs_nr_ports.3 = [1 -> 0,
                     6 -> 0,
                     8 -> 0,
                     16 -> 0,
                     32 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [4 -> 2048,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 intremaps_state.1 = [else -> 0],
 procs_hvm.1 = [4 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @intremap_table->struct.intremap::state.0 = [(0, 0) -> 0,
                                        else ->
                                        intremaps_state.1(Var(1))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 2048],
 @io_table.0 = [else -> 0],
 pages_owner.1 = [2048 -> 4,
                  0 -> 4,
                  512 -> 4,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    6 -> 0,
                    8 -> 0,
                    16 -> 0,
                    32 -> 0,
                    5 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 4],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [4 -> 3,
                  16 -> 0,
                  32 -> 0,
                  6 -> 0,
                  1 -> 0,
                  8 -> 0,
                  5 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1758 = [(0, 512) ->
                                        4,
                                        else -> 2],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       6 -> 0,
                       8 -> 0,
                       16 -> 0,
                       32 -> 0,
                       5 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1759 = [(0, 4) -> 3,
                                        else -> 0],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     6 -> 0,
                     8 -> 0,
                     16 -> 0,
                     32 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         6 -> 0,
                         8 -> 0,
                         16 -> 0,
                         32 -> 0,
                         5 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        6 -> 0,
                        8 -> 0,
                        16 -> 0,
                        32 -> 0,
                        5 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 512],
 vectors_owner.1 = [0 -> 4,
                    else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        6 -> 0,
                        8 -> 0,
                        16 -> 0,
                        32 -> 0,
                        5 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 k!1753 = [else ->
           If(ULE(512, Var(0)),
              If(ULE(2048, Var(0)),
                 If(ULE(8193, Var(0)), 8193, 2048),
                 512),
              0)],
 pages_type.1 = [2048 -> 2,
                 0 -> 2,
                 512 -> 4,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 k!1752 = [else ->
           If(ULE(4, Var(0)),
              If(ULE(5, Var(0)),
                 If(ULE(6, Var(0)),
... != []

----------------------------------------------------------------------
Ran 1 test in 9.147s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_reclaim_intremap:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
iotlbinv.0 == iotlbinv.1
does not imply
iotlbinv.0 ==
If(And(Not(ULE(8, index.1)),
       intremaps_state.1(index.1) == 1,
       And(Not(pci_owner.1(intremaps_devid.1(index.1)) <= 0),
           Not(64 <= pci_owner.1(intremaps_devid.1(index.1))),
           procs_state.1(pci_owner.1(intremaps_devid.1(index.1))) ==
           5)),
   True,
   iotlbinv.1)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_intremap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_intremap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 4,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 intremaps_state.1 = [else -> 1],
 @intremap_table->struct.intremap::state.0 = [(0, 0) -> 1,
                                        else ->
                                        intremaps_state.1(Var(1))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 2048],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 128],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1261(Var(0),
                                        k!1255(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [32 -> 0,
                    8 -> 0,
                    16 -> 0,
                    6 -> 0,
                    5 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @proc_table->struct.proc::stack.0!1261 = [(0, 32) -> 4096,
                                        else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 @proc_table->struct.proc::state.0!1263 = [(0, 4) -> 3,
                                        (0, 1) -> 5,
                                        else -> 0],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1266(Var(0),
                                        k!1255(Var(1)))],
 procs_io_bitmap_a.1 = [5 -> 128,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1262(Var(0),
                                        k!1256(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 pci_owner.1 = [0 -> 1,
                else -> @pci_table.0(0, Concat(0, Var(0)))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 @page_desc_table->struct.page_desc::type.0!1262 = [(0,
                                        2048) ->
                                        3,
                                        (0, 8) -> 4,
                                        (0, 1024) -> 4,
                                        else -> 2],
 procs_page_table_root.1 = [4 -> 8,
                            32 -> 1024,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [32 -> 0,
                   8 -> 0,
                   16 -> 0,
                   6 -> 0,
                   5 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 2],
 k!1256 = [else ->
           If(ULE(2, Var(0)),
              If(ULE(8, Var(0)),
                 If(ULE(64, Var(0)),
                    If(ULE(128, Var(0)),
                       If(ULE(1024, Var(0)),
                          If(ULE(2048, Var(0)),
                             If(ULE(4096, Var(0)),
                                If(ULE(8193, Var(0)),
                                   8193,
                                   4096),
                                2048),
                             1024),
                          128),
                       64),
                    8),
                 2),
              0)],
 k!1255 = [else ->
           If(ULE(4, Var(0)),
              If(ULE(5, Var(0)),
                 If(ULE(6, Var(0)),
                    If(ULE(8, Var(0)),
                       If(ULE(16, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(64, Var(0)),
                                If(ULE(65, Var(0)), 65, 64),
                                32),
                             16),
                          8),
                       6),
                    5),
                 4),
              1)],
 procs_nr_ports.3 = [32 -> 0,
                     8 -> 0,
                     16 -> 0,
                     6 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 1],
 procs_stack.1 = [4 -> 0,
                  32 -> 4096,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [4 -> 0,
                32 -> 64,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [5 -> 2,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 0],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [0 -> 4,
                  8 -> 4,
                  2048 -> 4,
                  4096 -> 32,
                  64 -> 32,
                  1024 -> 32,
                  2 -> 5,
                  128 -> 5,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @proc_table->struct.proc::hvm.0!1266 = [(0, 32) -> 64,
                                        else -> 0],
 @current.0 = [else -> 4],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 @page_desc_table->struct.page_desc::pid.0!1264 = [(0, 1024) ->
                                        32,
                                        (0, 64) -> 32,
                                        (0, 4096) -> 32,
                                        (0, 128) -> 5,
                                        (0, 2) -> 5,
                                        else -> 4],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [4 -> 3,
                  1 -> 5,
                  16 -> 0,
                  6 -> 0,
                  8 -> 0,
                  5 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 41.733s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_ack_intr:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_ack_intr (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_ack_intr (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 44, in sys_ack_intr
    mask = ~(z3.BitVecVal(1, 64) << (v % 64))
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 3412, in __lshift__
    return BitVecRef(Z3_mk_bvshl(self.ctx_ref(), a.as_ast(), b.as_ast()), self.ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3core.py", line 1945, in Z3_mk_bvshl
    raise Z3Exception(lib().Z3_get_error_msg(a0, err))
Z3Exception: Argument (bvsmod vector.1 #x40) at position 1 does not match declaration (declare-fun bvshl ((_ BitVec 64) (_ BitVec 64)) (_ BitVec 64))

----------------------------------------------------------------------
Ran 1 test in 0.806s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_port:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_port (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 108.646s

OK

Syscall sys_reclaim_port:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_reclaim_port (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 3.243s

OK

Syscall sys_alloc_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pdpt (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 41.622s

OK

Syscall sys_free_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     4,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              5,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 4,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 5,
                      pages_owner.1(to.0) == current.0,
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pdpt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pdpt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 page_index.1!1101 = 4,
 (uintptr)@file_table.0 = 0,
 pn.3!1102 = 5124,
 from.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 1688849862377472,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 5124,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 index.1 = 0,
 pages_ptr_to_int.0 = 1688849862377472,
 procs_nr_ports.3 = [32 -> 0,
                     4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 1024,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [1 -> 8,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [2 -> 256,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 16],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1024],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [1024 -> 1,
                  8 -> 1,
                  513 -> 1,
                  0 -> 1,
                  5124 -> 1,
                  256 -> 2,
                  16 -> 2,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 @pages.0 = [(0, 5124, 4) -> 1152921504606846976,
             (0, 0, 0) -> 1688849883365377,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [32 -> 0,
                    4 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 k!1507 = [else ->
           If(ULE(8, Var(0)),
              If(ULE(16, Var(0)),
                 If(ULE(256, Var(0)),
                    If(ULE(513, Var(0)),
                       If(ULE(1024, Var(0)),
                          If(ULE(5124, Var(0)),
                             If(ULE(8193, Var(0)),
                                8193,
                                5124),
                             1024),
                          513),
                       256),
                    16),
                 8),
              0)],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  32 -> 0,
                  4 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 k!1506 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    2),
                 1),
              0)],
 @proc_table.3 = [else -> 0],
 dmapages_owner.1 = [else -> 8192],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [32 -> 0,
                       4 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::pid.0!1514 = [(0, 16) ->
                                        2,
                                        (0, 256) -> 2,
                                        else -> 1],
 procs_nr_pages.3 = [32 -> 0,
                     4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 pages_data.1 = [(5124, 4) -> 1152921504606846976,
                 else -> 1688849883365377],
 procs_nr_intremaps.3 = [32 -> 0,
                         4 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 513],
 procs_nr_children.3 = [32 -> 0,
                        4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::state.0!1513 = [(0, 1) -> 3,
                                        else -> 0],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 8],
 procs_io_bitmap_a.1 = [2 -> 16,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 files_refcnt.4 = [else -> 8192],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [32 -> 0,
                        4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [1024 -> 2,
                 8 -> 2,
                 513 -> 4,
                 0 -> 4,
                 5124 -> 5,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.074s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall clone_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_clone_proc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 34.302s

OK

Syscall send_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_send_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_send_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 69, in send_proc
    new.pages[new.procs[pid].ipc_page].data = lambda idx, oldfn: \
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 21.556s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall reply_wait_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_reply_wait_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_reply_wait_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 95, in reply_wait_proc
    new.procs[pid].ofile = lambda fd, oldfn: \
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 46.097s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_dup2:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_dup2 (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_dup2 (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 75, in sys_dup2
    new.procs[pid].nr_fds(newfd) - 1,
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 41, in __call__
    return self._imap(instance)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 271, in __call__
    assert len(instance._path) == 1
AssertionError

----------------------------------------------------------------------
Ran 1 test in 30.829s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_io_bitmap:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_io_bitmap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_io_bitmap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 73, in sys_alloc_io_bitmap
    new.pages[pn1].data = lambda idx, oldfn: dt.MAX_INT64
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 18.152s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall extintr:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_extintr (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 4.698s

OK

Syscall sys_map_pml4:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_pml4 (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 19.903s

OK

Syscall sys_map_page_desc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_page_desc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 24.223s

OK

Syscall sys_map_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(ULT(n.0, 6),
    And(pid.3 > 0, pid.3 < 64),
    Or(pid.3 == current.0,
       And(procs_ppid.1(pid.3) == current.0,
           procs_state.1(pid.3) == 1)),
    ULT(from.0, 8192),
    pages_type.1(from.0) == 7,
    pages_owner.1(from.0) == pid.3,
    ULT(index.1, 512),
    perm.0 &
    (18446744073709551615 ^
     (1 |
      2 |
      4 |
      8 |
      16 |
      512 |
      1024 |
      2048 |
      9223372036854775808)) ==
    0,
    perm.0 & 1 != 0,
    perm.0 & 2 != 0,
    pages_data.1(from.0, index.1) & 1 == 0) ==
(If(Not(ULE(6, n.0)),
    If(Extract(1, 1, perm.0) == 0,
       If(Not(ULE(63, 18446744073709551615 + pid.3)),
          If(@current.0(0) == pid.3,
             If(Not(ULE(8192, from.0)),
                If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                   7,
                   If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                      pid.3,
                      If(And(Not(ULE(512, index.1)),
                             And(Extract(0, 0, perm.0) == 1,
                                 Extract(8, 5, perm.0) == 0,
                                 Extract(62, 12, perm.0) ==
                                 0)),
                         If(Extract(0,
                                    0,
                                    @pages.0(0,
                                        from.0,
                                        index.1)) ==
                            0,
                            0,
                            4294967274),
                         4294967274),
                      4294967283),
                   4294967274),
                4294967274),
             If(@proc_table->struct.proc::ppid.0(0, pid.3) ==
                @current.0(0),
                If(@proc_table->struct.proc::state.0(0,
                                        pid.3) ==
                   1,
                   If(Not(ULE(8192, from.0)),
                      If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                         7,
                         If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                            pid.3,
                            If(And(Not(ULE(512, index.1)),
                                   And(Extract(0, 0, perm.0) ==
                                       1,
                                       Extract(8, 5, perm.0) ==
                                       0,
                                       Extract(62,
                                        12,
                                        perm.0) ==
                                       0)),
                               If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                  0,
                                  0,
                                  4294967274),
                               4294967274),
                            4294967283),
                         4294967274),
                      4294967274),
                   4294967283),
                4294967283)),
          4294967293),
       4294967283),
    4294967274) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_map_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_map_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 3,
 from.0 = 0,
 (uintptr)@file_table.0 = 0,
 n.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 2,
 pid.3 = 32,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1043(Var(0),
                                        k!1037(Var(1)))],
 @proc_table->struct.proc::page_table_root.0!1047 = [(0, 32) ->
                                        64,
                                        (0, 33) -> 4,
                                        else -> 4096],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    16 -> 0,
                    4 -> 0,
                    3 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 2],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1048(Var(0),
                                        k!1037(Var(1)))],
 @proc_table->struct.proc::stack.0!1043 = [(0, 32) -> 2,
                                        (0, 33) -> 32,
                                        else -> 1],
 procs_io_bitmap_a.1 = [16 -> 8,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @page_desc_table->struct.page_desc::type.0!1044 = [(0,
                                        4096) ->
                                        4,
                                        (0, 0) -> 7,
                                        (0, 64) -> 4,
                                        (0, 4) -> 4,
                                        else -> 2],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [(0, 32) -> 2,
                                     else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1044(Var(0),
                                        k!1038(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [2 -> 4096,
                            32 -> 64,
                            33 -> 4,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   16 -> 0,
                   4 -> 0,
                   3 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 4098],
 @proc_table->struct.proc::hvm.0!1048 = [(0, 32) -> 512,
                                        (0, 33) -> 256,
                                        else -> 1],
 procs_nr_ports.3 = [1 -> 0,
                     16 -> 0,
                     4 -> 0,
                     3 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [2 -> 1,
                  32 -> 2,
                  33 -> 32,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [2 -> 1,
                32 -> 512,
                33 -> 256,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [16 -> 4098,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [1 -> 2,
                  4096 -> 2,
                  0 -> 32,
                  2 -> 32,
                  512 -> 32,
                  64 -> 32,
                  32 -> 33,
                  256 -> 33,
                  4 -> 33,
                  4098 -> 16,
                  8 -> 16,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 0, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 k!1038 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(8, Var(0)),
                       If(ULE(32, Var(0)),
                          If(ULE(64, Var(0)),
                             If(ULE(256, Var(0)),
                                If(ULE(512, Var(0)),
                                   If(ULE(4096, Var(0)),
                                      If(ULE(4098, Var(0)),
                                        If(ULE(8193, Var(0)),
                                        8193,
                                        4098),
                                        4096),
                                      512),
                                   256),
                                64),
                             32),
                          8),
                       4),
                    2),
                 1),
              0)],
 @current.0 = [else -> 2],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 @proc_table->struct.proc::state.0!1045 = [(0, 2) -> 3,
                                        (0, 32) -> 1,
                                        else -> 0],
 k!1037 = [else ->
           If(ULE(2, Var(0)),
              If(ULE(3, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(16, Var(0)),
                       If(ULE(32, Var(0)),
                          If(ULE(33, Var(0)),
                             If(ULE(64, Var(0)),
                                If(ULE(65, Var(0)), 65, 64),
                                33),
                             32),
... != []

----------------------------------------------------------------------
Ran 1 test in 25.186s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_map_dev:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_dev (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 23.733s

OK

Syscall sys_map_file:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_file (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 26.639s

OK

Syscall sys_alloc_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pd (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 36.906s

OK

Syscall sys_alloc_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pt (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 41.907s

OK

Syscall sys_alloc_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 38.169s

OK

Syscall sys_copy_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_copy_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 12.847s

OK

Syscall sys_protect_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_protect_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 12.307s

OK

Syscall sys_free_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     5,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              6,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 5,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 6,
                      pages_owner.1(to.0) == current.0,
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pd (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pd (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 page_index.1!1233 = 0,
 from.0 = 8,
 (uintptr)@file_table.0 = 0,
 pn.3!1234 = 2053,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 2251799805329408,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 2053,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 index.1 = 8,
 pages_ptr_to_int.0 = 2251799805329408,
 k!1639 = [else ->
           If(ULE(16, Var(0)),
              If(ULE(17, Var(0)),
                 If(ULE(20, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       20),
                    17),
                 16),
              1)],
 procs_nr_ports.3 = [1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [16 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [32 -> 256,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 2048],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_fd.0 = [(0, 16) -> 2147483648,
                                       else -> 16],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 pages_owner.1 = [0 -> 16,
                  32 -> 16,
                  8 -> 16,
                  2053 -> 16,
                  256 -> 32,
                  2048 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 @pages.0 = [(0, 2053, 0) -> 82433,
             (0, 8, 8) -> 2251799813738497,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [1 -> 0,
                    20 -> 0,
                    32 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  32 -> 0,
                  20 -> 0,
                  1 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       20 -> 0,
                       32 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::pid.0!1647 = [(0, 2048) ->
                                        32,
                                        (0, 256) -> 32,
                                        else -> 16],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 pages_data.1 = [(2053, 0) -> 82433,
                 else -> 2251799813738497],
 procs_nr_intremaps.3 = [1 -> 0,
                         20 -> 0,
                         32 -> 0,
                         17 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 32],
 procs_nr_children.3 = [1 -> 0,
                        20 -> 0,
                        32 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [32 -> 2048,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        20 -> 0,
                        32 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1645 = [(0, 32) ->
                                        4,
                                        (0, 8) -> 5,
                                        (0, 2053) -> 6,
                                        else -> 2],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [0 -> 2,
                 32 -> 4,
                 8 -> 5,
                 2053 -> 6,
                 256 -> 2,
                 2048 -> 2,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
... != []

----------------------------------------------------------------------
Ran 1 test in 21.816s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_free_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     6,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              7,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 6,
                      pages_type.1(to.0) == 7,
                      pages_owner.1(from.0) == current.0,
                      pages_owner.1(to.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 pn.3!1238 = 4,
 page_desc_table_ptr_to_int.0 = 0,
 page_index.1!1237 = 0,
 from.0 = 1,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 49152,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 4,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 2,
 index.1 = 128,
 pages_ptr_to_int.0 = 49152,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 49152],
 k!1659 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(4, Var(0)),
                 If(ULE(5, Var(0)),
                    If(ULE(8, Var(0)),
                       If(ULE(9, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(64, Var(0)),
                                If(ULE(128, Var(0)),
                                   If(ULE(512, Var(0)),
                                      If(ULE(768, Var(0)),
                                        If(ULE(1024, Var(0)),
                                        If(ULE(1028, Var(0)),
                                        If(ULE(8193, Var(0)),
                                        8193,
                                        1028),
                                        1024),
                                        768),
                                        512),
                                      128),
                                   64),
                                32),
                             9),
                          8),
                       5),
                    4),
                 1),
              0)],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1664(Var(0),
                                        k!1658(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 49152],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1665(Var(0),
                                        k!1658(Var(1)))],
 k!1658 = [else ->
           If(ULE(2, Var(0)),
              If(ULE(3, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    3),
                 2),
              1)],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    32 -> 0,
                    4 -> 0,
                    3 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 49152],
 @page_desc_table->struct.page_desc::pid.0!1668 = [(0, 512) ->
                                        1,
                                        (0, 0) -> 1,
                                        (0, 1024) -> 4,
                                        (0, 9) -> 4,
                                        (0, 8) -> 32,
                                        (0, 128) -> 32,
                                        (0, 5) -> 3,
                                        (0, 64) -> 3,
                                        else -> 2],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 49152],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 49152],
 procs_ipc_size.1 = [else -> 49152],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 49152],
 @proc_table->struct.proc::hvm.0!1671 = [(0, 1) -> 0,
                                        else -> 32],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 49152],
 pages_data.1 = [(4, 0) -> 2251799813685248, else -> 65537],
 files_refcnt.4 = [else -> 49152],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1671(Var(0),
                                        k!1658(Var(1)))],
 procs_io_bitmap_a.1 = [4 -> 1024,
                        32 -> 8,
                        3 -> 5,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1666(Var(0),
                                        k!1659(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table->struct.proc::state.0!1667 = [(0, 2) -> 3,
                                        else -> 0],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [2 -> 768,
                            1 -> 512,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   32 -> 0,
                   4 -> 0,
                   3 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @proc_table->struct.proc::stack.0!1665 = [(0, 1) -> 0,
                                        else -> 1028],
 procs_intr.1 = [else -> 49152],
 @page_desc_table->struct.page_desc::type.0!1666 = [(0, 768) ->
                                        4,
                                        (0, 1) -> 6,
                                        (0, 4) -> 7,
                                        (0, 512) -> 4,
                                        else -> 2],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 49152],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1669(Var(0),
                                        k!1658(Var(1)))],
 procs_nr_ports.3 = [1 -> 0,
                     32 -> 0,
                     4 -> 0,
                     3 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 49152],
 procs_stack.1 = [2 -> 1028,
                  1 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [2 -> 32,
                1 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [4 -> 9,
                        32 -> 128,
                        3 -> 64,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0!1664 = [(0, 32) ->
                                        8,
                                        (0, 3) -> 5,
                                        else -> 1024],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 49152],
 pages_owner.1 = [1028 -> 2,
                  32 -> 2,
                  768 -> 2,
                  1 -> 2,
... != []

----------------------------------------------------------------------
Ran 1 test in 21.063s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_free_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     7,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              3,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 7,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 3,
                      pages_owner.1(to.0) == current.0,
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 page_index.1!1107 = 1,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 from.0 = 4096,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 32768,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pn.3!1108 = 1,
 to.0 = 1,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 32,
 index.1 = 0,
 pages_ptr_to_int.0 = 32768,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 36865],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1521(Var(0),
                                        k!1515(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 36865],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    48 -> 0,
                    36 -> 0,
                    33 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 36865],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 36865],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 36865],
 procs_ipc_size.1 = [else -> 36865],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 36865],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 36865],
 pages_data.1 = [(1, 1) -> 1, else -> 36865],
 files_refcnt.4 = [else -> 36865],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [32 -> 0,
                        48 -> 2,
                        36 -> 32,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1522(Var(0),
                                        k!1516(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 k!1516 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(16, Var(0)),
                       If(ULE(32, Var(0)),
                          If(ULE(512, Var(0)),
                             If(ULE(4096, Var(0)),
                                If(ULE(8193, Var(0)),
                                   8193,
                                   4096),
                                512),
                             32),
                          16),
                       4),
                    2),
                 1),
              0)],
 @page_desc_table->struct.page_desc::pid.0!1524 = [(0, 32) ->
                                        36,
                                        (0, 4) -> 36,
                                        (0, 2) -> 48,
                                        (0, 512) -> 48,
                                        else -> 32],
 procs_page_table_root.1 = [32 -> 16,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 k!1515 = [else ->
           If(ULE(32, Var(0)),
              If(ULE(33, Var(0)),
                 If(ULE(36, Var(0)),
                    If(ULE(48, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          48),
                       36),
                    33),
                 32),
              1)],
 procs_nr_fds.3 = [1 -> 0,
                   48 -> 0,
                   36 -> 0,
                   33 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::type.0!1522 = [(0, 16) ->
                                        4,
                                        (0, 4096) -> 7,
                                        (0, 1) -> 3,
                                        else -> 2],
 procs_intr.1 = [else -> 36865],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 36865],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1525(Var(0),
                                        k!1515(Var(1)))],
 procs_nr_ports.3 = [1 -> 0,
                     48 -> 0,
                     36 -> 0,
                     33 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 36865],
 procs_stack.1 = [32 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0!1521 = [(0, 36) ->
                                        32,
                                        (0, 48) -> 2,
                                        else -> 0],
 procs_hvm.1 = [32 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [32 -> 0,
                        48 -> 512,
                        36 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 36865],
 pages_owner.1 = [0 -> 32,
                  16 -> 32,
                  4096 -> 32,
                  1 -> 32,
                  512 -> 48,
                  2 -> 48,
                  4 -> 36,
                  32 -> 36,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_b.0!1525 = [(0, 36) ->
                                        4,
                                        (0, 48) -> 512,
                                        else -> 0],
 @pages.0 = [(0, 1, 1) -> 1,
             (0, 4096, 0) -> 36865,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 32],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [32 -> 3,
                  1 -> 0,
                  36 -> 0,
                  48 -> 0,
                  33 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.503s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_reclaim_page:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(ULT(pn.3, 8192),
    pages_type.1(pn.3) != 0,
    And(ULT(pages_owner.1(pn.3), 64),
        UGT(pages_owner.1(pn.3), 0),
        procs_state.1(pages_owner.1(pn.3)) == 5),
    False) ==
(If(Not(ULE(8192, pn.3)),
    If(@page_desc_table->struct.page_desc::type.0(0, pn.3) ==
       0,
       4294967274,
       If(Not(ULE(63,
                  18446744073709551615 +
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        pn.3))),
          If(@proc_table->struct.proc::state.0(0,
                                        @page_desc_table->struct.page_desc::pid.0(0,
                                        pn.3)) ==
             5,
             If(@proc_table->struct.proc::nr_devs.0(0,
                                        @page_desc_table->struct.page_desc::pid.0(0,
                                        pn.3)) ==
                0,
                0,
                4294967280),
             4294967283),
          4294967283)),
    4294967274) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_page (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_page (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 pn.3 = 2,
 pages_ptr_to_int.0 = 0,
 @vector_table.0 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0!679 = [(0, 4) ->
                                        1024,
                                        else -> 8],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!679(Var(0),
                                        k!673(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [32 -> 0,
                    4 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 k!674 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(2, Var(0)),
                If(ULE(8, Var(0)),
                   If(ULE(1024, Var(0)),
                      If(ULE(2048, Var(0)),
                         If(ULE(8193, Var(0)), 8193, 2048),
                         1024),
                      8),
                   2),
                1),
             0)],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 k!673 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(2, Var(0)),
                If(ULE(4, Var(0)),
                   If(ULE(32, Var(0)),
                      If(ULE(65, Var(0)), 65, 32),
                      4),
                   2),
                1),
             0)],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::type.0!680 = [(0, 0) ->
                                        4,
                                        (0, 2) -> 1,
                                        else -> 2],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 8],
 procs_io_bitmap_a.1 = [1 -> 8,
                        4 -> 1024,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!680(Var(0),
                                        k!674(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [1 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [4 -> 0,
                   2 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::pid.0!682 = [(0, 2) ->
                                        32,
                                        (0, 1024) -> 4,
                                        (0, 2048) -> 4,
                                        else -> 1],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!683(Var(0),
                                        k!673(Var(1)))],
 procs_nr_ports.3 = [4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [1 -> 8,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [1 -> 1,
                        4 -> 2048,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [1 -> 1,
                  8 -> 1,
                  0 -> 1,
                  2 -> 32,
                  2048 -> 4,
                  1024 -> 4,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  32 -> 5,
                  4 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [4 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [4 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 intremaps_vector.1 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
... != []

----------------------------------------------------------------------
Ran 1 test in 10.700s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_set_runnable:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_set_runnable (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_set_runnable (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 55, in sys_set_runnable
    new.procs[pid].ready.next = new.current
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 3.214s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall switch_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_switch_proc (__main__.HV6) ... ERROR

======================================================================
ERROR: test_switch_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 53, in switch_proc
    new.copy().update(
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'KernelState' object has no attribute 'update'

----------------------------------------------------------------------
Ran 1 test in 6.893s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_kill:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_kill (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_kill (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 63, in sys_kill
    new.procs[pid].ready.prev,
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 4.467s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_reap:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reap (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_reap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 69, in sys_reap
    new.procs[pid].launched = z3.BoolVal(False)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 187, in __setattr__
    raise AttributeError("No such attribute: '{}'".format(attribute))
AttributeError: No such attribute: 'launched'

----------------------------------------------------------------------
Ran 1 test in 12.403s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_reparent:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(pid.3 > 0, pid.3 < 64),
    procs_state.1(procs_ppid.1(pid.3)) == 5,
    Or(procs_state.1(1) == 2, procs_state.1(1) == 3)) ==
(If(Not(ULE(63, 18446744073709551615 + pid.3)),
    If(Not(ULE(63,
               18446744073709551615 +
               @proc_table->struct.proc::ppid.0(0, pid.3))),
       If(@proc_table->struct.proc::state.0(0,
                                        @proc_table->struct.proc::ppid.0(0,
                                        pid.3)) ==
          5,
          If(Extract(63,
                     1,
                     @proc_table->struct.proc::state.0(0, 1)) ==
             1,
             0,
             4294967274),
          4294967274),
       4294967274),
    4294967293) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reparent (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reparent (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 pid.3 = 32,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 32],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1061(Var(0),
                                        k!1055(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [2 -> 0,
                    24 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 128],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 k!1056 = [else ->
           If(ULE(2, Var(0)),
              If(ULE(32, Var(0)),
                 If(ULE(64, Var(0)),
                    If(ULE(256, Var(0)),
                       If(ULE(512, Var(0)),
                          If(ULE(2048, Var(0)),
                             If(ULE(4096, Var(0)),
                                If(ULE(8193, Var(0)),
                                   8193,
                                   4096),
                                2048),
                             512),
                          256),
                       64),
                    32),
                 2),
              0)],
 @proc_table->struct.proc::page_table_root.0!1065 = [(0, 1) ->
                                        256,
                                        (0, 32) -> 2048,
                                        else -> 2],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 k!1055 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(16, Var(0)),
                    If(ULE(17, Var(0)),
                       If(ULE(24, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(65, Var(0)), 65, 32),
                             24),
                          17),
                       16),
                    2),
                 1),
              0)],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1066(Var(0),
                                        k!1055(Var(1)))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [(0, 32) -> 128,
                                     else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1062(Var(0),
                                        k!1056(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [16 -> 2,
                            1 -> 256,
                            32 -> 2048,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [2 -> 0,
                   24 -> 0,
                   17 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::type.0!1062 = [(0, 32) ->
                                        3,
                                        (0, 2) -> 4,
                                        (0, 256) -> 4,
                                        (0, 2048) -> 4,
                                        else -> 2],
 @proc_table->struct.proc::state.0!1063 = [(0, 16) -> 3,
                                        (0, 1) -> 2,
                                        else -> 0],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 procs_nr_ports.3 = [2 -> 0,
                     24 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 0,
                  1 -> 64,
                  32 -> 512,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [16 -> 0,
                1 -> 64,
                32 -> 4096,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [0 -> 16,
                  2 -> 16,
                  64 -> 1,
                  256 -> 1,
                  32 -> 16,
                  512 -> 32,
                  4096 -> 32,
                  2048 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  128 -> 5,
                  1 -> 2,
                  2 -> 0,
                  24 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [2 -> 0,
                       24 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [16 -> 32,
                     else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [2 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 7.108s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall recv_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_recv_proc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 15.008s

OK

Syscall call_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(pid.3 > 0, pid.3 < 64),
    procs_state.1(pid.3) == 4,
    ULT(inpn.0, 8192),
    pages_owner.1(inpn.0) == current.0,
    ULE(size.0, 4096),
    ULT(outpn.0, 8192),
    pages_owner.1(outpn.0) == current.0,
    pages_type.1(outpn.0) == 3,
    Or(Not(And(outfd.0 >= 0, outfd.0 < 16)),
       And(And(outfd.0 >= 0, outfd.0 < 16),
           Or(procs_ofile.1(current.0, outfd.0) == 0,
              And(UGT(procs_ofile.1(current.0, outfd.0), 0),
                  ULT(procs_ofile.1(current.0, outfd.0),
                      128))))),
    Or(procs_ipc_from.1(pid.3) == 0,
       procs_ipc_from.1(pid.3) == current.0)) ==
(If(If(ULE(63, 18446744073709551615 + pid.3),
       4294967293,
       If(@proc_table->struct.proc::state.0(0, pid.3) == 4,
          If(ULE(8192, inpn.0),
             4294967274,
             If(@page_desc_table->struct.page_desc::pid.0(0,
                                        inpn.0) ==
                @current.0(0),
                If(And(Extract(63, 13, size.0) == 0,
                       ULE(Extract(12, 0, size.0), 4096)),
                   If(ULE(8192, outpn.0),
                      4294967274,
                      If(@page_desc_table->struct.page_desc::pid.0(0,
                                        outpn.0) ==
                         @current.0(0),
                         If(@page_desc_table->struct.page_desc::type.0(0,
                                        outpn.0) ==
                            3,
                            If(ULE(16, outfd.0),
                               If(Or(@proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                     0,
                                     @proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                     @current.0(0)),
                                  0,
                                  4294967283),
                               If(ULE(127,
                                      18446744073709551615 +
                                      @proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, outfd.0))),
                                  If(Or(@proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        0,
                                        @proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        @current.0(0)),
                                     0,
                                     4294967283),
                                  4294967274)),
                            4294967274),
                         4294967283)),
                   4294967274),
                4294967283)),
          4294967285)) ==
    0,
    0,
    If(Not(ULE(63, 18446744073709551615 + pid.3)),
       If(@proc_table->struct.proc::state.0(0, pid.3) == 4,
          If(Not(ULE(8192, inpn.0)),
             If(@page_desc_table->struct.page_desc::pid.0(0,
                                        inpn.0) ==
                @current.0(0),
                If(Not(And(Extract(63, 13, size.0) == 0,
                           ULE(Extract(12, 0, size.0), 4096))),
                   4294967274,
                   If(Not(ULE(8192, outpn.0)),
                      If(@page_desc_table->struct.page_desc::pid.0(0,
                                        outpn.0) ==
                         @current.0(0),
                         If(@page_desc_table->struct.page_desc::type.0(0,
                                        outpn.0) ==
                            3,
                            If(Not(ULE(16, outfd.0)),
                               If(Not(ULE(127,
                                        18446744073709551615 +
                                        @proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, outfd.0)))),
                                  4294967274,
                                  If(Or(@proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        0,
                                        @proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        @current.0(0)),
                                     0,
                                     4294967283)),
                               If(Or(@proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                     0,
                                     @proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                     @current.0(0)),
                                  0,
                                  4294967283)),
                            4294967274),
                         4294967283),
                      4294967274)),
                4294967283),
             4294967274),
          4294967285),
       4294967293)) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_call_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_call_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 inpn.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 outpn.0 = 1024,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 pid.3 = 4,
 outfd.0 = 0,
 pages_ptr_to_int.0 = 0,
 size.0 = 16,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 136],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1162(Var(0),
                                        k!1156(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [(0, 4) -> 0,
                                        else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [12 -> 0,
                    10 -> 0,
                    48 -> 0,
                    9 -> 0,
                    34 -> 0,
                    17 -> 0,
                    18 -> 0,
                    36 -> 0,
                    8 -> 0,
                    5 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 @proc_table.0!1164 = [(0, 4, 0) -> 0, else -> 2],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 procs_ipc_from.1 = [else -> 0],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @page_desc_table->struct.page_desc::pid.0!1166 = [(0, 256) ->
                                        4,
                                        (0, 1) -> 32,
                                        (0, 36) -> 32,
                                        (0, 384) -> 32,
                                        (0, 64) -> 4,
                                        (0, 136) -> 4,
                                        (0, 16) -> 4,
                                        else -> 16],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1168(Var(0),
                                        k!1156(Var(1)))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> True],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1163(Var(0),
                                        k!1157(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [16 -> 0,
                            4 -> 256,
                            32 -> 1,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [12 -> 0,
                   10 -> 0,
                   48 -> 0,
                   9 -> 0,
                   34 -> 0,
                   17 -> 0,
                   18 -> 0,
                   36 -> 0,
                   8 -> 0,
                   5 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @proc_table->struct.proc::hvm.0!1168 = [(0, 4) -> 64,
                                        (0, 32) -> 36,
                                        else -> 32],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0!1163 = [(0, 0) ->
                                        4,
                                        (0, 1024) -> 3,
                                        (0, 136) -> 3,
                                        (0, 256) -> 4,
                                        (0, 1) -> 4,
                                        else -> 2],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 procs_nr_ports.3 = [12 -> 0,
                     10 -> 0,
                     48 -> 0,
                     9 -> 0,
                     34 -> 0,
                     17 -> 0,
                     18 -> 0,
                     36 -> 0,
                     8 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1165 = [(0, 16) -> 3,
                                        (0, 4) -> 4,
                                        else -> 0],
 procs_stack.1 = [16 -> 128,
                  4 -> 16,
                  32 -> 384,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_hvm.1 = [16 -> 32,
                4 -> 64,
                32 -> 36,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 262144],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [(0, 4) -> 0,
                                       else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [128 -> 16,
                  32 -> 16,
                  0 -> 16,
                  1024 -> 16,
                  136 -> 4,
                  16 -> 4,
                  64 -> 4,
                  256 -> 4,
                  384 -> 32,
                  36 -> 32,
                  1 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  4 -> 4,
                  12 -> 0,
                  9 -> 0,
                  17 -> 0,
                  36 -> 0,
                  10 -> 0,
                  18 -> 0,
                  48 -> 0,
                  34 -> 0,
                  5 -> 0,
                  8 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
... != []

----------------------------------------------------------------------
Ran 1 test in 40.078s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_create:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_create (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 5.271s

OK

Syscall sys_close:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_close (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 18.031s

OK

Syscall sys_dup:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_dup (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 19.083s

OK

Syscall sys_lseek:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_lseek (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 4.227s

OK

Syscall sys_map_pcipage:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_map_pcipage (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_map_pcipage (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 43, in sys_map_pcipage
    old.pcipages[pcipn].owner == old.pci[old.pcipages[pcipn].owner].owner,
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 823, in __eq__
    return BoolRef(Z3_mk_eq(self.ctx_ref(), a.as_ast(), b.as_ast()), self.ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3core.py", line 1560, in Z3_mk_eq
    raise Z3Exception(lib().Z3_get_error_msg(a0, err))
Z3Exception: Sorts (_ BitVec 16) and (_ BitVec 64) are incompatible

----------------------------------------------------------------------
Ran 1 test in 10.619s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_root:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_iommu_root (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 9.407s

OK

Syscall sys_alloc_iommu_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           8,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 0,
                      Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 8,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pdpt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pdpt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 pn.3!1109 = 2048,
 (uintptr)@proc_table.0 = 0,
 page_index.1!1108 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 2048,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 220059393926156,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 32,
 index.1 = 0,
 pages_ptr_to_int.0 = 220059393926156,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 512],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1533(Var(0),
                                        k!1527(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    33 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @proc_table->struct.proc::page_table_root.0!1537 = [(0, 48) ->
                                        1152,
                                        else -> 128],
 k!1528 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(8, Var(0)),
                    If(ULE(128, Var(0)),
                       If(ULE(256, Var(0)),
                          If(ULE(512, Var(0)),
                             If(ULE(1024, Var(0)),
                                If(ULE(1152, Var(0)),
                                   If(ULE(2048, Var(0)),
                                      If(ULE(8193, Var(0)),
                                        8193,
                                        2048),
                                      1152),
                                   1024),
                                512),
                             256),
                          128),
                       8),
                    2),
                 1),
              0)],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 k!1527 = [else ->
           If(ULE(32, Var(0)),
              If(ULE(33, Var(0)),
                 If(ULE(36, Var(0)),
                    If(ULE(48, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          48),
                       36),
                    33),
                 32),
              1)],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1538(Var(0),
                                        k!1527(Var(1)))],
 procs_io_bitmap_a.1 = [32 -> 512,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1534(Var(0),
                                        k!1528(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [32 -> 128,
                            48 -> 1152,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   33 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::pid.0!1536 = [(0, 0) ->
                                        0,
                                        (0, 1152) -> 48,
                                        (0, 256) -> 48,
                                        (0, 8) -> 48,
                                        else -> 32],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 2],
 procs_nr_ports.3 = [1 -> 0,
                     33 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [32 -> 1,
                  48 -> 8,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [32 -> 1024,
                48 -> 256,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [32 -> 2,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [1 -> 32,
                  1024 -> 32,
                  128 -> 32,
                  2048 -> 32,
                  0 -> 0,
                  2 -> 32,
                  512 -> 32,
                  8 -> 48,
                  256 -> 48,
                  1152 -> 48,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 2048, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 32],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [32 -> 3,
                  36 -> 33554432,
                  1 -> 0,
                  33 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @proc_table->struct.proc::stack.0!1533 = [(0, 48) -> 8,
                                        else -> 1],
 procs_nr_vectors.3 = [1 -> 0,
                       33 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [1 -> 0,
                     33 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 21.784s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           9,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 9,
                      pages_owner.1(from.0) == current.0,
                      pages_type.1(to.0) == 0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pd (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pd (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 pn.3!1315 = 4,
 perm.0 = 1,
 from.0 = 4,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 577614330745294982,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 page_index.1!1314 = 0,
 index.1 = 0,
 pages_ptr_to_int.0 = 577614330745294982,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::pid.0!1734 = [(0, 0) ->
                                        4611686018427387904,
                                        (0, 20) -> 17,
                                        (0, 4096) -> 17,
                                        (0, 64) -> 32,
                                        (0, 2048) -> 32,
                                        else -> 16],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 64],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1731(Var(0),
                                        k!1725(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0!1732 = [(0, 1) ->
                                        4,
                                        (0, 0) -> 0,
                                        (0, 4) -> 9,
                                        (0, 20) -> 4,
                                        else -> 2],
 procs_nr_devs.3 = [1 -> 0,
                    20 -> 0,
                    32 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1733 = [(0, 16) -> 3,
                                        else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1736(Var(0),
                                        k!1725(Var(1)))],
 procs_io_bitmap_a.1 = [32 -> 64,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::hvm.0!1736 = [(0, 17) -> 4096,
                                        else -> 1024],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1732(Var(0),
                                        k!1726(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [16 -> 1,
                            17 -> 20,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   20 -> 0,
                   32 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 k!1726 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(4, Var(0)),
                 If(ULE(16, Var(0)),
                    If(ULE(20, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(1024, Var(0)),
                             If(ULE(2048, Var(0)),
                                If(ULE(4096, Var(0)),
                                   If(ULE(8193, Var(0)),
                                      8193,
                                      4096),
                                   2048),
                                1024),
                             64),
                          20),
                       16),
                    4),
                 1),
              0)],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 2048],
 k!1725 = [else ->
           If(ULE(16, Var(0)),
              If(ULE(17, Var(0)),
                 If(ULE(20, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       20),
                    17),
                 16),
              1)],
 @proc_table->struct.proc::page_table_root.0!1735 = [(0, 17) ->
                                        20,
                                        else -> 1],
 procs_nr_ports.3 = [1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 16,
                  17 -> 4096,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [16 -> 1024,
                17 -> 4096,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [32 -> 2048,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [16 -> 16,
                  1024 -> 16,
                  1 -> 16,
                  4 -> 16,
                  0 -> 4611686018427387904,
                  2048 -> 32,
                  64 -> 32,
                  4096 -> 17,
                  20 -> 17,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 4, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  20 -> 0,
                  32 -> 0,
                  1 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       20 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.226s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           10,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 10,
                      pages_owner.1(from.0) == current.0,
                      pages_type.1(to.0) == 0,
                      Not(ULE(512, index.1)),
                      pages_data.1(from.0, index.1) == 0,
                      Extract(63, 2, perm.0) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 1,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 4792321,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pn.3!1118 = 1,
 page_index.1!1117 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 to.0 = 0,
 index.1 = 0,
 pages_ptr_to_int.0 = 4792321,
 procs_nr_ports.3 = [4 -> 0,
                     32 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [1 -> 256,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [1 -> 16,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 @pci_table.0 = [else -> 8192],
 procs_io_bitmap_b.1 = [1 -> 32,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 4],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 256],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [256 -> 1,
                  16 -> 1,
                  2048 -> 1,
                  1 -> 1,
                  32 -> 1,
                  4 -> 1,
                  0 -> 0,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 k!1529 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(4, Var(0)),
                 If(ULE(16, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(256, Var(0)),
                          If(ULE(2048, Var(0)),
                             If(ULE(8193, Var(0)),
                                8193,
                                2048),
                             256),
                          32),
                       16),
                    4),
                 1),
              0)],
 @pages.0 = [(0, 1, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [4 -> 0,
                    32 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 k!1528 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    2),
                 1),
              0)],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  32 -> 0,
                  4 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [4 -> 0,
                       32 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [4 -> 0,
                     32 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 pages_data.1 = [else -> 0],
 procs_nr_intremaps.3 = [4 -> 0,
                         32 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 2048],
 procs_nr_children.3 = [4 -> 0,
                        32 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 16],
 procs_io_bitmap_a.1 = [1 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_nr_dmapages.3 = [4 -> 0,
                        32 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::state.0!1535 = [(0, 1) -> 3,
                                        else -> 0],
 @page_desc_table->struct.page_desc::type.0!1534 = [(0,
                                        2048) ->
                                        4,
                                        (0, 0) -> 0,
                                        (0, 1) -> 10,
                                        else -> 2],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [256 -> 2,
                 16 -> 2,
                 2048 -> 4,
                 1 -> 10,
... != []

----------------------------------------------------------------------
Ran 1 test in 19.743s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_iommu_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 11.529s

OK

Syscall sys_map_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_iommu_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 11.653s

OK

Syscall sys_reclaim_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_reclaim_iommu_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 6.649s

OK

Syscall sys_reclaim_iommu_root:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(ULT(devid.1, 64),
    pci_owner.1(devid.1) != 0,
    procs_state.1(pci_owner.1(devid.1)) == 5,
    procs_nr_intremaps.3(pci_owner.1(devid.1)) == 0) ==
(If(Not(ULE(63,
            18446744073709551615 +
            @pci_table.0(0, Concat(0, devid.1)))),
    If(@proc_table->struct.proc::state.0(0,
                                        @pci_table.0(0,
                                        Concat(0, devid.1))) ==
       5,
       If(@proc_table->struct.proc::nr_intremaps.0(0,
                                        @pci_table.0(0,
                                        Concat(0, devid.1))) ==
          0,
          0,
          4294967280),
       4294967283),
    4294967283) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_iommu_root (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_iommu_root (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 devid.1 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = True,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = True,
 current.0 = 3,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1077(Var(0),
                                        k!1071(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1078(Var(0),
                                        k!1071(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    16 -> 0,
                    8 -> 0,
                    32 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1084(Var(0),
                                        k!1071(Var(1)))],
 procs_io_bitmap_a.1 = [16 -> 256,
                        8 -> 16,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1079(Var(0),
                                        k!1072(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 pci_owner.1 = [0 -> 1024,
                else -> @pci_table.0(0, Concat(0, Var(0)))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 @proc_table->struct.proc::stack.0!1078 = [(0, 4) -> 8,
                                        else -> 1],
 procs_page_table_root.1 = [3 -> 0,
                            4 -> 512,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 @proc_table->struct.proc::io_bitmap_b.0!1082 = [(0, 8) ->
                                        32,
                                        else -> 128],
 procs_nr_fds.3 = [1 -> 0,
                   16 -> 0,
                   8 -> 0,
                   32 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::pid.0!1081 = [(0, 0) ->
                                        3,
                                        (0, 1) -> 3,
                                        (0, 256) -> 16,
                                        (0, 128) -> 16,
                                        (0, 16) -> 8,
                                        (0, 32) -> 8,
                                        else -> 4],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1082(Var(0),
                                        k!1071(Var(1)))],
 @pci_table.0 = [else -> 1024],
 procs_nr_ports.3 = [1 -> 0,
                     16 -> 0,
                     8 -> 0,
                     32 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [3 -> 1,
                  4 -> 8,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [3 -> 1,
                4 -> 4,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 @proc_table->struct.proc::io_bitmap_a.0!1077 = [(0, 8) ->
                                        16,
                                        else -> 256],
 procs_io_bitmap_b.1 = [16 -> 128,
                        8 -> 32,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 0],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [1 -> 3,
                  0 -> 3,
                  128 -> 16,
                  256 -> 16,
                  32 -> 8,
                  16 -> 8,
                  8 -> 4,
                  4 -> 4,
                  512 -> 4,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 3],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [3 -> 3,
                  1024 -> 5,
                  32 -> 0,
                  16 -> 0,
                  1 -> 0,
                  8 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       16 -> 0,
                       8 -> 0,
                       32 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [1 -> 0,
                     16 -> 0,
                     8 -> 0,
                     32 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1024 -> 0,
                         1 -> 0,
                         16 -> 0,
                         8 -> 0,
                         32 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        16 -> 0,
                        8 -> 0,
                        32 -> 0,
                        else ->
... != []

----------------------------------------------------------------------
Ran 1 test in 5.016s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_vector:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_vector (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 2.668s

OK

Syscall sys_reclaim_vector:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(ULT(vector.1, 0),
    And(vectors_owner.1(vector.1) > 0,
        vectors_owner.1(vector.1) < 64),
    procs_state.1(vectors_owner.1(vector.1)) == 5,
    False) ==
(If(Not(ULE(63,
            18446744073709551615 +
            @vector_table.0(0, Concat(0, vector.1)))),
    If(@proc_table->struct.proc::state.0(0,
                                        @vector_table.0(0,
                                        Concat(0, vector.1))) ==
       5,
       If(@proc_table->struct.proc::nr_intremaps.0(0,
                                        @vector_table.0(0,
                                        Concat(0, vector.1))) ==
          0,
          0,
          4294967280),
       4294967283),
    4294967283) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_vector (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_vector (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 vector.1 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 40,
 pages_ptr_to_int.0 = 0,
 procs_nr_ports.3 = [1 -> 0,
                     48 -> 0,
                     44 -> 0,
                     41 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [40 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [40 -> 1,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [1 -> 40,
                  0 -> 40,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    48 -> 0,
                    44 -> 0,
                    41 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 40],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [40 -> 3,
                  32 -> 5,
                  1 -> 0,
                  48 -> 0,
                  44 -> 0,
                  41 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       48 -> 0,
                       44 -> 0,
                       41 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     48 -> 0,
                     44 -> 0,
                     41 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [32 -> 0,
                         1 -> 0,
                         48 -> 0,
                         44 -> 0,
                         41 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        48 -> 0,
                        44 -> 0,
                        41 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 vectors_owner.1 = [0 -> 32,
                    else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 1],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        48 -> 0,
                        44 -> 0,
                        41 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::state.0!879 = [(0, 40) -> 3,
                                        (0, 32) -> 5,
                                        else -> 0],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 files_type.1 = [else -> 8192],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [1 -> 2,
                 0 -> 4,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!878(Var(0),
                                        k!873(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [40 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 procs_ofile.1 = [else ->
                  @proc_table.0(0,
                                Var(0),
                                Concat(0, Var(1)))],
 pcipages_valid.1 = [else -> False],
 @proc_table.0 = [else -> 1],
 @proc_table.4 = [else -> 0],
 @proc_table->struct.proc::state.0 = [else ->
                                      @proc_table->struct.proc::state.0!879(Var(0),
                                        k!872(Var(1)))],
 procs_nr_fds.3 = [1 -> 0,
                   48 -> 0,
                   44 -> 0,
                   41 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_ipc_fd.1 = [else ->
                   @proc_table->struct.proc::ipc_fd.0(0,
... != []

----------------------------------------------------------------------
Ran 1 test in 3.795s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_intremap:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
iotlbinv.0 == iotlbinv.1
does not imply
iotlbinv.0 ==
If(And(Not(ULE(8, index.1)),
       intremaps_state.1(index.1) == 0,
       pci_owner.1(devid.1) == current.0,
       vectors_owner.1(vector.1) == current.0),
   True,
   iotlbinv.1)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_intremap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_intremap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 devid.1 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 vector.1 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 4,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 @pci_table.0 = [else -> 4],
 procs_nr_ports.3 = [1 -> 0,
                     6 -> 0,
                     8 -> 0,
                     16 -> 0,
                     32 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [4 -> 2048,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 intremaps_state.1 = [else -> 0],
 procs_hvm.1 = [4 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @intremap_table->struct.intremap::state.0 = [(0, 0) -> 0,
                                        else ->
                                        intremaps_state.1(Var(1))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 2048],
 @io_table.0 = [else -> 0],
 pages_owner.1 = [2048 -> 4,
                  0 -> 4,
                  512 -> 4,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    6 -> 0,
                    8 -> 0,
                    16 -> 0,
                    32 -> 0,
                    5 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 4],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [4 -> 3,
                  16 -> 0,
                  32 -> 0,
                  6 -> 0,
                  1 -> 0,
                  8 -> 0,
                  5 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1758 = [(0, 512) ->
                                        4,
                                        else -> 2],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       6 -> 0,
                       8 -> 0,
                       16 -> 0,
                       32 -> 0,
                       5 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1759 = [(0, 4) -> 3,
                                        else -> 0],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     6 -> 0,
                     8 -> 0,
                     16 -> 0,
                     32 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         6 -> 0,
                         8 -> 0,
                         16 -> 0,
                         32 -> 0,
                         5 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        6 -> 0,
                        8 -> 0,
                        16 -> 0,
                        32 -> 0,
                        5 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 512],
 vectors_owner.1 = [0 -> 4,
                    else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        6 -> 0,
                        8 -> 0,
                        16 -> 0,
                        32 -> 0,
                        5 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 k!1753 = [else ->
           If(ULE(512, Var(0)),
              If(ULE(2048, Var(0)),
                 If(ULE(8193, Var(0)), 8193, 2048),
                 512),
              0)],
 pages_type.1 = [2048 -> 2,
                 0 -> 2,
                 512 -> 4,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 k!1752 = [else ->
           If(ULE(4, Var(0)),
              If(ULE(5, Var(0)),
                 If(ULE(6, Var(0)),
... != []

----------------------------------------------------------------------
Ran 1 test in 9.167s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_reclaim_intremap:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(ULT(index.1, 8),
    intremaps_state.1(index.1) == 1,
    And(ULT(intremaps_devid.1(index.1), 64),
        pci_owner.1(intremaps_devid.1(index.1)) != 0,
        procs_state.1(pci_owner.1(intremaps_devid.1(index.1))) ==
        5)) ==
(If(Not(Extract(63, 3, index.1) == 0),
    4294967274,
    If(@intremap_table->struct.intremap::state.0(0, index.1) ==
       1,
       If(Not(ULE(63,
                  18446744073709551615 +
                  @pci_table.0(0,
                               Concat(0,
                                      @intremap_table->struct.intremap::devid.0(0,
                                        index.1))))),
          If(@proc_table->struct.proc::state.0(0,
                                        @pci_table.0(0,
                                        Concat(0,
                                        @intremap_table->struct.intremap::devid.0(0,
                                        index.1)))) ==
             5,
             0,
             4294967283),
          4294967283),
       4294967274)) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_intremap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_intremap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = True,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = True,
 current.0 = 4,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 intremaps_state.1 = [else -> 1],
 @intremap_table->struct.intremap::state.0 = [(0, 0) -> 1,
                                        else ->
                                        intremaps_state.1(Var(1))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 4],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1221(Var(0),
                                        k!1215(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    16 -> 0,
                    6 -> 0,
                    8 -> 0,
                    32 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1226(Var(0),
                                        k!1215(Var(1)))],
 procs_io_bitmap_a.1 = [6 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::state.0!1223 = [(0, 4) -> 3,
                                        else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1222(Var(0),
                                        k!1216(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 pci_owner.1 = [0 -> 9223372036854775840,
                else -> @pci_table.0(0, Concat(0, Var(0)))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 procs_page_table_root.1 = [4 -> 64,
                            5 -> 1024,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 k!1216 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(4, Var(0)),
                 If(ULE(8, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(1024, Var(0)),
                             If(ULE(8193, Var(0)),
                                8193,
                                1024),
                             64),
                          32),
                       8),
                    4),
                 1),
              0)],
 procs_nr_fds.3 = [1 -> 0,
                   16 -> 0,
                   6 -> 0,
                   8 -> 0,
                   32 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 k!1215 = [else ->
           If(ULE(4, Var(0)),
              If(ULE(5, Var(0)),
                 If(ULE(6, Var(0)),
                    If(ULE(8, Var(0)),
                       If(ULE(16, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(64, Var(0)),
                                If(ULE(65, Var(0)), 65, 64),
                                32),
                             16),
                          8),
                       6),
                    5),
                 4),
              1)],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0!1222 = [(0, 64) ->
                                        4,
                                        (0, 1024) -> 4,
                                        else -> 2],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 1],
 @pci_table.0 = [else -> 9223372036854775840],
 procs_nr_ports.3 = [1 -> 0,
                     16 -> 0,
                     6 -> 0,
                     8 -> 0,
                     32 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [4 -> 0,
                  5 -> 32,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [4 -> 0,
                5 -> 8,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [6 -> 1,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [(0, 4) -> 2147483648,
                                       else -> 16],
 @io_table.0 = [else -> 0],
 pages_owner.1 = [0 -> 4,
                  64 -> 4,
                  1 -> 6,
                  4 -> 6,
                  32 -> 5,
                  8 -> 5,
                  1024 -> 5,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 4],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [4 -> 3,
                  9223372036854775840 -> 5,
                  32 -> 0,
                  1 -> 0,
                  6 -> 0,
                  8 -> 0,
                  16 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0!1226 = [(0, 5) -> 8,
                                        else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       16 -> 0,
                       6 -> 0,
                       8 -> 0,
                       32 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
... != []

----------------------------------------------------------------------
Ran 1 test in 6.203s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_ack_intr:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_ack_intr (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_ack_intr (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 47, in sys_ack_intr
    new.procs[new.current].intr[idx] = new.procs[new.current].intr(idx) & ~mask
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 3158, in __and__
    return BitVecRef(Z3_mk_bvand(self.ctx_ref(), a.as_ast(), b.as_ast()), self.ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3core.py", line 1749, in Z3_mk_bvand
    raise Z3Exception(lib().Z3_get_error_msg(a0, err))
Z3Exception: Argument (bvnot (bvshl #x01 (bvsmod vector.1 #x40))) at position 1 does not match declaration (declare-fun bvand ((_ BitVec 64) (_ BitVec 64)) (_ BitVec 64))

----------------------------------------------------------------------
Ran 1 test in 0.841s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_port:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_port (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 108.479s

OK

Syscall sys_reclaim_port:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_reclaim_port (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 3.148s

OK

Syscall sys_alloc_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pdpt (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 41.654s

OK

Syscall sys_free_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     4,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              5,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 4,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 5,
                      pages_owner.1(to.0) == current.0,
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pdpt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pdpt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 page_index.1!1101 = 4,
 (uintptr)@file_table.0 = 0,
 pn.3!1102 = 5124,
 from.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 1688849862377472,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 5124,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 index.1 = 0,
 pages_ptr_to_int.0 = 1688849862377472,
 procs_nr_ports.3 = [32 -> 0,
                     4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 1024,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [1 -> 8,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [2 -> 256,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 16],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1024],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [1024 -> 1,
                  8 -> 1,
                  513 -> 1,
                  0 -> 1,
                  5124 -> 1,
                  256 -> 2,
                  16 -> 2,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 @pages.0 = [(0, 5124, 4) -> 1152921504606846976,
             (0, 0, 0) -> 1688849883365377,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [32 -> 0,
                    4 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 k!1507 = [else ->
           If(ULE(8, Var(0)),
              If(ULE(16, Var(0)),
                 If(ULE(256, Var(0)),
                    If(ULE(513, Var(0)),
                       If(ULE(1024, Var(0)),
                          If(ULE(5124, Var(0)),
                             If(ULE(8193, Var(0)),
                                8193,
                                5124),
                             1024),
                          513),
                       256),
                    16),
                 8),
              0)],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  32 -> 0,
                  4 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 k!1506 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    2),
                 1),
              0)],
 @proc_table.3 = [else -> 0],
 dmapages_owner.1 = [else -> 8192],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [32 -> 0,
                       4 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::pid.0!1514 = [(0, 16) ->
                                        2,
                                        (0, 256) -> 2,
                                        else -> 1],
 procs_nr_pages.3 = [32 -> 0,
                     4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 pages_data.1 = [(5124, 4) -> 1152921504606846976,
                 else -> 1688849883365377],
 procs_nr_intremaps.3 = [32 -> 0,
                         4 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 513],
 procs_nr_children.3 = [32 -> 0,
                        4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::state.0!1513 = [(0, 1) -> 3,
                                        else -> 0],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 8],
 procs_io_bitmap_a.1 = [2 -> 16,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 files_refcnt.4 = [else -> 8192],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [32 -> 0,
                        4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [1024 -> 2,
                 8 -> 2,
                 513 -> 4,
                 0 -> 4,
                 5124 -> 5,
... != []

----------------------------------------------------------------------
Ran 1 test in 19.907s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall clone_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_clone_proc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 34.313s

OK

Syscall send_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_send_proc (__main__.HV6) ... ERROR

======================================================================
ERROR: test_send_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 98, in send_proc
    )(new)
  File "/root/hyperkernel/irpy/libirpy/util.py", line 180, in <lambda>
    return lambda *args, **kwargs: If(cond, a(*args, **kwargs), b(*args, **kwargs))
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 83, in <lambda>
    s.procs[pid].ofile.update(
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 44, in __getattr__
    val = getattr(self._imap, attr)
AttributeError: 'Map' object has no attribute 'update'

----------------------------------------------------------------------
Ran 1 test in 22.718s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall reply_wait_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_reply_wait_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_reply_wait_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 94, in reply_wait_proc
    new.procs[pid].ofile = lambda fd, oldfn: \
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 45.872s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_dup2:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll(pid.0,
       Implies(And(pid.0 > 0, pid.0 < 64),
               @proc_table->struct.proc::nr_fds.0(0, pid.0) ==
               procs_nr_fds.3(pid.0)))
does not imply
ForAll(pid.4,
       Implies(And(pid.4 > 0, pid.4 < 64),
               If(Not(ULE(63, 18446744073709551615 + pid.3)),
                  If(@current.0(0) == pid.3,
                     If(Not(ULE(16, oldfd.0)),
                        If(And(Not(ULE(16, newfd.0)),
                               Not(@proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, oldfd.0)) ==
                                   0)),
                           If(And(oldfd.0 == newfd.0,
                                  @current.0(0) == pid.3),
                              @proc_table->struct.proc::nr_fds.0(0,
                                        pid.4),
                              If(@proc_table.0(0,
                                        pid.3,
                                        SignExt(32, newfd.0)) ==
                                 0,
                                 If(pid.3 == pid.4,
                                    @proc_table->struct.proc::nr_fds.0(0,
                                        pid.3) +
                                    1,
                                    @proc_table->struct.proc::nr_fds.0(0,
                                        pid.4)),
                                 If(pid.3 == pid.4,
                                    @proc_table->struct.proc::nr_fds.0(0,
                                        pid.3) +
                                    18446744073709551615 +
                                    1,
                                    If(pid.3 == pid.4,
                                       @proc_table->struct.proc::nr_fds.0(0,
                                        pid.3) +
                                       18446744073709551615,
                                       @proc_table->struct.proc::nr_fds.0(0,
                                        pid.4))))),
                           @proc_table->struct.proc::nr_fds.0(0,
                                        pid.4)),
                        @proc_table->struct.proc::nr_fds.0(0,
                                        pid.4)),
                     If(@proc_table->struct.proc::ppid.0(0,
                                        pid.3) ==
                        @current.0(0),
                        If(@proc_table->struct.proc::state.0(0,
                                        pid.3) ==
                           1,
                           If(Not(ULE(16, oldfd.0)),
                              If(And(Not(ULE(16, newfd.0)),
                                     Not(@proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, oldfd.0)) ==
                                        0)),
                                 If(@proc_table.0(0,
                                        pid.3,
                                        SignExt(32, newfd.0)) ==
                                    0,
                                    If(pid.3 == pid.4,
                                       @proc_table->struct.proc::nr_fds.0(0,
                                        pid.3) +
                                       1,
                                       @proc_table->struct.proc::nr_fds.0(0,
                                        pid.4)),
                                    If(pid.3 == pid.4,
                                       @proc_table->struct.proc::nr_fds.0(0,
                                        pid.3) +
                                       18446744073709551615 +
                                       1,
                                       If(pid.3 == pid.4,
                                        @proc_table->struct.proc::nr_fds.0(0,
                                        pid.3) +
                                        18446744073709551615,
                                        @proc_table->struct.proc::nr_fds.0(0,
                                        pid.4)))),
                                 @proc_table->struct.proc::nr_fds.0(0,
                                        pid.4)),
                              @proc_table->struct.proc::nr_fds.0(0,
                                        pid.4)),
                           @proc_table->struct.proc::nr_fds.0(0,
                                        pid.4)),
                        @proc_table->struct.proc::nr_fds.0(0,
                                        pid.4))),
                  @proc_table->struct.proc::nr_fds.0(0,
                                        pid.4)) ==
               If(And(And(Not(pid.3 <= 0), Not(64 <= pid.3)),
                      Or(pid.3 == current.0,
                         And(procs_ppid.1(pid.3) ==
                             current.0,
                             procs_state.1(pid.3) == 1)),
                      And(0 <= oldfd.0, Not(16 <= oldfd.0)),
                      And(0 <= newfd.0, Not(16 <= newfd.0)),
                      And(Not(procs_ofile.1(current.0,
                                        oldfd.0) ==
                              0),
                          Not(ULE(128,
                                  procs_ofile.1(current.0,
                                        oldfd.0))))),
                  If(And(current.0 == pid.3,
                         oldfd.0 == newfd.0),
                     procs_nr_fds.3(pid.4),
                     If(pid.3 == pid.4,
                        procs_nr_fds.3(pid.3) - 1 + 1,
                        If(pid.3 == pid.4,
                           procs_nr_fds.3(pid.3) - 1,
                           procs_nr_fds.3(pid.4)))),
                  procs_nr_fds.3(pid.4))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_dup2 (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_dup2 (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 newfd.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pid.4!1268 = 2,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 pid.3 = 2,
 pages_ptr_to_int.0 = 0,
 oldfd.0 = 1,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1781(Var(0),
                                        k!1775(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [32 -> 0,
                    8 -> 0,
                    4 -> 0,
                    3 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 @proc_table->struct.proc::state.0!1784 = [(0, 1) -> 3,
                                        (0, 2) -> 1,
                                        else -> 0],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 1],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1787(Var(0),
                                        k!1775(Var(1)))],
 k!1778 = [else ->
           If(ULE(2, Var(0)), If(ULE(65, Var(0)), 65, 2), 1)],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0!1786 = [(0, 2) ->
                                        4096,
                                        (0, 32) -> 512,
                                        else -> 2],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> True],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 k!1776 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(16, Var(0)),
                    If(ULE(512, Var(0)),
                       If(ULE(528, Var(0)),
                          If(ULE(2048, Var(0)),
                             If(ULE(4096, Var(0)),
                                If(ULE(8193, Var(0)),
                                   8193,
                                   4096),
                                2048),
                             528),
                          512),
                       16),
                    2),
                 1),
              0)],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 k!1775 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(3, Var(0)),
                    If(ULE(4, Var(0)),
                       If(ULE(8, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(64, Var(0)),
                                If(ULE(65, Var(0)), 65, 64),
                                32),
                             8),
                          4),
                       3),
                    2),
                 1),
              0)],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [(0, 2) -> 1,
                                     else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1782(Var(0),
                                        k!1776(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [1 -> 2,
                            2 -> 4096,
                            32 -> 512,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [2 -> 0,
                   32 -> 0,
                   8 -> 0,
                   4 -> 0,
                   3 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::pid.0!1785 = [(0, 2) ->
                                        1,
                                        (0, 0) -> 1,
                                        (0, 4096) -> 2,
                                        (0, 1) -> 2,
                                        (0, 16) -> 2,
                                        else -> 32],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 procs_nr_ports.3 = [32 -> 0,
                     8 -> 0,
                     4 -> 0,
                     3 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 0,
                  2 -> 1,
                  32 -> 528,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [1 -> 0,
                2 -> 16,
                32 -> 2048,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 1],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [0 -> 1,
                  2 -> 1,
                  16 -> 2,
                  4096 -> 2,
                  1 -> 2,
                  528 -> 32,
                  2048 -> 32,
                  512 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 @proc_table.0!1783 = [(0, 2, 0) -> 0, else -> 1],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  2 -> 1,
                  4 -> 0,
                  8 -> 0,
                  3 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
... != []

----------------------------------------------------------------------
Ran 1 test in 39.709s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_io_bitmap:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_io_bitmap (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 23.200s

OK

Syscall extintr:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_extintr (__main__.HV6) ... ERROR

======================================================================
ERROR: test_extintr (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 52, in extintr
    new.procs[pid].intr = new.procs[pid].intr | bit_mask
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 3144, in __ror__
    a, b = _coerce_exprs(self, other)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 987, in _coerce_exprs
    b = s.cast(b)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 3018, in cast
    return BitVecVal(val, self)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 3555, in BitVecVal
    return BitVecNumRef(Z3_mk_numeral(ctx.ref(), _to_int_str(val), bv.ast), ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 2750, in _to_int_str
    _z3_assert(False, "Python value cannot be used as a Z3 integer")
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 90, in _z3_assert
    raise Z3Exception(msg)
Z3Exception: Python value cannot be used as a Z3 integer

----------------------------------------------------------------------
Ran 1 test in 2.083s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_map_pml4:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_pml4 (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 19.574s

OK

Syscall sys_map_page_desc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_page_desc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 24.850s

OK

Syscall sys_map_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_proc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 23.699s

OK

Syscall sys_map_dev:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(2, n.0)),
                  If(Extract(1, 1, perm.0) == 0,
                     If(Not(ULE(63,
                                18446744073709551615 + pid.3)),
                        If(@current.0(0) == pid.3,
                           If(Not(ULE(8192, from.0)),
                              If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                                 7,
                                 If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                                    pid.3,
                                    If(And(Not(ULE(512,
                                        index.1)),
                                        And(Extract(0,
                                        0,
                                        perm.0) ==
                                        1,
                                        Extract(8,
                                        5,
                                        perm.0) ==
                                        0,
                                        Extract(62,
                                        12,
                                        perm.0) ==
                                        0)),
                                       If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                        0,
                                        If(And(from.0 ==
                                        pn.3,
                                        index.1 ==
                                        page_index.1),
                                        n.0 +
                                        UDiv((uintptr)@devices.1,
                                        4096) <<
                                        12 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           If(@proc_table->struct.proc::ppid.0(0,
                                        pid.3) ==
                              @current.0(0),
                              If(@proc_table->struct.proc::state.0(0,
                                        pid.3) ==
                                 1,
                                 If(Not(ULE(8192, from.0)),
                                    If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                                       7,
                                       If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                                        pid.3,
                                        If(And(Not(ULE(512,
                                        index.1)),
                                        And(Extract(0,
                                        0,
                                        perm.0) ==
                                        1,
                                        Extract(8,
                                        5,
                                        perm.0) ==
                                        0,
                                        Extract(62,
                                        12,
                                        perm.0) ==
                                        0)),
                                        If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                        0,
                                        If(And(from.0 ==
                                        pn.3,
                                        index.1 ==
                                        page_index.1),
                                        n.0 +
                                        UDiv((uintptr)@devices.1,
                                        4096) <<
                                        12 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1))),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(And(Not(pid.3 <= 0), Not(64 <= pid.3)),
                      Or(pid.3 == current.0,
                         And(procs_ppid.1(pid.3) ==
                             current.0,
                             procs_state.1(pid.3) == 1)),
                      Not(ULE(2, n.0)),
                      Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 7,
                      pages_owner.1(from.0) == pid.3,
                      Not(ULE(512, index.1)),
                      And(Extract(8, 5, perm.0) == 0,
                          Extract(62, 12, perm.0) == 0),
                      Not(Extract(0, 0, perm.0) == 0),
                      Extract(1, 1, perm.0) == 0,
                      Extract(0,
                              0,
                              pages_data.1(from.0, index.1)) ==
                      0),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     UDiv(devices_ptr_to_int.0, 4096) +
                     n.0 +
                     4 <<
                     12 |
                     perm.0,
                     pages_data.1(pn.3, page_index.1)),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_map_dev (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_map_dev (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 5334544802981625856,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 1,
 page_index.1!1496 = 0,
 from.0 = 4098,
 (uintptr)@file_table.0 = 0,
 n.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 5334544802981625856,
 iotlbinv.1 = False,
 current.0 = 4,
 pid.3 = 1,
 pn.3!1497 = 4098,
 pages_ptr_to_int.0 = 0,
 index.1 = 0,
 @page_desc_table->struct.page_desc::pid.0!1864 = [(0, 0) ->
                                        4,
                                        (0, 16) -> 4,
                                        (0, 1) -> 4,
                                        else -> 1],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1861(Var(0),
                                        k!1855(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [5 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 4],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1866(Var(0),
                                        k!1855(Var(1)))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0!1866 = [(0, 1) -> 256,
                                        else -> 16],
 @proc_table->struct.proc::ppid.0 = [(0, 1) -> 4,
                                     else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1862(Var(0),
                                        k!1856(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [4 -> 0,
                            1 -> 64,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 k!1856 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(8, Var(0)),
                 If(ULE(16, Var(0)),
                    If(ULE(64, Var(0)),
                       If(ULE(256, Var(0)),
                          If(ULE(4098, Var(0)),
                             If(ULE(8193, Var(0)),
                                8193,
                                4098),
                             256),
                          64),
                       16),
                    8),
                 1),
              0)],
 procs_nr_fds.3 = [5 -> 0,
                   2 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 k!1855 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(5, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          5),
                       4),
                    2),
                 1),
              0)],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 procs_nr_ports.3 = [5 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [4 -> 1,
                  1 -> 8,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [4 -> 16,
                1 -> 256,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 @proc_table->struct.proc::page_table_root.0!1865 = [(0, 1) ->
                                        64,
                                        else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [1 -> 4,
                  16 -> 4,
                  0 -> 4,
                  4098 -> 1,
                  8 -> 1,
                  256 -> 1,
                  64 -> 1,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 4098, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 4],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [4 -> 3,
                  1 -> 1,
                  5 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [5 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1863 = [(0, 4) -> 3,
                                        (0, 1) -> 1,
                                        else -> 0],
 procs_nr_pages.3 = [5 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [5 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
... != []

----------------------------------------------------------------------
Ran 1 test in 29.620s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_map_file:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_file (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 24.340s

OK

Syscall sys_alloc_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pd (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 39.534s

OK

Syscall sys_alloc_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pt (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 41.098s

OK

Syscall sys_alloc_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 39.056s

OK

Syscall sys_copy_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_copy_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_copy_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 61, in sys_copy_frame
    new.pages[to].data = lambda idx, oldfn: old.pages[frm].data(idx)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 11.970s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_protect_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_protect_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 12.209s

OK

Syscall sys_free_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     5,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              6,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 5,
                      pages_type.1(to.0) == 6,
                      pages_owner.1(from.0) == current.0,
                      pages_owner.1(to.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pd (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pd (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 pn.3!1096 = 2222,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 from.0 = 1024,
 (uintptr)@file_table.0 = 0,
 page_index.1!1095 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 13194104578048,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 2222,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 index.1 = 2,
 pages_ptr_to_int.0 = 13194104578048,
 procs_nr_ports.3 = [1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 17],
 procs_stack.1 = [16 -> 4,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [16 -> 4,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 17],
 procs_io_bitmap_b.1 = [16 -> 128,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 4],
 @proc_table->struct.proc::ipc_page.0 = [else -> 17],
 @proc_table->struct.proc::stack.0 = [else -> 4],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [4 -> 16,
                  0 -> 16,
                  1024 -> 16,
                  2222 -> 16,
                  128 -> 16,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 17],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 @pages.0 = [(0, 2222, 0) -> 576460752303423488,
             (0, 1024, 2) -> 13194113679361,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [1 -> 0,
                    20 -> 0,
                    32 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 17],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  1 -> 0,
                  32 -> 0,
                  20 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 17],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 17],
 procs_ipc_size.1 = [else -> 17],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       20 -> 0,
                       32 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 17],
 @proc_table->struct.proc::state.0!1507 = [(0, 16) -> 3,
                                        else -> 0],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 17],
 procs_nr_pages.3 = [1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 pages_data.1 = [(2222, 0) -> 576460752303423488,
                 else -> 13194113679361],
 procs_nr_intremaps.3 = [1 -> 0,
                         20 -> 0,
                         32 -> 0,
                         17 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 procs_nr_children.3 = [1 -> 0,
                        20 -> 0,
                        32 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 files_refcnt.4 = [else -> 17],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 4],
 procs_io_bitmap_a.1 = [16 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 k!1500 = [else ->
           If(ULE(16, Var(0)),
              If(ULE(17, Var(0)),
                 If(ULE(20, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       20),
                    17),
                 16),
              1)],
 k!1501 = [else ->
           If(ULE(4, Var(0)),
              If(ULE(128, Var(0)),
                 If(ULE(1024, Var(0)),
                    If(ULE(2222, Var(0)),
                       If(ULE(8193, Var(0)), 8193, 2222),
                       1024),
                    128),
                 4),
              0)],
 pcipages_owner.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 intremaps_vector.1 = [else -> 0],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        20 -> 0,
                        32 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 17],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1506 = [(0, 0) ->
                                        4,
                                        (0, 1024) -> 5,
                                        (0, 2222) -> 6,
                                        else -> 2],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [4 -> 2,
                 0 -> 4,
                 1024 -> 5,
                 2222 -> 6,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.035s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_free_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     6,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              7,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 6,
                      pages_type.1(to.0) == 7,
                      pages_owner.1(from.0) == current.0,
                      pages_owner.1(to.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 pn.3!1238 = 4,
 page_desc_table_ptr_to_int.0 = 0,
 page_index.1!1237 = 0,
 from.0 = 1,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 49152,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 4,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 2,
 index.1 = 128,
 pages_ptr_to_int.0 = 49152,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 49152],
 k!1659 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(4, Var(0)),
                 If(ULE(5, Var(0)),
                    If(ULE(8, Var(0)),
                       If(ULE(9, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(64, Var(0)),
                                If(ULE(128, Var(0)),
                                   If(ULE(512, Var(0)),
                                      If(ULE(768, Var(0)),
                                        If(ULE(1024, Var(0)),
                                        If(ULE(1028, Var(0)),
                                        If(ULE(8193, Var(0)),
                                        8193,
                                        1028),
                                        1024),
                                        768),
                                        512),
                                      128),
                                   64),
                                32),
                             9),
                          8),
                       5),
                    4),
                 1),
              0)],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1664(Var(0),
                                        k!1658(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 49152],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1665(Var(0),
                                        k!1658(Var(1)))],
 k!1658 = [else ->
           If(ULE(2, Var(0)),
              If(ULE(3, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    3),
                 2),
              1)],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    32 -> 0,
                    4 -> 0,
                    3 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 49152],
 @page_desc_table->struct.page_desc::pid.0!1668 = [(0, 512) ->
                                        1,
                                        (0, 0) -> 1,
                                        (0, 1024) -> 4,
                                        (0, 9) -> 4,
                                        (0, 8) -> 32,
                                        (0, 128) -> 32,
                                        (0, 5) -> 3,
                                        (0, 64) -> 3,
                                        else -> 2],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 49152],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 49152],
 procs_ipc_size.1 = [else -> 49152],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 49152],
 @proc_table->struct.proc::hvm.0!1671 = [(0, 1) -> 0,
                                        else -> 32],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 49152],
 pages_data.1 = [(4, 0) -> 2251799813685248, else -> 65537],
 files_refcnt.4 = [else -> 49152],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1671(Var(0),
                                        k!1658(Var(1)))],
 procs_io_bitmap_a.1 = [4 -> 1024,
                        32 -> 8,
                        3 -> 5,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1666(Var(0),
                                        k!1659(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table->struct.proc::state.0!1667 = [(0, 2) -> 3,
                                        else -> 0],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [2 -> 768,
                            1 -> 512,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   32 -> 0,
                   4 -> 0,
                   3 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @proc_table->struct.proc::stack.0!1665 = [(0, 1) -> 0,
                                        else -> 1028],
 procs_intr.1 = [else -> 49152],
 @page_desc_table->struct.page_desc::type.0!1666 = [(0, 768) ->
                                        4,
                                        (0, 1) -> 6,
                                        (0, 4) -> 7,
                                        (0, 512) -> 4,
                                        else -> 2],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 49152],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1669(Var(0),
                                        k!1658(Var(1)))],
 procs_nr_ports.3 = [1 -> 0,
                     32 -> 0,
                     4 -> 0,
                     3 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 49152],
 procs_stack.1 = [2 -> 1028,
                  1 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [2 -> 32,
                1 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [4 -> 9,
                        32 -> 128,
                        3 -> 64,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0!1664 = [(0, 32) ->
                                        8,
                                        (0, 3) -> 5,
                                        else -> 1024],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 49152],
 pages_owner.1 = [1028 -> 2,
                  32 -> 2,
                  768 -> 2,
                  1 -> 2,
... != []

----------------------------------------------------------------------
Ran 1 test in 21.768s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_free_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     7,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              3,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 7,
                      pages_type.1(to.0) == 3,
                      pages_owner.1(from.0) == current.0,
                      pages_owner.1(to.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 page_index.1!1100 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 from.0 = 2,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 786432,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 32,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 pn.3!1101 = 32,
 index.1 = 0,
 pages_ptr_to_int.0 = 786432,
 procs_nr_ports.3 = [32 -> 0,
                     4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 256,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [1 -> 1,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 256],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [256 -> 1,
                  1 -> 1,
                  0 -> 1,
                  2 -> 1,
                  32 -> 1,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 @pages.0 = [(0, 32, 0) -> 576460752303423488,
             (0, 2, 0) -> 917505,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [32 -> 0,
                    4 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  4 -> 0,
                  32 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 k!1506 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(32, Var(0)),
                    If(ULE(256, Var(0)),
                       If(ULE(8193, Var(0)), 8193, 256),
                       32),
                    2),
                 1),
              0)],
 @proc_table.3 = [else -> 0],
 dmapages_owner.1 = [else -> 8192],
 k!1505 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    2),
                 1),
              0)],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [32 -> 0,
                       4 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [32 -> 0,
                     4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 pages_data.1 = [(32, 0) -> 576460752303423488,
                 else -> 917505],
 procs_nr_intremaps.3 = [32 -> 0,
                         4 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 procs_nr_children.3 = [32 -> 0,
                        4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 1],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [32 -> 0,
                        4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1511 = [(0, 0) ->
                                        4,
                                        (0, 2) -> 7,
                                        (0, 32) -> 3,
                                        else -> 2],
 pages_type.1 = [256 -> 2,
                 1 -> 2,
                 0 -> 4,
                 2 -> 7,
                 32 -> 3,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1511(Var(0),
                                        k!1506(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
... != []

----------------------------------------------------------------------
Ran 1 test in 20.978s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_reclaim_page:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(ULT(pn.3, 8192),
    pages_type.1(pn.3) != 0,
    And(UGT(pages_owner.1(pn.3), 0),
        ULT(pages_owner.1(pn.3), 64),
        procs_state.1(pages_owner.1(pn.3)) == 5),
    False) ==
(If(Not(ULE(8192, pn.3)),
    If(@page_desc_table->struct.page_desc::type.0(0, pn.3) ==
       0,
       4294967274,
       If(Not(ULE(63,
                  18446744073709551615 +
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        pn.3))),
          If(@proc_table->struct.proc::state.0(0,
                                        @page_desc_table->struct.page_desc::pid.0(0,
                                        pn.3)) ==
             5,
             If(@proc_table->struct.proc::nr_devs.0(0,
                                        @page_desc_table->struct.page_desc::pid.0(0,
                                        pn.3)) ==
                0,
                0,
                4294967280),
             4294967283),
          4294967283)),
    4294967274) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_page (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_page (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 pn.3 = 2,
 pages_ptr_to_int.0 = 0,
 @vector_table.0 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0!679 = [(0, 4) ->
                                        1024,
                                        else -> 8],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!679(Var(0),
                                        k!673(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [32 -> 0,
                    4 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 k!674 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(2, Var(0)),
                If(ULE(8, Var(0)),
                   If(ULE(1024, Var(0)),
                      If(ULE(2048, Var(0)),
                         If(ULE(8193, Var(0)), 8193, 2048),
                         1024),
                      8),
                   2),
                1),
             0)],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 k!673 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(2, Var(0)),
                If(ULE(4, Var(0)),
                   If(ULE(32, Var(0)),
                      If(ULE(65, Var(0)), 65, 32),
                      4),
                   2),
                1),
             0)],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::type.0!680 = [(0, 0) ->
                                        4,
                                        (0, 2) -> 1,
                                        else -> 2],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 8],
 procs_io_bitmap_a.1 = [1 -> 8,
                        4 -> 1024,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!680(Var(0),
                                        k!674(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [1 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [4 -> 0,
                   2 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::pid.0!682 = [(0, 2) ->
                                        32,
                                        (0, 1024) -> 4,
                                        (0, 2048) -> 4,
                                        else -> 1],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!683(Var(0),
                                        k!673(Var(1)))],
 procs_nr_ports.3 = [4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [1 -> 8,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [1 -> 1,
                        4 -> 2048,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [1 -> 1,
                  8 -> 1,
                  0 -> 1,
                  2 -> 32,
                  2048 -> 4,
                  1024 -> 4,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  32 -> 5,
                  4 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [4 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [4 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 intremaps_vector.1 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
... != []

----------------------------------------------------------------------
Ran 1 test in 10.685s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_set_runnable:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_set_runnable (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_set_runnable (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 54, in sys_set_runnable
    new.procs[pid].ready.next = old.current
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 3.213s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall switch_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll(pid.0,
       Implies(And(pid.0 > 0, pid.0 < 64),
               @proc_table->struct.proc::state.0(0, pid.0) ==
               procs_state.1(pid.0)))
does not imply
ForAll(pid.4,
       Implies(And(pid.4 > 0, pid.4 < 64),
               If(Not(ULE(63, 18446744073709551615 + pid.3)),
                  If(@proc_table->struct.proc::state.0(0,
                                        pid.3) ==
                     2,
                     If(@current.0(0) == pid.3,
                        @proc_table->struct.proc::state.0(0,
                                        pid.4),
                        If(@proc_table->struct.proc::state.0(0,
                                        @current.0(0)) ==
                           3,
                           If(@proc_table->struct.proc::killed.0(0,
                                        @current.0(0)) ==
                              0,
                              If(pid.3 == pid.4,
                                 3,
                                 If(@current.0(0) == pid.4,
                                    2,
                                    @proc_table->struct.proc::state.0(0,
                                        pid.4))),
                              If(pid.3 == pid.4,
                                 3,
                                 If(@current.0(0) == pid.4,
                                    5,
                                    @proc_table->struct.proc::state.0(0,
                                        pid.4)))),
                           If(pid.3 == pid.4,
                              3,
                              @proc_table->struct.proc::state.0(0,
                                        pid.4)))),
                     @proc_table->struct.proc::state.0(0,
                                        pid.4)),
                  @proc_table->struct.proc::state.0(0,
                                        pid.4)) ==
               procs_state.1(pid.4)))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_switch_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_switch_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pid.4!1439 = 32,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 8,
 pid.3 = 32,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 512],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!2016(Var(0),
                                        k!2010(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    36 -> 0,
                    10 -> 0,
                    33 -> 0,
                    16 -> 0,
                    9 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!2021(Var(0),
                                        k!2010(Var(1)))],
 procs_io_bitmap_a.1 = [36 -> 512,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> True],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!2017(Var(0),
                                        k!2011(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [8 -> 0,
                            32 -> 128,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   36 -> 0,
                   10 -> 0,
                   33 -> 0,
                   16 -> 0,
                   9 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::state.0!2018 = [(0, 8) -> 3,
                                        (0, 32) -> 2,
                                        else -> 0],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 1056],
 @proc_table->struct.proc::hvm.0!2021 = [(0, 32) -> 1026,
                                        else -> 1024],
 procs_nr_ports.3 = [1 -> 0,
                     36 -> 0,
                     10 -> 0,
                     33 -> 0,
                     16 -> 0,
                     9 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [8 -> 2,
                  32 -> 32,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [8 -> 1024,
                32 -> 1026,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 2097152],
 procs_io_bitmap_b.1 = [36 -> 1056,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @page_desc_table->struct.page_desc::type.0!2017 = [(0, 0) ->
                                        4,
                                        (0, 128) -> 4,
                                        else -> 2],
 pages_owner.1 = [2 -> 8,
                  1024 -> 8,
                  0 -> 8,
                  128 -> 32,
                  32 -> 32,
                  1026 -> 32,
                  1056 -> 36,
                  512 -> 36,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @proc_table->struct.proc::stack.0!2016 = [(0, 32) -> 32,
                                        else -> 2],
 @current.0 = [else -> 8],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 @page_desc_table->struct.page_desc::pid.0!2019 = [(0, 1026) ->
                                        32,
                                        (0, 32) -> 32,
                                        (0, 128) -> 32,
                                        (0, 512) -> 36,
                                        (0, 1056) -> 36,
                                        else -> 8],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [8 -> 3,
                  32 -> 2,
                  33 -> 0,
                  10 -> 0,
                  1 -> 0,
                  36 -> 0,
                  16 -> 0,
                  9 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       36 -> 0,
                       10 -> 0,
                       33 -> 0,
                       16 -> 0,
                       9 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [1 -> 0,
                     36 -> 0,
                     10 -> 0,
                     33 -> 0,
                     16 -> 0,
                     9 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         36 -> 0,
                         10 -> 0,
                         33 -> 0,
                         16 -> 0,
                         9 -> 0,
                         else ->
... != []

----------------------------------------------------------------------
Ran 1 test in 15.219s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_kill:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_kill (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_kill (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 64, in sys_kill
    old.procs[pid].ready.next
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 4.456s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_reap:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reap (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_reap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 69, in sys_reap
    new.procs[pid].launched = z3.BoolVal(False)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 187, in __setattr__
    raise AttributeError("No such attribute: '{}'".format(attribute))
AttributeError: No such attribute: 'launched'

----------------------------------------------------------------------
Ran 1 test in 12.378s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_reparent:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(pid.3 > 0, pid.3 < 64),
    procs_state.1(procs_ppid.1(pid.3)) == 5,
    Or(procs_state.1(1) == 2, procs_state.1(1) == 3)) ==
(If(Not(ULE(63, 18446744073709551615 + pid.3)),
    If(Not(ULE(63,
               18446744073709551615 +
               @proc_table->struct.proc::ppid.0(0, pid.3))),
       If(@proc_table->struct.proc::state.0(0,
                                        @proc_table->struct.proc::ppid.0(0,
                                        pid.3)) ==
          5,
          If(Extract(63,
                     1,
                     @proc_table->struct.proc::state.0(0, 1)) ==
             1,
             0,
             4294967274),
          4294967274),
       4294967274),
    4294967293) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reparent (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reparent (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 pid.3 = 32,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 32],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1061(Var(0),
                                        k!1055(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [2 -> 0,
                    24 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 128],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 k!1056 = [else ->
           If(ULE(2, Var(0)),
              If(ULE(32, Var(0)),
                 If(ULE(64, Var(0)),
                    If(ULE(256, Var(0)),
                       If(ULE(512, Var(0)),
                          If(ULE(2048, Var(0)),
                             If(ULE(4096, Var(0)),
                                If(ULE(8193, Var(0)),
                                   8193,
                                   4096),
                                2048),
                             512),
                          256),
                       64),
                    32),
                 2),
              0)],
 @proc_table->struct.proc::page_table_root.0!1065 = [(0, 1) ->
                                        256,
                                        (0, 32) -> 2048,
                                        else -> 2],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 k!1055 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(16, Var(0)),
                    If(ULE(17, Var(0)),
                       If(ULE(24, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(65, Var(0)), 65, 32),
                             24),
                          17),
                       16),
                    2),
                 1),
              0)],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1066(Var(0),
                                        k!1055(Var(1)))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [(0, 32) -> 128,
                                     else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1062(Var(0),
                                        k!1056(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [16 -> 2,
                            1 -> 256,
                            32 -> 2048,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [2 -> 0,
                   24 -> 0,
                   17 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::type.0!1062 = [(0, 32) ->
                                        3,
                                        (0, 2) -> 4,
                                        (0, 256) -> 4,
                                        (0, 2048) -> 4,
                                        else -> 2],
 @proc_table->struct.proc::state.0!1063 = [(0, 16) -> 3,
                                        (0, 1) -> 2,
                                        else -> 0],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 procs_nr_ports.3 = [2 -> 0,
                     24 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 0,
                  1 -> 64,
                  32 -> 512,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [16 -> 0,
                1 -> 64,
                32 -> 4096,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [0 -> 16,
                  2 -> 16,
                  64 -> 1,
                  256 -> 1,
                  32 -> 16,
                  512 -> 32,
                  4096 -> 32,
                  2048 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  128 -> 5,
                  1 -> 2,
                  2 -> 0,
                  24 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [2 -> 0,
                       24 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [16 -> 32,
                     else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [2 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 6.449s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall recv_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(pid.3 > 0, pid.3 < 64),
    procs_state.1(pid.3) == 2,
    ULT(pn.3, 8192),
    pages_owner.1(pn.3) == current.0,
    pages_type.1(pn.3) == 3,
    And(fd.3 >= 0, fd.3 < 16),
    Or(procs_ofile.1(current.0, fd.3) == 0,
       Not(And(UGT(procs_ofile.1(current.0, fd.3), 0),
               ULT(procs_ofile.1(current.0, fd.3), 128)))),
    current.0 != pid.3) ==
(If(Not(ULE(63, 18446744073709551615 + pid.3)),
    If(And(Not(ULE(8192, pn.3)),
           @proc_table->struct.proc::state.0(0, pid.3) == 2),
       If(@page_desc_table->struct.page_desc::pid.0(0, pn.3) ==
          @current.0(0),
          If(@page_desc_table->struct.page_desc::type.0(0,
                                        pn.3) ==
             3,
             If(Not(ULE(16, fd.3)),
                If(Not(ULE(127,
                           18446744073709551615 +
                           @proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, fd.3)))),
                   4294967274,
                   0),
                0),
             4294967274),
          4294967283),
       4294967274),
    4294967293) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_recv_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_recv_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 fd.3 = 256,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 32,
 pid.3 = 2,
 pn.3 = 4096,
 pages_ptr_to_int.0 = 0,
 @vector_table.0 = [else -> 8192],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1416(Var(0),
                                        k!1410(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    33 -> 0,
                    8 -> 0,
                    4 -> 0,
                    3 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1422(Var(0),
                                        k!1410(Var(1)))],
 @page_desc_table->struct.page_desc::type.0!1417 = [(0, 0) ->
                                        4,
                                        (0, 4096) -> 3,
                                        (0, 2) -> 4,
                                        else -> 2],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> True],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @page_desc_table->struct.page_desc::pid.0!1420 = [(0, 1024) ->
                                        2,
                                        (0, 2) -> 2,
                                        (0, 8) -> 2,
                                        else -> 32],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1417(Var(0),
                                        k!1411(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [32 -> 0,
                            2 -> 2,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 @proc_table->struct.proc::hvm.0!1422 = [(0, 2) -> 1024,
                                        else -> 64],
 procs_nr_fds.3 = [1 -> 0,
                   33 -> 0,
                   8 -> 0,
                   4 -> 0,
                   3 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 procs_nr_ports.3 = [1 -> 0,
                     33 -> 0,
                     8 -> 0,
                     4 -> 0,
                     3 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [32 -> 32,
                  2 -> 8,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [32 -> 64,
                2 -> 1024,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 32],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [32 -> 32,
                  64 -> 32,
                  0 -> 32,
                  4096 -> 32,
                  2 -> 2,
                  8 -> 2,
                  1024 -> 2,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 32],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [32 -> 3,
                  2 -> 2,
                  8 -> 0,
                  33 -> 0,
                  4 -> 0,
                  1 -> 0,
                  3 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       33 -> 0,
                       8 -> 0,
                       4 -> 0,
                       3 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [1 -> 0,
                     33 -> 0,
                     8 -> 0,
                     4 -> 0,
                     3 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         33 -> 0,
                         8 -> 0,
                         4 -> 0,
                         3 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        33 -> 0,
                        8 -> 0,
                        4 -> 0,
                        3 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else ->
                                        @proc_table->struct.proc::page_table_root.0!1421(Var(0),
                                        k!1410(Var(1)))],
 vectors_owner.1 = [else ->
... != []

----------------------------------------------------------------------
Ran 1 test in 16.878s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall call_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(pid.3 > 0, pid.3 < 64),
    procs_state.1(pid.3) == 4,
    ULT(inpn.0, 8192),
    pages_owner.1(inpn.0) == current.0,
    ULE(size.0, 4096),
    ULT(outpn.0, 8192),
    pages_owner.1(outpn.0) == current.0,
    pages_type.1(outpn.0) == 3,
    Or(outfd.0 < 0,
       And(And(outfd.0 >= 0, outfd.0 < 16),
           procs_ofile.1(current.0, outfd.0) == 0)),
    Or(procs_ipc_from.1(pid.3) == 0,
       procs_ipc_from.1(pid.3) == current.0),
    pid.3 != current.0) ==
(If(If(ULE(63, 18446744073709551615 + pid.3),
       4294967293,
       If(@proc_table->struct.proc::state.0(0, pid.3) == 4,
          If(ULE(8192, inpn.0),
             4294967274,
             If(@page_desc_table->struct.page_desc::pid.0(0,
                                        inpn.0) ==
                @current.0(0),
                If(And(Extract(63, 13, size.0) == 0,
                       ULE(Extract(12, 0, size.0), 4096)),
                   If(ULE(8192, outpn.0),
                      4294967274,
                      If(@page_desc_table->struct.page_desc::pid.0(0,
                                        outpn.0) ==
                         @current.0(0),
                         If(@page_desc_table->struct.page_desc::type.0(0,
                                        outpn.0) ==
                            3,
                            If(ULE(16, outfd.0),
                               If(Or(@proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                     0,
                                     @proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                     @current.0(0)),
                                  0,
                                  4294967283),
                               If(ULE(127,
                                      18446744073709551615 +
                                      @proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, outfd.0))),
                                  If(Or(@proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        0,
                                        @proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        @current.0(0)),
                                     0,
                                     4294967283),
                                  4294967274)),
                            4294967274),
                         4294967283)),
                   4294967274),
                4294967283)),
          4294967285)) ==
    0,
    0,
    If(Not(ULE(63, 18446744073709551615 + pid.3)),
       If(@proc_table->struct.proc::state.0(0, pid.3) == 4,
          If(Not(ULE(8192, inpn.0)),
             If(@page_desc_table->struct.page_desc::pid.0(0,
                                        inpn.0) ==
                @current.0(0),
                If(Not(And(Extract(63, 13, size.0) == 0,
                           ULE(Extract(12, 0, size.0), 4096))),
                   4294967274,
                   If(Not(ULE(8192, outpn.0)),
                      If(@page_desc_table->struct.page_desc::pid.0(0,
                                        outpn.0) ==
                         @current.0(0),
                         If(@page_desc_table->struct.page_desc::type.0(0,
                                        outpn.0) ==
                            3,
                            If(Not(ULE(16, outfd.0)),
                               If(Not(ULE(127,
                                        18446744073709551615 +
                                        @proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, outfd.0)))),
                                  4294967274,
                                  If(Or(@proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        0,
                                        @proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        @current.0(0)),
                                     0,
                                     4294967283)),
                               If(Or(@proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                     0,
                                     @proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                     @current.0(0)),
                                  0,
                                  4294967283)),
                            4294967274),
                         4294967283),
                      4294967274)),
                4294967283),
             4294967274),
          4294967285),
       4294967293)) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_call_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_call_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 inpn.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 outpn.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 3,
 pid.3 = 16,
 outfd.0 = 65536,
 pages_ptr_to_int.0 = 0,
 size.0 = 1,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else ->
                                        @proc_table->struct.proc::ipc_page.0!709(Var(0),
                                        k!702(Var(1)))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!708(Var(0),
                                        k!702(Var(1)))],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!710(Var(0),
                                        k!702(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [(0, 16) -> 3,
                                        else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [32 -> 0,
                    20 -> 0,
                    8 -> 0,
                    1 -> 0,
                    4 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 procs_ipc_from.1 = [else -> 3],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 @proc_table->struct.proc::io_bitmap_a.0!708 = [(0, 18) ->
                                        16,
                                        else -> 4],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!716(Var(0),
                                        k!702(Var(1)))],
 procs_io_bitmap_a.1 = [18 -> 16,
                        20 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!711(Var(0),
                                        k!703(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table->struct.proc::io_bitmap_b.0!714 = [(0, 18) ->
                                        16,
                                        else -> 1536],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [3 -> 4096,
                            16 -> 1024,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [32 -> 0,
                   20 -> 0,
                   8 -> 0,
                   1 -> 0,
                   4 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 k!703 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(2, Var(0)),
                If(ULE(4, Var(0)),
                   If(ULE(16, Var(0)),
                      If(ULE(256, Var(0)),
                         If(ULE(512, Var(0)),
                            If(ULE(1024, Var(0)),
                               If(ULE(1536, Var(0)),
                                  If(ULE(2048, Var(0)),
                                     If(ULE(4096, Var(0)),
                                        If(ULE(6144, Var(0)),
                                        If(ULE(8193, Var(0)),
                                        8193,
                                        6144),
                                        4096),
                                        2048),
                                     1536),
                                  1024),
                               512),
                            256),
                         16),
                      4),
                   2),
                1),
             0)],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 k!702 = [else ->
          If(ULE(3, Var(0)),
             If(ULE(4, Var(0)),
                If(ULE(8, Var(0)),
                   If(ULE(16, Var(0)),
                      If(ULE(17, Var(0)),
                         If(ULE(18, Var(0)),
                            If(ULE(20, Var(0)),
                               If(ULE(32, Var(0)),
                                  If(ULE(65, Var(0)),
                                     65,
                                     32),
                                  20),
                               18),
                            17),
                         16),
                      8),
                   4),
                3),
             1)],
 @proc_table->struct.proc::ipc_page.0!709 = [(0, 17) -> 256,
                                        else -> 6144],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!714(Var(0),
                                        k!702(Var(1)))],
 @proc_table->struct.proc::page_table_root.0!715 = [(0, 16) ->
                                        1024,
                                        else -> 4096],
 procs_nr_ports.3 = [32 -> 0,
                     20 -> 0,
                     8 -> 0,
                     1 -> 0,
                     4 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [3 -> 1,
                  16 -> 2048,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [3 -> 512,
                16 -> 2,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [18 -> 16,
                        20 -> 1536,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [(0, 16) -> 2147483648,
                                       else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [1 -> 3,
                  512 -> 3,
                  4096 -> 3,
                  0 -> 3,
                  2048 -> 16,
                  2 -> 16,
                  1024 -> 16,
                  256 -> 17,
... != []

----------------------------------------------------------------------
Ran 1 test in 39.586s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_create:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_create (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 5.514s

OK

Syscall sys_close:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_close (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 18.161s

OK

Syscall sys_dup:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_dup (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 19.115s

OK

Syscall sys_lseek:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_lseek (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_lseek (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
ValueError: too many values to unpack

----------------------------------------------------------------------
Ran 1 test in 3.254s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_map_pcipage:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_map_pcipage (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_map_pcipage (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 43, in sys_map_pcipage
    old.pci[old.pcipages[pcipn].devid].owner == old.current,
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'PCIPage' object has no attribute 'devid'

----------------------------------------------------------------------
Ran 1 test in 10.304s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_root:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_iommu_root (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 9.325s

OK

Syscall sys_alloc_iommu_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           8,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 8,
                      pages_owner.1(from.0) == current.0,
                      pages_type.1(to.0) == 0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pdpt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pdpt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 pn.3!1109 = 2,
 (uintptr)@proc_table.0 = 0,
 page_index.1!1108 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 2,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 4792321,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 1,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 index.1 = 0,
 pages_ptr_to_int.0 = 4792321,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 4096],
 @page_desc_table->struct.page_desc::type.0!1525 = [(0, 0) ->
                                        4,
                                        (0, 1) -> 0,
                                        (0, 2) -> 8,
                                        else -> 2],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    32 -> 0,
                    20 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 8],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 k!1520 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(8, Var(0)),
                    If(ULE(4096, Var(0)),
                       If(ULE(8193, Var(0)), 8193, 4096),
                       8),
                    2),
                 1),
              0)],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 k!1519 = [else ->
           If(ULE(16, Var(0)),
              If(ULE(17, Var(0)),
                 If(ULE(20, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       20),
                    17),
                 16),
              1)],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1525(Var(0),
                                        k!1520(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [16 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   32 -> 0,
                   20 -> 0,
                   17 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 procs_nr_ports.3 = [1 -> 0,
                     32 -> 0,
                     20 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 4096,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [16 -> 8,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [4096 -> 16,
                  8 -> 16,
                  0 -> 16,
                  2 -> 16,
                  1 -> 0,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 2, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 @page_desc_table->struct.page_desc::pid.0!1527 = [(0, 1) ->
                                        0,
                                        else -> 16],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  20 -> 0,
                  32 -> 0,
                  1 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       32 -> 0,
                       20 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [1 -> 0,
                     32 -> 0,
                     20 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         32 -> 0,
                         20 -> 0,
                         17 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        32 -> 0,
                        20 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
... != []

----------------------------------------------------------------------
Ran 1 test in 20.527s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           9,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 9,
                      pages_owner.1(from.0) == current.0,
                      pages_type.1(to.0) == 0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pd (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pd (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 pn.3!1315 = 4,
 perm.0 = 1,
 from.0 = 4,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 577614330745294982,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 page_index.1!1314 = 0,
 index.1 = 0,
 pages_ptr_to_int.0 = 577614330745294982,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::pid.0!1734 = [(0, 0) ->
                                        4611686018427387904,
                                        (0, 20) -> 17,
                                        (0, 4096) -> 17,
                                        (0, 64) -> 32,
                                        (0, 2048) -> 32,
                                        else -> 16],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 64],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1731(Var(0),
                                        k!1725(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0!1732 = [(0, 1) ->
                                        4,
                                        (0, 0) -> 0,
                                        (0, 4) -> 9,
                                        (0, 20) -> 4,
                                        else -> 2],
 procs_nr_devs.3 = [1 -> 0,
                    20 -> 0,
                    32 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1733 = [(0, 16) -> 3,
                                        else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1736(Var(0),
                                        k!1725(Var(1)))],
 procs_io_bitmap_a.1 = [32 -> 64,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::hvm.0!1736 = [(0, 17) -> 4096,
                                        else -> 1024],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1732(Var(0),
                                        k!1726(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [16 -> 1,
                            17 -> 20,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   20 -> 0,
                   32 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 k!1726 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(4, Var(0)),
                 If(ULE(16, Var(0)),
                    If(ULE(20, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(1024, Var(0)),
                             If(ULE(2048, Var(0)),
                                If(ULE(4096, Var(0)),
                                   If(ULE(8193, Var(0)),
                                      8193,
                                      4096),
                                   2048),
                                1024),
                             64),
                          20),
                       16),
                    4),
                 1),
              0)],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 2048],
 k!1725 = [else ->
           If(ULE(16, Var(0)),
              If(ULE(17, Var(0)),
                 If(ULE(20, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       20),
                    17),
                 16),
              1)],
 @proc_table->struct.proc::page_table_root.0!1735 = [(0, 17) ->
                                        20,
                                        else -> 1],
 procs_nr_ports.3 = [1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 16,
                  17 -> 4096,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [16 -> 1024,
                17 -> 4096,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [32 -> 2048,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [16 -> 16,
                  1024 -> 16,
                  1 -> 16,
                  4 -> 16,
                  0 -> 4611686018427387904,
                  2048 -> 32,
                  64 -> 32,
                  4096 -> 17,
                  20 -> 17,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 4, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  20 -> 0,
                  32 -> 0,
                  1 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       20 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.186s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           10,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 10,
                      pages_owner.1(from.0) == current.0,
                      pages_type.1(to.0) == 0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 2,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 617314834637422593,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pn.3!1195 = 2,
 to.0 = 1,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 index.1 = 0,
 page_index.1!1194 = 0,
 pages_ptr_to_int.0 = 617314834637422593,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 1024],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8],
 @proc_table->struct.proc::ipc_page.0 = [else -> 1024],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1617(Var(0),
                                        k!1611(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    20 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 1024],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 1024],
 @proc_table.3 = [else -> 0],
 k!1612 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(8, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(128, Var(0)),
                             If(ULE(1024, Var(0)),
                                If(ULE(1088, Var(0)),
                                   If(ULE(8193, Var(0)),
                                      8193,
                                      1088),
                                   1024),
                                128),
                             64),
                          8),
                       4),
                    2),
                 1),
              0)],
 @proc_table->struct.proc::stack.0!1617 = [(0, 32) -> 1024,
                                        else -> 0],
 procs_ppid.1 = [else -> 1024],
 k!1611 = [else ->
           If(ULE(16, Var(0)),
              If(ULE(17, Var(0)),
                 If(ULE(20, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       20),
                    17),
                 16),
              1)],
 procs_ipc_size.1 = [else -> 1024],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 1024],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0!1618 = [(0, 64) ->
                                        4,
                                        (0, 1) -> 0,
                                        (0, 2) -> 10,
                                        (0, 1088) -> 4,
                                        else -> 2],
 dmapages_type.1 = [else -> 1024],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 1024],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1622(Var(0),
                                        k!1611(Var(1)))],
 procs_io_bitmap_a.1 = [20 -> 8,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1619 = [(0, 16) -> 3,
                                        else -> 0],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::page_table_root.0!1621 = [(0, 32) ->
                                        1088,
                                        else -> 64],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1618(Var(0),
                                        k!1612(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [16 -> 64,
                            32 -> 1088,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   20 -> 0,
                   17 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 1024],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 1024],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 4],
 procs_nr_ports.3 = [1 -> 0,
                     20 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 1024],
 procs_stack.1 = [16 -> 0,
                  32 -> 1024,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [16 -> 0,
                32 -> 128,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [20 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 1024],
 pages_owner.1 = [0 -> 16,
                  64 -> 16,
                  2 -> 16,
                  1024 -> 32,
                  128 -> 32,
                  1088 -> 32,
                  4 -> 20,
                  8 -> 20,
                  1 -> 0,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 2, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 @page_desc_table->struct.page_desc::pid.0!1620 = [(0, 1088) ->
                                        32,
                                        (0, 128) -> 32,
                                        (0, 1024) -> 32,
                                        (0, 1) -> 0,
                                        (0, 8) -> 20,
                                        (0, 4) -> 20,
                                        else -> 16],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  1 -> 0,
                  20 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 21.067s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(512, to.0)),
                  If(@dmapage_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           11,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                       (uintptr)@dmapages.0 +
                                       (to.0*32768)/8 |
                                       perm.0,
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(512, to.0)),
                      dmapages_type.1(to.0) == 0,
                      Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 11,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     dmapages_ptr_to_int.0 + to.0 << 12 |
                     perm.0,
                     pages_data.1(pn.3, page_index.1)),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 pn.3!1109 = 1,
 (uintptr)@proc_table.0 = 0,
 page_index.1!1108 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 1,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 70368746274888,
 file_table_ptr_to_int.0 = 0,
 to.0 = 0,
 (uintptr)@dmapages.0 = 70368746274888,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1520(Var(0),
                                        k!1514(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [4 -> 0,
                    32 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 0],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [4 -> 4,
                        32 -> 32,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [(0, 0) ->
                                        0,
                                        else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1521(Var(0),
                                        k!1515(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table->struct.proc::io_bitmap_a.0!1520 = [(0, 4) -> 4,
                                        else -> 32],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 @page_desc_table->struct.page_desc::type.0!1521 = [(0, 512) ->
                                        4,
                                        (0, 1) -> 11,
                                        else -> 2],
 procs_page_table_root.1 = [1 -> 512,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 k!1515 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(4, Var(0)),
                 If(ULE(32, Var(0)),
                    If(ULE(128, Var(0)),
                       If(ULE(512, Var(0)),
                          If(ULE(8193, Var(0)), 8193, 512),
                          128),
                       32),
                    4),
                 1),
              0)],
 procs_nr_fds.3 = [4 -> 0,
                   32 -> 0,
                   2 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 k!1514 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    2),
                 1),
              0)],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1524(Var(0),
                                        k!1514(Var(1)))],
 procs_nr_ports.3 = [4 -> 0,
                     32 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [1 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [4 -> 4,
                        32 -> 128,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [0 -> 1,
                  512 -> 1,
                  1 -> 1,
                  4 -> 4,
                  128 -> 32,
                  32 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1522 = [(0, 1) -> 3,
                                        else -> 0],
 @proc_table->struct.proc::io_bitmap_b.0!1524 = [(0, 4) -> 4,
                                        else -> 128],
 @pages.0 = [(0, 1, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  4 -> 0,
                  32 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [4 -> 0,
                       32 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [4 -> 0,
                     32 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [4 -> 0,
                         32 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
... != []

----------------------------------------------------------------------
Ran 1 test in 14.591s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_map_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_iommu_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 11.649s

OK

Syscall sys_reclaim_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_reclaim_iommu_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 6.377s

OK

Syscall sys_reclaim_iommu_root:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_reclaim_iommu_root (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 5.520s

OK

Syscall sys_alloc_vector:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_vector (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 2.632s

OK

Syscall sys_reclaim_vector:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(vectors_owner.1(vector.1) > 0,
        vectors_owner.1(vector.1) < 64),
    vectors_owner.1(vector.1) != 0,
    procs_state.1(vectors_owner.1(vector.1)) == 5,
    False) ==
(If(Not(ULE(63,
            18446744073709551615 +
            @vector_table.0(0, Concat(0, vector.1)))),
    If(@proc_table->struct.proc::state.0(0,
                                        @vector_table.0(0,
                                        Concat(0, vector.1))) ==
       5,
       If(@proc_table->struct.proc::nr_intremaps.0(0,
                                        @vector_table.0(0,
                                        Concat(0, vector.1))) ==
          0,
          0,
          4294967280),
       4294967283),
    4294967283) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_vector (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_vector (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 vector.1 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 40,
 pages_ptr_to_int.0 = 0,
 procs_nr_ports.3 = [1 -> 0,
                     48 -> 0,
                     44 -> 0,
                     41 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [40 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [40 -> 1,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [1 -> 40,
                  0 -> 40,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    48 -> 0,
                    44 -> 0,
                    41 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 40],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [40 -> 3,
                  32 -> 5,
                  1 -> 0,
                  48 -> 0,
                  44 -> 0,
                  41 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       48 -> 0,
                       44 -> 0,
                       41 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     48 -> 0,
                     44 -> 0,
                     41 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [32 -> 0,
                         1 -> 0,
                         48 -> 0,
                         44 -> 0,
                         41 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        48 -> 0,
                        44 -> 0,
                        41 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 vectors_owner.1 = [0 -> 32,
                    else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 1],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        48 -> 0,
                        44 -> 0,
                        41 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::state.0!879 = [(0, 40) -> 3,
                                        (0, 32) -> 5,
                                        else -> 0],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 files_type.1 = [else -> 8192],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [1 -> 2,
                 0 -> 4,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!878(Var(0),
                                        k!873(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [40 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 procs_ofile.1 = [else ->
                  @proc_table.0(0,
                                Var(0),
                                Concat(0, Var(1)))],
 pcipages_valid.1 = [else -> False],
 @proc_table.0 = [else -> 1],
 @proc_table.4 = [else -> 0],
 @proc_table->struct.proc::state.0 = [else ->
                                      @proc_table->struct.proc::state.0!879(Var(0),
                                        k!872(Var(1)))],
 procs_nr_fds.3 = [1 -> 0,
                   48 -> 0,
                   44 -> 0,
                   41 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_ipc_fd.1 = [else ->
                   @proc_table->struct.proc::ipc_fd.0(0,
... != []

----------------------------------------------------------------------
Ran 1 test in 4.255s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_intremap:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
iotlbinv.0 == iotlbinv.1
does not imply
iotlbinv.0 ==
If(And(Not(ULE(8, index.1)),
       intremaps_state.1(index.1) == 0,
       pci_owner.1(devid.1) == current.0,
       vectors_owner.1(vector.1) == current.0),
   True,
   iotlbinv.1)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_intremap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_intremap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 devid.1 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 vector.1 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 4,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 @pci_table.0 = [else -> 4],
 procs_nr_ports.3 = [1 -> 0,
                     6 -> 0,
                     8 -> 0,
                     16 -> 0,
                     32 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [4 -> 2048,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 intremaps_state.1 = [else -> 0],
 procs_hvm.1 = [4 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @intremap_table->struct.intremap::state.0 = [(0, 0) -> 0,
                                        else ->
                                        intremaps_state.1(Var(1))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 2048],
 @io_table.0 = [else -> 0],
 pages_owner.1 = [2048 -> 4,
                  0 -> 4,
                  512 -> 4,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    6 -> 0,
                    8 -> 0,
                    16 -> 0,
                    32 -> 0,
                    5 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 4],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [4 -> 3,
                  16 -> 0,
                  32 -> 0,
                  6 -> 0,
                  1 -> 0,
                  8 -> 0,
                  5 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1758 = [(0, 512) ->
                                        4,
                                        else -> 2],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       6 -> 0,
                       8 -> 0,
                       16 -> 0,
                       32 -> 0,
                       5 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1759 = [(0, 4) -> 3,
                                        else -> 0],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     6 -> 0,
                     8 -> 0,
                     16 -> 0,
                     32 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         6 -> 0,
                         8 -> 0,
                         16 -> 0,
                         32 -> 0,
                         5 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        6 -> 0,
                        8 -> 0,
                        16 -> 0,
                        32 -> 0,
                        5 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 512],
 vectors_owner.1 = [0 -> 4,
                    else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        6 -> 0,
                        8 -> 0,
                        16 -> 0,
                        32 -> 0,
                        5 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 k!1753 = [else ->
           If(ULE(512, Var(0)),
              If(ULE(2048, Var(0)),
                 If(ULE(8193, Var(0)), 8193, 2048),
                 512),
              0)],
 pages_type.1 = [2048 -> 2,
                 0 -> 2,
                 512 -> 4,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 k!1752 = [else ->
           If(ULE(4, Var(0)),
              If(ULE(5, Var(0)),
                 If(ULE(6, Var(0)),
... != []

----------------------------------------------------------------------
Ran 1 test in 9.078s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_reclaim_intremap:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
iotlbinv.0 == iotlbinv.1
does not imply
iotlbinv.0 ==
If(And(Not(ULE(8, index.1)),
       intremaps_state.1(index.1) == 1,
       And(Not(pci_owner.1(intremaps_devid.1(index.1)) <= 0),
           Not(64 <= pci_owner.1(intremaps_devid.1(index.1))),
           procs_state.1(pci_owner.1(intremaps_devid.1(index.1))) ==
           5)),
   True,
   iotlbinv.1)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_intremap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_intremap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 4,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 intremaps_state.1 = [else -> 1],
 @intremap_table->struct.intremap::state.0 = [(0, 0) -> 1,
                                        else ->
                                        intremaps_state.1(Var(1))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 2048],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 128],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1261(Var(0),
                                        k!1255(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [32 -> 0,
                    8 -> 0,
                    16 -> 0,
                    6 -> 0,
                    5 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @proc_table->struct.proc::stack.0!1261 = [(0, 32) -> 4096,
                                        else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 @proc_table->struct.proc::state.0!1263 = [(0, 4) -> 3,
                                        (0, 1) -> 5,
                                        else -> 0],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1266(Var(0),
                                        k!1255(Var(1)))],
 procs_io_bitmap_a.1 = [5 -> 128,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1262(Var(0),
                                        k!1256(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 pci_owner.1 = [0 -> 1,
                else -> @pci_table.0(0, Concat(0, Var(0)))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 @page_desc_table->struct.page_desc::type.0!1262 = [(0,
                                        2048) ->
                                        3,
                                        (0, 8) -> 4,
                                        (0, 1024) -> 4,
                                        else -> 2],
 procs_page_table_root.1 = [4 -> 8,
                            32 -> 1024,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [32 -> 0,
                   8 -> 0,
                   16 -> 0,
                   6 -> 0,
                   5 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 2],
 k!1256 = [else ->
           If(ULE(2, Var(0)),
              If(ULE(8, Var(0)),
                 If(ULE(64, Var(0)),
                    If(ULE(128, Var(0)),
                       If(ULE(1024, Var(0)),
                          If(ULE(2048, Var(0)),
                             If(ULE(4096, Var(0)),
                                If(ULE(8193, Var(0)),
                                   8193,
                                   4096),
                                2048),
                             1024),
                          128),
                       64),
                    8),
                 2),
              0)],
 k!1255 = [else ->
           If(ULE(4, Var(0)),
              If(ULE(5, Var(0)),
                 If(ULE(6, Var(0)),
                    If(ULE(8, Var(0)),
                       If(ULE(16, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(64, Var(0)),
                                If(ULE(65, Var(0)), 65, 64),
                                32),
                             16),
                          8),
                       6),
                    5),
                 4),
              1)],
 procs_nr_ports.3 = [32 -> 0,
                     8 -> 0,
                     16 -> 0,
                     6 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 1],
 procs_stack.1 = [4 -> 0,
                  32 -> 4096,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [4 -> 0,
                32 -> 64,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [5 -> 2,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 0],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [0 -> 4,
                  8 -> 4,
                  2048 -> 4,
                  4096 -> 32,
                  64 -> 32,
                  1024 -> 32,
                  2 -> 5,
                  128 -> 5,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @proc_table->struct.proc::hvm.0!1266 = [(0, 32) -> 64,
                                        else -> 0],
 @current.0 = [else -> 4],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 @page_desc_table->struct.page_desc::pid.0!1264 = [(0, 1024) ->
                                        32,
                                        (0, 64) -> 32,
                                        (0, 4096) -> 32,
                                        (0, 128) -> 5,
                                        (0, 2) -> 5,
                                        else -> 4],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [4 -> 3,
                  1 -> 5,
                  16 -> 0,
                  6 -> 0,
                  8 -> 0,
                  5 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 41.877s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_ack_intr:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_ack_intr (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_ack_intr (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 45, in sys_ack_intr
    mask = ~(z3.BitVecVal(1, 64) << bit_pos)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 3412, in __lshift__
    return BitVecRef(Z3_mk_bvshl(self.ctx_ref(), a.as_ast(), b.as_ast()), self.ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3core.py", line 1945, in Z3_mk_bvshl
    raise Z3Exception(lib().Z3_get_error_msg(a0, err))
Z3Exception: Argument (bvsmod vector.1 #x40) at position 1 does not match declaration (declare-fun bvshl ((_ BitVec 64) (_ BitVec 64)) (_ BitVec 64))

----------------------------------------------------------------------
Ran 1 test in 0.858s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_port:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_port (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 108.062s

OK

Syscall sys_reclaim_port:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_port (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_reclaim_port (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 42, in sys_reclaim_port
    z3.ULT(port, dt.SZ_64K),
AttributeError: 'module' object has no attribute 'SZ_64K'

----------------------------------------------------------------------
Ran 1 test in 1.972s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pdpt (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 42.207s

OK

Syscall sys_free_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     4,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              5,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 4,
                      pages_type.1(to.0) == 5,
                      pages_owner.1(from.0) == current.0,
                      pages_owner.1(to.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pdpt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pdpt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 from.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 562036736,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 2064,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 8,
 page_index.1!1096 = 1,
 pn.3!1097 = 2064,
 pages_ptr_to_int.0 = 562036736,
 index.1 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::hvm.0!1727 = [(0, 2) -> 32,
                                        else -> 4096],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1722(Var(0),
                                        k!1716(Var(1)))],
 @proc_table->struct.proc::stack.0!1722 = [(0, 2) -> 1,
                                        else -> 8],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [16 -> 0,
                    32 -> 0,
                    4 -> 0,
                    10 -> 0,
                    9 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @proc_table->struct.proc::page_table_root.0!1726 = [(0, 2) ->
                                        256,
                                        else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 @proc_table->struct.proc::state.0!1724 = [(0, 8) -> 3,
                                        else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [(2064, 1) -> 65537, else -> 570490881],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1727(Var(0),
                                        k!1716(Var(1)))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1723(Var(0),
                                        k!1717(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [8 -> 0,
                            2 -> 256,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [16 -> 0,
                   32 -> 0,
                   4 -> 0,
                   10 -> 0,
                   9 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 procs_nr_ports.3 = [16 -> 0,
                     32 -> 0,
                     4 -> 0,
                     10 -> 0,
                     9 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [8 -> 8,
                  2 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [8 -> 4096,
                2 -> 32,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [8 -> 8,
                  4096 -> 8,
                  0 -> 8,
                  2064 -> 8,
                  1 -> 2,
                  32 -> 2,
                  256 -> 2,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 2064, 1) -> 65537,
             (0, 0, 0) -> 570490881,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 8],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [8 -> 3,
                  32 -> 0,
                  16 -> 0,
                  10 -> 0,
                  4 -> 0,
                  9 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1723 = [(0, 0) ->
                                        4,
                                        (0, 2064) -> 5,
                                        (0, 256) -> 4,
                                        else -> 2],
 procs_nr_vectors.3 = [16 -> 0,
                       32 -> 0,
                       4 -> 0,
                       10 -> 0,
                       9 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 k!1717 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(8, Var(0)),
                 If(ULE(32, Var(0)),
                    If(ULE(256, Var(0)),
                       If(ULE(2064, Var(0)),
                          If(ULE(4096, Var(0)),
                             If(ULE(8193, Var(0)),
                                8193,
                                4096),
                             2064),
                          256),
                       32),
                    8),
                 1),
              0)],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 k!1716 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(8, Var(0)),
                       If(ULE(9, Var(0)),
                          If(ULE(10, Var(0)),
                             If(ULE(16, Var(0)),
... != []

----------------------------------------------------------------------
Ran 1 test in 21.177s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall clone_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_clone_proc (__main__.HV6) ... ERROR

======================================================================
ERROR: test_clone_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 541, in _syscall_generic
    model = self._prove(z3.And(spec.state_equiv(self.ctx, newstate),
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/equiv.py", line 239, in state_equiv
    getattr(module, k + '_equiv')(conj, ctx, kernelstate)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/equiv.py", line 133, in pages_equiv
    kernelstate.pages[pn].data(idx))))
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 41, in __call__
    return self._imap(instance)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 105, in __call__
    return self.__get__(instance)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 100, in __get__
    return self.get(f, instance._path)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 246, in get
    return fn(*args)
  File "/root/hyperkernel/irpy/libirpy/util.py", line 180, in <lambda>
    return lambda *args, **kwargs: If(cond, a(*args, **kwargs), b(*args, **kwargs))
  File "/root/hyperkernel/irpy/libirpy/util.py", line 347, in inner
    return If(cond, value, fn(*args))
  File "/root/hyperkernel/irpy/libirpy/util.py", line 347, in inner
    return If(cond, value, fn(*args))
  File "/root/hyperkernel/irpy/libirpy/util.py", line 203, in If
    raise ValueError("Can not ite object of type {!r}".format(type(a)))
ValueError: Can not ite object of type <class 'hv6py.base.Accessor'>

----------------------------------------------------------------------
Ran 1 test in 26.330s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall send_proc:
     PY2      hv6-verify
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 35, in <module>
    import spec
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/__init__.py", line 19, in <module>
    from specs import *
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 81
    new.procs[pid].ofile[new.procs[pid].ipc_fd] = new.procs[old.current].ofile(fd),
                                                ^
SyntaxError: invalid syntax
make: *** [hv6-verify] Error 1

Syscall reply_wait_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(63, 18446744073709551615 + pid.3)),
                  If(@proc_table->struct.proc::state.0(0,
                                        pid.3) ==
                     4,
                     If(Not(ULE(8192, inpn.0)),
                        If(@page_desc_table->struct.page_desc::pid.0(0,
                                        inpn.0) ==
                           @current.0(0),
                           If(Not(And(Extract(63,
                                        13,
                                        size.0) ==
                                      0,
                                      ULE(Extract(12,
                                        0,
                                        size.0),
                                        4096))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1),
                              If(Not(ULE(16, infd.0)),
                                 If(And(Not(ULE(8192,
                                        outpn.0)),
                                        Not(ULE(127,
                                        18446744073709551615 +
                                        @proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, infd.0))))),
                                    If(@page_desc_table->struct.page_desc::pid.0(0,
                                        outpn.0) ==
                                       @current.0(0),
                                       If(@page_desc_table->struct.page_desc::type.0(0,
                                        outpn.0) ==
                                        3,
                                        If(Or(@proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        0,
                                        @proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        @current.0(0)),
                                        If(And(pn.3 ==
                                        If(@current.0(0) ==
                                        pid.3,
                                        outpn.0,
                                        @proc_table->struct.proc::ipc_page.0(0,
                                        pid.3)),
                                        Not(ULE(size.0,
                                        page_index.1))),
                                        @pages.0(0,
                                        inpn.0,
                                        page_index.1),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                 If(Not(ULE(8192, outpn.0)),
                                    If(@page_desc_table->struct.page_desc::pid.0(0,
                                        outpn.0) ==
                                       @current.0(0),
                                       If(@page_desc_table->struct.page_desc::type.0(0,
                                        outpn.0) ==
                                        3,
                                        If(Or(@proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        0,
                                        @proc_table->struct.proc::ipc_from.0(0,
                                        pid.3) ==
                                        @current.0(0)),
                                        If(And(pn.3 ==
                                        If(@current.0(0) ==
                                        pid.3,
                                        outpn.0,
                                        @proc_table->struct.proc::ipc_page.0(0,
                                        pid.3)),
                                        Not(ULE(size.0,
                                        page_index.1))),
                                        @pages.0(0,
                                        inpn.0,
                                        page_index.1),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1)))),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(And(Not(pid.3 <= 0), Not(64 <= pid.3)),
                      procs_state.1(pid.3) == 4,
                      Not(ULE(8192, inpn.0)),
                      pages_owner.1(inpn.0) == current.0,
                      And(Extract(63, 13, size.0) == 0,
                          ULE(Extract(12, 0, size.0), 4096)),
                      Or(Not(And(0 <= infd.0,
                                 Not(16 <= infd.0))),
                         And(Not(procs_ofile.1(current.0,
                                        infd.0) ==
                                 0),
                             Not(ULE(128,
                                     procs_ofile.1(current.0,
                                        infd.0))))),
                      Not(ULE(8192, outpn.0)),
                      pages_owner.1(outpn.0) == current.0,
                      pages_type.1(outpn.0) == 3,
                      Or(procs_ipc_from.1(pid.3) == 0,
                         procs_ipc_from.1(pid.3) ==
                         current.0),
                      Not(pid.3 == current.0)),
                  If(pn.3 ==
                     If(current.0 == pid.3,
                        outpn.0,
                        procs_ipc_page.1(pid.3)),
                     pages_data.1(inpn.0, page_index.1),
                     pages_data.1(pn.3, page_index.1)),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_reply_wait_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_reply_wait_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 page_index.1!945 = 256,
 proc_table_ptr_to_int.0 = 0,
 inpn.0 = 0,
 outpn.0 = 1,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 pn.3!946 = 2048,
 (uintptr)@file_table.0 = 0,
 infd.0 = 2097152,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 2,
 pid.3 = 32,
 pages_ptr_to_int.0 = 0,
 size.0 = 1,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1170(Var(0),
                                        k!1164(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 2048],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1171(Var(0),
                                        k!1164(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [(0, 32) -> 2,
                                        else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [48 -> 0,
                    36 -> 0,
                    33 -> 0,
                    3 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 procs_ipc_from.1 = [else -> 2],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [(0, 256) -> 1, else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1177(Var(0),
                                        k!1164(Var(1)))],
 procs_io_bitmap_a.1 = [2 -> 8,
                        33 -> 520,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1172(Var(0),
                                        k!1165(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [2 -> 0,
                            32 -> 64,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [48 -> 0,
                   36 -> 0,
                   33 -> 0,
                   3 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1175(Var(0),
                                        k!1164(Var(1)))],
 @proc_table->struct.proc::state.0!1173 = [(0, 2) -> 3,
                                        (0, 32) -> 4,
                                        else -> 0],
 @proc_table->struct.proc::stack.0!1171 = [(0, 32) -> 512,
                                        else -> 2],
 procs_nr_ports.3 = [48 -> 0,
                     36 -> 0,
                     33 -> 0,
                     3 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [2 -> 2,
                  32 -> 512,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [2 -> 256,
                32 -> 128,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [2 -> 8,
                        33 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [(0, 32) -> 2147483648,
                                       else -> 16],
 @proc_table->struct.proc::io_bitmap_b.0!1175 = [(0, 33) ->
                                        4,
                                        else -> 8],
 pages_owner.1 = [2 -> 2,
                  256 -> 2,
                  0 -> 2,
                  1 -> 2,
                  2048 -> 32,
                  512 -> 32,
                  128 -> 32,
                  64 -> 32,
                  8 -> 2,
                  4 -> 33,
                  520 -> 33,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0!1176 = [(0, 32) ->
                                        64,
                                        else -> 0],
 @io_table.0 = [else -> 8192],
 @pages.0 = [(0, 2048, 256) -> 0,
             (0, 0, 256) -> 1,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 2],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 k!1165 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(8, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(128, Var(0)),
                             If(ULE(256, Var(0)),
                                If(ULE(512, Var(0)),
                                   If(ULE(520, Var(0)),
                                      If(ULE(2048, Var(0)),
                                        If(ULE(8193, Var(0)),
                                        8193,
                                        2048),
                                        520),
                                      512),
                                   256),
                                128),
                             64),
                          8),
                       4),
                    2),
                 1),
              0)],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [2 -> 3,
                  32 -> 4,
                  36 -> 0,
                  33 -> 0,
                  48 -> 0,
                  3 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 k!1164 = [else ->
           If(ULE(2, Var(0)),
... != []

----------------------------------------------------------------------
Ran 1 test in 79.302s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_dup2:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_dup2 (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 41.846s

OK

Syscall sys_alloc_io_bitmap:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.6, page_index.1],
       Implies(And(ULT(pn.6, 8192), ULT(page_index.1, 512)),
               If(And(pn.3 == 18446744073709551615 + pn.4,
                      pn.4 == 18446744073709551615 + pn.5),
                  If(@proc_table->struct.proc::use_io_bitmap.0(0,
                                        @current.0(0)) ==
                     0,
                     If(Not(ULE(8192, pn.3)),
                        If(And(Not(ULE(8192, pn.4)),
                               @page_desc_table->struct.page_desc::type.0(0,
                                        pn.3) ==
                               0),
                           If(And(Not(ULE(8192, pn.5)),
                                  @page_desc_table->struct.page_desc::type.0(0,
                                        pn.4) ==
                                  0),
                              If(@page_desc_table->struct.page_desc::type.0(0,
                                        pn.5) ==
                                 0,
                                 If(And(pn.6 == pn.5,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                    Concat(Concat(Concat(Concat(Concat(Concat(Concat(Extract(7,
                                        0,
                                        255),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                    If(And(pn.6 == pn.4,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       Concat(Concat(Concat(Concat(Concat(Concat(Concat(Extract(7,
                                        0,
                                        255),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                       If(And(pn.6 == pn.3,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                        Concat(Concat(Concat(Concat(Concat(Concat(Concat(Extract(7,
                                        0,
                                        255),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        Extract(7, 0, 255)),
                                        If(And(pn.6 == pn.5,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                        0,
                                        If(And(pn.6 == pn.4,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                        0,
                                        If(And(pn.6 == pn.3,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                        0,
                                        @pages.0(0,
                                        pn.6,
                                        page_index.1))))))),
                                 @pages.0(0,
                                        pn.6,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.6,
                                       page_index.1)),
                           @pages.0(0, pn.6, page_index.1)),
                        @pages.0(0, pn.6, page_index.1)),
                     @pages.0(0, pn.6, page_index.1)),
                  @pages.0(0, pn.6, page_index.1)) ==
               If(And(Not(ULE(8192, pn.3)),
                      Not(ULE(8192, pn.4)),
                      Not(ULE(8192, pn.5)),
                      pn.3 == 18446744073709551615 + pn.4,
                      pn.4 == 18446744073709551615 + pn.5,
                      Not(procs_use_io_bitmap.1(current.0)),
                      pages_type.1(pn.3) == 0,
                      pages_type.1(pn.4) == 0,
                      pages_type.1(pn.5) == 0),
                  If(pn.5 == pn.6,
                     18446744073709551615,
                     If(pn.4 == pn.6,
                        18446744073709551615,
                        If(pn.3 == pn.6,
                           0,
                           pages_data.1(pn.6, page_index.1)))),
                  pages_data.1(pn.6, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_io_bitmap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_io_bitmap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 pn.5 = 17,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pn.6!1115 = 15,
 page_index.1!1114 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 pn.3 = 15,
 pn.4 = 16,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1805(Var(0),
                                        k!1799(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 @proc_table->struct.proc::state.0!1807 = [(0, 16) -> 3,
                                        (0, 24) ->
                                        1073741824,
                                        else -> 0],
 procs_nr_devs.3 = [32 -> 0,
                    36 -> 0,
                    48 -> 0,
                    1 -> 0,
                    17 -> 0,
                    40 -> 0,
                    20 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0!1805 = [(0, 17) ->
                                        8,
                                        else -> 512],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [32 -> 512,
                        17 -> 8,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1806(Var(0),
                                        k!1800(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [16 -> 4096,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [32 -> 0,
                   36 -> 0,
                   48 -> 0,
                   1 -> 0,
                   17 -> 0,
                   40 -> 0,
                   20 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1809(Var(0),
                                        k!1799(Var(1)))],
 procs_nr_ports.3 = [32 -> 0,
                     36 -> 0,
                     48 -> 0,
                     1 -> 0,
                     17 -> 0,
                     40 -> 0,
                     20 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [16 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [32 -> 128,
                        17 -> 256,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [0 -> 16,
                  4096 -> 16,
                  17 -> 0,
                  15 -> 0,
                  128 -> 32,
                  512 -> 32,
                  16 -> 4611686018427387904,
                  256 -> 17,
                  8 -> 17,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  24 -> 1073741824,
                  32 -> 0,
                  36 -> 0,
                  48 -> 0,
                  20 -> 0,
                  40 -> 0,
                  1 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [32 -> 0,
                       36 -> 0,
                       48 -> 0,
                       1 -> 0,
                       17 -> 0,
                       40 -> 0,
                       20 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [32 -> 0,
                     36 -> 0,
                     48 -> 0,
                     1 -> 0,
                     17 -> 0,
                     40 -> 0,
                     20 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [32 -> 0,
                         36 -> 0,
                         48 -> 0,
                         1 -> 0,
                         17 -> 0,
                         40 -> 0,
                         20 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
... != []

----------------------------------------------------------------------
Ran 1 test in 29.137s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall extintr:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_extintr (__main__.HV6) ... ERROR

======================================================================
ERROR: test_extintr (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 53, in extintr
    new.procs[pid].intr[word_idx] = new.procs[pid].intr(word_idx) | bit_mask
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 3135, in __or__
    return BitVecRef(Z3_mk_bvor(self.ctx_ref(), a.as_ast(), b.as_ast()), self.ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3core.py", line 1756, in Z3_mk_bvor
    raise Z3Exception(lib().Z3_get_error_msg(a0, err))
Z3Exception: Argument (bvshl #x01 (bvsmod vector.1 #x40)) at position 1 does not match declaration (declare-fun bvor ((_ BitVec 64) (_ BitVec 64)) (_ BitVec 64))

----------------------------------------------------------------------
Ran 1 test in 2.109s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_map_pml4:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_pml4 (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 19.958s

OK

Syscall sys_map_page_desc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_page_desc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 24.564s

OK

Syscall sys_map_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_proc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 24.173s

OK

Syscall sys_map_dev:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_dev (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 23.942s

OK

Syscall sys_map_file:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_file (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 24.404s

OK

Syscall sys_alloc_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pd (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 39.158s

OK

Syscall sys_alloc_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pt (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 41.097s

OK

Syscall sys_alloc_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 38.720s

OK

Syscall sys_copy_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_copy_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_copy_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 61, in sys_copy_frame
    new.pages[to].data = lambda idx, oldfn: old.pages[frm].data(idx)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 12.086s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_protect_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_protect_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 11.863s

OK

Syscall sys_free_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     5,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              6,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 5,
                      pages_type.1(to.0) == 6,
                      pages_owner.1(from.0) == current.0,
                      pages_owner.1(to.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pd (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pd (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 pn.3!1096 = 2222,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 from.0 = 1024,
 (uintptr)@file_table.0 = 0,
 page_index.1!1095 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 13194104578048,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 2222,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 index.1 = 2,
 pages_ptr_to_int.0 = 13194104578048,
 procs_nr_ports.3 = [1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 17],
 procs_stack.1 = [16 -> 4,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [16 -> 4,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 17],
 procs_io_bitmap_b.1 = [16 -> 128,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 4],
 @proc_table->struct.proc::ipc_page.0 = [else -> 17],
 @proc_table->struct.proc::stack.0 = [else -> 4],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [4 -> 16,
                  0 -> 16,
                  1024 -> 16,
                  2222 -> 16,
                  128 -> 16,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 17],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 @pages.0 = [(0, 2222, 0) -> 576460752303423488,
             (0, 1024, 2) -> 13194113679361,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [1 -> 0,
                    20 -> 0,
                    32 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 17],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  1 -> 0,
                  32 -> 0,
                  20 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 17],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 17],
 procs_ipc_size.1 = [else -> 17],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       20 -> 0,
                       32 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 17],
 @proc_table->struct.proc::state.0!1507 = [(0, 16) -> 3,
                                        else -> 0],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 17],
 procs_nr_pages.3 = [1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 pages_data.1 = [(2222, 0) -> 576460752303423488,
                 else -> 13194113679361],
 procs_nr_intremaps.3 = [1 -> 0,
                         20 -> 0,
                         32 -> 0,
                         17 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 procs_nr_children.3 = [1 -> 0,
                        20 -> 0,
                        32 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 files_refcnt.4 = [else -> 17],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 4],
 procs_io_bitmap_a.1 = [16 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 k!1500 = [else ->
           If(ULE(16, Var(0)),
              If(ULE(17, Var(0)),
                 If(ULE(20, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       20),
                    17),
                 16),
              1)],
 k!1501 = [else ->
           If(ULE(4, Var(0)),
              If(ULE(128, Var(0)),
                 If(ULE(1024, Var(0)),
                    If(ULE(2222, Var(0)),
                       If(ULE(8193, Var(0)), 8193, 2222),
                       1024),
                    128),
                 4),
              0)],
 pcipages_owner.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 intremaps_vector.1 = [else -> 0],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        20 -> 0,
                        32 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 17],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1506 = [(0, 0) ->
                                        4,
                                        (0, 1024) -> 5,
                                        (0, 2222) -> 6,
                                        else -> 2],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [4 -> 2,
                 0 -> 4,
                 1024 -> 5,
                 2222 -> 6,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.517s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_free_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     6,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              7,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 6,
                      pages_type.1(to.0) == 7,
                      pages_owner.1(from.0) == current.0,
                      pages_owner.1(to.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 pn.3!1238 = 4,
 page_desc_table_ptr_to_int.0 = 0,
 page_index.1!1237 = 0,
 from.0 = 1,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 49152,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 4,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 2,
 index.1 = 128,
 pages_ptr_to_int.0 = 49152,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 49152],
 k!1659 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(4, Var(0)),
                 If(ULE(5, Var(0)),
                    If(ULE(8, Var(0)),
                       If(ULE(9, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(64, Var(0)),
                                If(ULE(128, Var(0)),
                                   If(ULE(512, Var(0)),
                                      If(ULE(768, Var(0)),
                                        If(ULE(1024, Var(0)),
                                        If(ULE(1028, Var(0)),
                                        If(ULE(8193, Var(0)),
                                        8193,
                                        1028),
                                        1024),
                                        768),
                                        512),
                                      128),
                                   64),
                                32),
                             9),
                          8),
                       5),
                    4),
                 1),
              0)],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1664(Var(0),
                                        k!1658(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 49152],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1665(Var(0),
                                        k!1658(Var(1)))],
 k!1658 = [else ->
           If(ULE(2, Var(0)),
              If(ULE(3, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    3),
                 2),
              1)],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    32 -> 0,
                    4 -> 0,
                    3 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 49152],
 @page_desc_table->struct.page_desc::pid.0!1668 = [(0, 512) ->
                                        1,
                                        (0, 0) -> 1,
                                        (0, 1024) -> 4,
                                        (0, 9) -> 4,
                                        (0, 8) -> 32,
                                        (0, 128) -> 32,
                                        (0, 5) -> 3,
                                        (0, 64) -> 3,
                                        else -> 2],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 49152],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 49152],
 procs_ipc_size.1 = [else -> 49152],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 49152],
 @proc_table->struct.proc::hvm.0!1671 = [(0, 1) -> 0,
                                        else -> 32],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 49152],
 pages_data.1 = [(4, 0) -> 2251799813685248, else -> 65537],
 files_refcnt.4 = [else -> 49152],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1671(Var(0),
                                        k!1658(Var(1)))],
 procs_io_bitmap_a.1 = [4 -> 1024,
                        32 -> 8,
                        3 -> 5,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1666(Var(0),
                                        k!1659(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table->struct.proc::state.0!1667 = [(0, 2) -> 3,
                                        else -> 0],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [2 -> 768,
                            1 -> 512,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   32 -> 0,
                   4 -> 0,
                   3 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @proc_table->struct.proc::stack.0!1665 = [(0, 1) -> 0,
                                        else -> 1028],
 procs_intr.1 = [else -> 49152],
 @page_desc_table->struct.page_desc::type.0!1666 = [(0, 768) ->
                                        4,
                                        (0, 1) -> 6,
                                        (0, 4) -> 7,
                                        (0, 512) -> 4,
                                        else -> 2],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 49152],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1669(Var(0),
                                        k!1658(Var(1)))],
 procs_nr_ports.3 = [1 -> 0,
                     32 -> 0,
                     4 -> 0,
                     3 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 49152],
 procs_stack.1 = [2 -> 1028,
                  1 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [2 -> 32,
                1 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [4 -> 9,
                        32 -> 128,
                        3 -> 64,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0!1664 = [(0, 32) ->
                                        8,
                                        (0, 3) -> 5,
                                        else -> 1024],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 49152],
 pages_owner.1 = [1028 -> 2,
                  32 -> 2,
                  768 -> 2,
                  1 -> 2,
... != []

----------------------------------------------------------------------
Ran 1 test in 21.235s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_free_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     7,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              3,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 7,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 3,
                      pages_owner.1(to.0) == current.0,
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 page_index.1!1107 = 1,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 from.0 = 4096,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 32768,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pn.3!1108 = 1,
 to.0 = 1,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 32,
 index.1 = 0,
 pages_ptr_to_int.0 = 32768,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 36865],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1521(Var(0),
                                        k!1515(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 36865],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    48 -> 0,
                    36 -> 0,
                    33 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 36865],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 36865],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 36865],
 procs_ipc_size.1 = [else -> 36865],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 36865],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 36865],
 pages_data.1 = [(1, 1) -> 1, else -> 36865],
 files_refcnt.4 = [else -> 36865],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [32 -> 0,
                        48 -> 2,
                        36 -> 32,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1522(Var(0),
                                        k!1516(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 k!1516 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(16, Var(0)),
                       If(ULE(32, Var(0)),
                          If(ULE(512, Var(0)),
                             If(ULE(4096, Var(0)),
                                If(ULE(8193, Var(0)),
                                   8193,
                                   4096),
                                512),
                             32),
                          16),
                       4),
                    2),
                 1),
              0)],
 @page_desc_table->struct.page_desc::pid.0!1524 = [(0, 32) ->
                                        36,
                                        (0, 4) -> 36,
                                        (0, 2) -> 48,
                                        (0, 512) -> 48,
                                        else -> 32],
 procs_page_table_root.1 = [32 -> 16,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 k!1515 = [else ->
           If(ULE(32, Var(0)),
              If(ULE(33, Var(0)),
                 If(ULE(36, Var(0)),
                    If(ULE(48, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          48),
                       36),
                    33),
                 32),
              1)],
 procs_nr_fds.3 = [1 -> 0,
                   48 -> 0,
                   36 -> 0,
                   33 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::type.0!1522 = [(0, 16) ->
                                        4,
                                        (0, 4096) -> 7,
                                        (0, 1) -> 3,
                                        else -> 2],
 procs_intr.1 = [else -> 36865],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 36865],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1525(Var(0),
                                        k!1515(Var(1)))],
 procs_nr_ports.3 = [1 -> 0,
                     48 -> 0,
                     36 -> 0,
                     33 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 36865],
 procs_stack.1 = [32 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0!1521 = [(0, 36) ->
                                        32,
                                        (0, 48) -> 2,
                                        else -> 0],
 procs_hvm.1 = [32 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [32 -> 0,
                        48 -> 512,
                        36 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 36865],
 pages_owner.1 = [0 -> 32,
                  16 -> 32,
                  4096 -> 32,
                  1 -> 32,
                  512 -> 48,
                  2 -> 48,
                  4 -> 36,
                  32 -> 36,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_b.0!1525 = [(0, 36) ->
                                        4,
                                        (0, 48) -> 512,
                                        else -> 0],
 @pages.0 = [(0, 1, 1) -> 1,
             (0, 4096, 0) -> 36865,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 32],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [32 -> 3,
                  1 -> 0,
                  36 -> 0,
                  48 -> 0,
                  33 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.249s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_reclaim_page:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(ULT(pn.3, 8192),
    pages_type.1(pn.3) != 0,
    And(pages_owner.1(pn.3) > 0, pages_owner.1(pn.3) < 64),
    procs_state.1(pages_owner.1(pn.3)) == 5,
    False) ==
(If(Not(ULE(8192, pn.3)),
    If(@page_desc_table->struct.page_desc::type.0(0, pn.3) ==
       0,
       4294967274,
       If(Not(ULE(63,
                  18446744073709551615 +
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        pn.3))),
          If(@proc_table->struct.proc::state.0(0,
                                        @page_desc_table->struct.page_desc::pid.0(0,
                                        pn.3)) ==
             5,
             If(@proc_table->struct.proc::nr_devs.0(0,
                                        @page_desc_table->struct.page_desc::pid.0(0,
                                        pn.3)) ==
                0,
                0,
                4294967280),
             4294967283),
          4294967283)),
    4294967274) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_page (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_page (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 pn.3 = 2,
 pages_ptr_to_int.0 = 0,
 @vector_table.0 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0!679 = [(0, 4) ->
                                        1024,
                                        else -> 8],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!679(Var(0),
                                        k!673(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [32 -> 0,
                    4 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 k!674 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(2, Var(0)),
                If(ULE(8, Var(0)),
                   If(ULE(1024, Var(0)),
                      If(ULE(2048, Var(0)),
                         If(ULE(8193, Var(0)), 8193, 2048),
                         1024),
                      8),
                   2),
                1),
             0)],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 k!673 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(2, Var(0)),
                If(ULE(4, Var(0)),
                   If(ULE(32, Var(0)),
                      If(ULE(65, Var(0)), 65, 32),
                      4),
                   2),
                1),
             0)],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::type.0!680 = [(0, 0) ->
                                        4,
                                        (0, 2) -> 1,
                                        else -> 2],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 8],
 procs_io_bitmap_a.1 = [1 -> 8,
                        4 -> 1024,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!680(Var(0),
                                        k!674(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [1 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [4 -> 0,
                   2 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::pid.0!682 = [(0, 2) ->
                                        32,
                                        (0, 1024) -> 4,
                                        (0, 2048) -> 4,
                                        else -> 1],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!683(Var(0),
                                        k!673(Var(1)))],
 procs_nr_ports.3 = [4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [1 -> 8,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [1 -> 1,
                        4 -> 2048,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [1 -> 1,
                  8 -> 1,
                  0 -> 1,
                  2 -> 32,
                  2048 -> 4,
                  1024 -> 4,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  32 -> 5,
                  4 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [4 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [4 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 intremaps_vector.1 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
... != []

----------------------------------------------------------------------
Ran 1 test in 10.071s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_set_runnable:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_set_runnable (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_set_runnable (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 55, in sys_set_runnable
    new.procs[pid].ready.next = new.current
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 3.195s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall switch_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_switch_proc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 7.829s

OK

Syscall sys_kill:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_kill (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_kill (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 66, in sys_kill
    old.procs[pid].ready.prev)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 4.461s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_reap:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reap (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_reap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 69, in sys_reap
    new.procs[pid].launched = z3.BoolVal(False)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 187, in __setattr__
    raise AttributeError("No such attribute: '{}'".format(attribute))
AttributeError: No such attribute: 'launched'

----------------------------------------------------------------------
Ran 1 test in 12.219s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_reparent:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(pid.3 > 0, pid.3 < 64),
    procs_state.1(procs_ppid.1(pid.3)) == 5,
    Or(procs_state.1(1) == 2, procs_state.1(1) == 3)) ==
(If(Not(ULE(63, 18446744073709551615 + pid.3)),
    If(Not(ULE(63,
               18446744073709551615 +
               @proc_table->struct.proc::ppid.0(0, pid.3))),
       If(@proc_table->struct.proc::state.0(0,
                                        @proc_table->struct.proc::ppid.0(0,
                                        pid.3)) ==
          5,
          If(Extract(63,
                     1,
                     @proc_table->struct.proc::state.0(0, 1)) ==
             1,
             0,
             4294967274),
          4294967274),
       4294967274),
    4294967293) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reparent (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reparent (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 pid.3 = 32,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 32],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1061(Var(0),
                                        k!1055(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [2 -> 0,
                    24 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 128],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 k!1056 = [else ->
           If(ULE(2, Var(0)),
              If(ULE(32, Var(0)),
                 If(ULE(64, Var(0)),
                    If(ULE(256, Var(0)),
                       If(ULE(512, Var(0)),
                          If(ULE(2048, Var(0)),
                             If(ULE(4096, Var(0)),
                                If(ULE(8193, Var(0)),
                                   8193,
                                   4096),
                                2048),
                             512),
                          256),
                       64),
                    32),
                 2),
              0)],
 @proc_table->struct.proc::page_table_root.0!1065 = [(0, 1) ->
                                        256,
                                        (0, 32) -> 2048,
                                        else -> 2],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 k!1055 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(16, Var(0)),
                    If(ULE(17, Var(0)),
                       If(ULE(24, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(65, Var(0)), 65, 32),
                             24),
                          17),
                       16),
                    2),
                 1),
              0)],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1066(Var(0),
                                        k!1055(Var(1)))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [(0, 32) -> 128,
                                     else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1062(Var(0),
                                        k!1056(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [16 -> 2,
                            1 -> 256,
                            32 -> 2048,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [2 -> 0,
                   24 -> 0,
                   17 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::type.0!1062 = [(0, 32) ->
                                        3,
                                        (0, 2) -> 4,
                                        (0, 256) -> 4,
                                        (0, 2048) -> 4,
                                        else -> 2],
 @proc_table->struct.proc::state.0!1063 = [(0, 16) -> 3,
                                        (0, 1) -> 2,
                                        else -> 0],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 procs_nr_ports.3 = [2 -> 0,
                     24 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 0,
                  1 -> 64,
                  32 -> 512,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [16 -> 0,
                1 -> 64,
                32 -> 4096,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [0 -> 16,
                  2 -> 16,
                  64 -> 1,
                  256 -> 1,
                  32 -> 16,
                  512 -> 32,
                  4096 -> 32,
                  2048 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  128 -> 5,
                  1 -> 2,
                  2 -> 0,
                  24 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [2 -> 0,
                       24 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [16 -> 32,
                     else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [2 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 6.966s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall recv_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_recv_proc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 14.985s

OK

Syscall call_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_call_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_call_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 86, in call_proc
    new.pages[new.procs[pid].ipc_page].data = lambda idx, oldfn: \
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 32.429s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_create:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_create (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 5.471s

OK

Syscall sys_close:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_close (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 18.176s

OK

Syscall sys_dup:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_dup (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 19.396s

OK

Syscall sys_lseek:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_lseek (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 3.645s

OK

Syscall sys_map_pcipage:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_map_pcipage (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_map_pcipage (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 43, in sys_map_pcipage
    old.pcipages[pcipn].owner == old.pci[old.pcipages[pcipn].owner].owner,
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 823, in __eq__
    return BoolRef(Z3_mk_eq(self.ctx_ref(), a.as_ast(), b.as_ast()), self.ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3core.py", line 1560, in Z3_mk_eq
    raise Z3Exception(lib().Z3_get_error_msg(a0, err))
Z3Exception: Sorts (_ BitVec 16) and (_ BitVec 64) are incompatible

----------------------------------------------------------------------
Ran 1 test in 10.570s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_root:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_iommu_root (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 9.182s

OK

Syscall sys_alloc_iommu_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pdpt (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_alloc_iommu_pdpt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 64, in sys_alloc_iommu_pdpt
    z3.BitVecVal(dt.page_type.PAGE_TYPE_IOMMU_PDPT - dt.page_type.PAGE_TYPE_IOMMU_PML4 - 1, 64)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 3558, in BitVecVal
    return BitVecNumRef(Z3_mk_numeral(ctx.ref(), _to_int_str(val), BitVecSort(bv, ctx).ast), ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 2750, in _to_int_str
    _z3_assert(False, "Python value cannot be used as a Z3 integer")
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 90, in _z3_assert
    raise Z3Exception(msg)
Z3Exception: Python value cannot be used as a Z3 integer

----------------------------------------------------------------------
Ran 1 test in 12.949s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           9,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 0,
                      pages_type.1(from.0) == 9,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0 |
                        12 - 1 - 9 << 10,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pd (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pd (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 4,
 (uintptr)@file_table.0 = 0,
 pn.3!1179 = 4,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 2305843017803644944,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 2048,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 32,
 page_index.1!1178 = 0,
 index.1 = 0,
 pages_ptr_to_int.0 = 2305843017803644944,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 2],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 512],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    20 -> 0,
                    4 -> 0,
                    34 -> 0,
                    3 -> 0,
                    24 -> 0,
                    48 -> 0,
                    36 -> 0,
                    33 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 128],
 procs_io_bitmap_a.1 = [20 -> 2,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::state.0!2013 = [(0, 32) -> 3,
                                        else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!2012(Var(0),
                                        k!2007(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [32 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   20 -> 0,
                   4 -> 0,
                   34 -> 0,
                   3 -> 0,
                   24 -> 0,
                   48 -> 0,
                   36 -> 0,
                   33 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 2],
 @page_desc_table->struct.page_desc::pid.0!2014 = [(0, 2048) ->
                                        4611686018427387904,
                                        (0, 2) -> 20,
                                        else -> 32],
 procs_nr_ports.3 = [1 -> 0,
                     20 -> 0,
                     4 -> 0,
                     34 -> 0,
                     3 -> 0,
                     24 -> 0,
                     48 -> 0,
                     36 -> 0,
                     33 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [32 -> 512,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [32 -> 128,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [20 -> 2,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [512 -> 32,
                  128 -> 32,
                  0 -> 32,
                  4 -> 32,
                  2048 -> 4611686018427387904,
                  2 -> 20,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 4, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 32],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [32 -> 3,
                  24 -> 0,
                  3 -> 0,
                  48 -> 0,
                  1 -> 0,
                  20 -> 0,
                  36 -> 0,
                  34 -> 0,
                  4 -> 0,
                  33 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       20 -> 0,
                       4 -> 0,
                       34 -> 0,
                       3 -> 0,
                       24 -> 0,
                       48 -> 0,
                       36 -> 0,
                       33 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [1 -> 0,
                     20 -> 0,
                     4 -> 0,
                     34 -> 0,
                     3 -> 0,
                     24 -> 0,
                     48 -> 0,
                     36 -> 0,
                     33 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         20 -> 0,
                         4 -> 0,
                         34 -> 0,
                         3 -> 0,
                         24 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.331s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           10,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 10,
                      pages_type.1(to.0) == 0,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        pages_ptr_to_int.0 + to.0 << 12 |
                        perm.0 |
                        12 - 1 - 10,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 288230376587923456,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pn.3!1247 = 0,
 to.0 = 4096,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 page_index.1!1246 = 0,
 index.1 = 0,
 pages_ptr_to_int.0 = 288230376587923456,
 procs_nr_ports.3 = [32 -> 0,
                     1 -> 0,
                     20 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 512,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [16 -> 8,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [20 -> 16,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 64],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 512],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [512 -> 16,
                  8 -> 16,
                  5120 -> 16,
                  0 -> 16,
                  4096 -> 4611686018427387904,
                  16 -> 20,
                  64 -> 20,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 k!1658 = [else ->
           If(ULE(8, Var(0)),
              If(ULE(16, Var(0)),
                 If(ULE(64, Var(0)),
                    If(ULE(512, Var(0)),
                       If(ULE(4096, Var(0)),
                          If(ULE(5120, Var(0)),
                             If(ULE(8193, Var(0)),
                                8193,
                                5120),
                             4096),
                          512),
                       64),
                    16),
                 8),
              0)],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 k!1657 = [else ->
           If(ULE(16, Var(0)),
              If(ULE(17, Var(0)),
                 If(ULE(20, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       20),
                    17),
                 16),
              1)],
 @pages.0 = [(0, 0, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [32 -> 0,
                    1 -> 0,
                    20 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  20 -> 0,
                  32 -> 0,
                  1 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [32 -> 0,
                       1 -> 0,
                       20 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [32 -> 0,
                     1 -> 0,
                     20 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1664 = [(0, 16) -> 3,
                                        else -> 0],
 pages_data.1 = [else -> 0],
 procs_nr_intremaps.3 = [32 -> 0,
                         1 -> 0,
                         20 -> 0,
                         17 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 5120],
 procs_nr_children.3 = [32 -> 0,
                        1 -> 0,
                        20 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 8],
 procs_io_bitmap_a.1 = [20 -> 64,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 @page_desc_table->struct.page_desc::pid.0!1665 = [(0, 4096) ->
                                        4611686018427387904,
                                        (0, 64) -> 20,
                                        (0, 16) -> 20,
                                        else -> 16],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [32 -> 0,
                        1 -> 0,
                        20 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
... != []

----------------------------------------------------------------------
Ran 1 test in 20.561s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(512, to.0)),
                  If(@dmapage_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           11,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                       (uintptr)@dmapages.0 +
                                       (to.0*32768)/8 |
                                       perm.0,
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(512, to.0)),
                      dmapages_type.1(to.0) == 0,
                      Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 11,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     dmapages_ptr_to_int.0 + to.0 << 12 |
                     perm.0,
                     pages_data.1(pn.3, page_index.1)),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 pn.3!1109 = 1,
 (uintptr)@proc_table.0 = 0,
 page_index.1!1108 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 1,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 70368746274888,
 file_table_ptr_to_int.0 = 0,
 to.0 = 0,
 (uintptr)@dmapages.0 = 70368746274888,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1520(Var(0),
                                        k!1514(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [4 -> 0,
                    32 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 0],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [4 -> 4,
                        32 -> 32,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [(0, 0) ->
                                        0,
                                        else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1521(Var(0),
                                        k!1515(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table->struct.proc::io_bitmap_a.0!1520 = [(0, 4) -> 4,
                                        else -> 32],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 @page_desc_table->struct.page_desc::type.0!1521 = [(0, 512) ->
                                        4,
                                        (0, 1) -> 11,
                                        else -> 2],
 procs_page_table_root.1 = [1 -> 512,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 k!1515 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(4, Var(0)),
                 If(ULE(32, Var(0)),
                    If(ULE(128, Var(0)),
                       If(ULE(512, Var(0)),
                          If(ULE(8193, Var(0)), 8193, 512),
                          128),
                       32),
                    4),
                 1),
              0)],
 procs_nr_fds.3 = [4 -> 0,
                   32 -> 0,
                   2 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 k!1514 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    2),
                 1),
              0)],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1524(Var(0),
                                        k!1514(Var(1)))],
 procs_nr_ports.3 = [4 -> 0,
                     32 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [1 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [4 -> 4,
                        32 -> 128,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [0 -> 1,
                  512 -> 1,
                  1 -> 1,
                  4 -> 4,
                  128 -> 32,
                  32 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1522 = [(0, 1) -> 3,
                                        else -> 0],
 @proc_table->struct.proc::io_bitmap_b.0!1524 = [(0, 4) -> 4,
                                        else -> 128],
 @pages.0 = [(0, 1, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  4 -> 0,
                  32 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [4 -> 0,
                       32 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [4 -> 0,
                     32 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [4 -> 0,
                         32 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
... != []

----------------------------------------------------------------------
Ran 1 test in 15.352s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_map_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_iommu_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 11.319s

OK

Syscall sys_reclaim_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_reclaim_iommu_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 6.844s

OK

Syscall sys_reclaim_iommu_root:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_reclaim_iommu_root (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 5.449s

OK

Syscall sys_alloc_vector:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_vector (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 2.579s

OK

Syscall sys_reclaim_vector:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(vectors_owner.1(vector.1) > 0,
        vectors_owner.1(vector.1) < 64),
    procs_state.1(vectors_owner.1(vector.1)) == 5,
    False) ==
(If(Not(ULE(63,
            18446744073709551615 +
            @vector_table.0(0, Concat(0, vector.1)))),
    If(@proc_table->struct.proc::state.0(0,
                                        @vector_table.0(0,
                                        Concat(0, vector.1))) ==
       5,
       If(@proc_table->struct.proc::nr_intremaps.0(0,
                                        @vector_table.0(0,
                                        Concat(0, vector.1))) ==
          0,
          0,
          4294967280),
       4294967283),
    4294967283) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_vector (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_vector (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 vector.1 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 40,
 pages_ptr_to_int.0 = 0,
 procs_nr_ports.3 = [1 -> 0,
                     48 -> 0,
                     44 -> 0,
                     41 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [40 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [40 -> 1,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [1 -> 40,
                  0 -> 40,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    48 -> 0,
                    44 -> 0,
                    41 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 40],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [40 -> 3,
                  32 -> 5,
                  1 -> 0,
                  48 -> 0,
                  44 -> 0,
                  41 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       48 -> 0,
                       44 -> 0,
                       41 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     48 -> 0,
                     44 -> 0,
                     41 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [32 -> 0,
                         1 -> 0,
                         48 -> 0,
                         44 -> 0,
                         41 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        48 -> 0,
                        44 -> 0,
                        41 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 vectors_owner.1 = [0 -> 32,
                    else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 1],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        48 -> 0,
                        44 -> 0,
                        41 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::state.0!879 = [(0, 40) -> 3,
                                        (0, 32) -> 5,
                                        else -> 0],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 files_type.1 = [else -> 8192],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [1 -> 2,
                 0 -> 4,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!878(Var(0),
                                        k!873(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [40 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 procs_ofile.1 = [else ->
                  @proc_table.0(0,
                                Var(0),
                                Concat(0, Var(1)))],
 pcipages_valid.1 = [else -> False],
 @proc_table.0 = [else -> 1],
 @proc_table.4 = [else -> 0],
 @proc_table->struct.proc::state.0 = [else ->
                                      @proc_table->struct.proc::state.0!879(Var(0),
                                        k!872(Var(1)))],
 procs_nr_fds.3 = [1 -> 0,
                   48 -> 0,
                   44 -> 0,
                   41 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_ipc_fd.1 = [else ->
                   @proc_table->struct.proc::ipc_fd.0(0,
... != []

----------------------------------------------------------------------
Ran 1 test in 4.232s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_intremap:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
iotlbinv.0 == iotlbinv.1
does not imply
iotlbinv.0 ==
If(And(Not(ULE(8, index.1)),
       intremaps_state.1(index.1) == 0,
       pci_owner.1(devid.1) == current.0,
       vectors_owner.1(vector.1) == current.0),
   True,
   iotlbinv.1)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_intremap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_intremap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 devid.1 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 vector.1 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 4,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 @pci_table.0 = [else -> 4],
 procs_nr_ports.3 = [1 -> 0,
                     6 -> 0,
                     8 -> 0,
                     16 -> 0,
                     32 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [4 -> 2048,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 intremaps_state.1 = [else -> 0],
 procs_hvm.1 = [4 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @intremap_table->struct.intremap::state.0 = [(0, 0) -> 0,
                                        else ->
                                        intremaps_state.1(Var(1))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 2048],
 @io_table.0 = [else -> 0],
 pages_owner.1 = [2048 -> 4,
                  0 -> 4,
                  512 -> 4,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    6 -> 0,
                    8 -> 0,
                    16 -> 0,
                    32 -> 0,
                    5 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 4],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [4 -> 3,
                  16 -> 0,
                  32 -> 0,
                  6 -> 0,
                  1 -> 0,
                  8 -> 0,
                  5 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1758 = [(0, 512) ->
                                        4,
                                        else -> 2],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       6 -> 0,
                       8 -> 0,
                       16 -> 0,
                       32 -> 0,
                       5 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1759 = [(0, 4) -> 3,
                                        else -> 0],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     6 -> 0,
                     8 -> 0,
                     16 -> 0,
                     32 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         6 -> 0,
                         8 -> 0,
                         16 -> 0,
                         32 -> 0,
                         5 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        6 -> 0,
                        8 -> 0,
                        16 -> 0,
                        32 -> 0,
                        5 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 512],
 vectors_owner.1 = [0 -> 4,
                    else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        6 -> 0,
                        8 -> 0,
                        16 -> 0,
                        32 -> 0,
                        5 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 k!1753 = [else ->
           If(ULE(512, Var(0)),
              If(ULE(2048, Var(0)),
                 If(ULE(8193, Var(0)), 8193, 2048),
                 512),
              0)],
 pages_type.1 = [2048 -> 2,
                 0 -> 2,
                 512 -> 4,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 k!1752 = [else ->
           If(ULE(4, Var(0)),
              If(ULE(5, Var(0)),
                 If(ULE(6, Var(0)),
... != []

----------------------------------------------------------------------
Ran 1 test in 8.893s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_reclaim_intremap:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
iotlbinv.0 == iotlbinv.1
does not imply
iotlbinv.0 ==
If(And(Not(ULE(8, index.1)),
       intremaps_state.1(index.1) == 1,
       And(Not(pci_owner.1(intremaps_devid.1(index.1)) <= 0),
           Not(64 <= pci_owner.1(intremaps_devid.1(index.1)))),
       procs_state.1(pci_owner.1(intremaps_devid.1(index.1))) ==
       5),
   True,
   iotlbinv.1)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_intremap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_intremap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 8,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 @pci_table.0 = [else -> 1],
 procs_nr_ports.3 = [32 -> 0,
                     10 -> 0,
                     12 -> 0,
                     16 -> 0,
                     1 -> 0,
                     9 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [8 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 intremaps_state.1 = [else -> 1],
 procs_hvm.1 = [8 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @intremap_table->struct.intremap::state.0 = [(0, 0) -> 1,
                                        else ->
                                        intremaps_state.1(Var(1))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1310 = [(0, 0) ->
                                        2,
                                        else -> 4],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_fd.0 = [(0, 8) -> 2147483648,
                                       else -> 16],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 pages_owner.1 = [0 -> 8,
                  2 -> 8,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 0],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [32 -> 0,
                    10 -> 0,
                    12 -> 0,
                    16 -> 0,
                    1 -> 0,
                    9 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 8],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [8 -> 3,
                  1 -> 5,
                  12 -> 0,
                  32 -> 0,
                  10 -> 0,
                  16 -> 0,
                  9 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [32 -> 0,
                       10 -> 0,
                       12 -> 0,
                       16 -> 0,
                       1 -> 0,
                       9 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [32 -> 0,
                     10 -> 0,
                     12 -> 0,
                     16 -> 0,
                     1 -> 0,
                     9 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [32 -> 0,
                         10 -> 0,
                         12 -> 0,
                         16 -> 0,
                         1 -> 0,
                         9 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [32 -> 0,
                        10 -> 0,
                        12 -> 0,
                        16 -> 0,
                        1 -> 0,
                        9 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 2],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 @intremap_table->struct.intremap::devid.0 = [(0, 0) -> 0,
                                        else ->
                                        intremaps_devid.1(Var(1))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [32 -> 0,
                        10 -> 0,
                        12 -> 0,
                        16 -> 0,
                        1 -> 0,
                        9 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 k!1305 = [else ->
           If(ULE(2, Var(0)),
              If(ULE(8193, Var(0)), 8193, 2),
              0)],
 pages_type.1 = [0 -> 2,
                 2 -> 4,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 k!1304 = [else ->
           If(ULE(8, Var(0)),
              If(ULE(9, Var(0)),
                 If(ULE(10, Var(0)),
                    If(ULE(12, Var(0)),
                       If(ULE(16, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(64, Var(0)),
                                If(ULE(65, Var(0)), 65, 64),
                                32),
                             16),
... != []

----------------------------------------------------------------------
Ran 1 test in 67.749s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_ack_intr:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_ack_intr (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 1.717s

OK

Syscall sys_alloc_port:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(ULT(port.1, 0),
    io_owner.1(port.1) == 0,
    procs_use_io_bitmap.1(current.0),
    ULT(procs_io_bitmap_a.1(current.0), 8192),
    ULT(procs_io_bitmap_b.1(current.0), 8192)) ==
(If(@io_table.0(0, Concat(0, port.1)) == 0,
    If(@proc_table->struct.proc::use_io_bitmap.0(0,
                                        @current.0(0)) ==
       0,
       4294967283,
       0),
    4294967280) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_port (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_port (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 port.1 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 pages_ptr_to_int.0 = 0,
 @pci_table.0 = [else -> 0],
 procs_nr_ports.3 = [1 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [1 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [1 -> 1,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [1 -> 1,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 k!464 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(8193, Var(0)), 8193, 1),
             0)],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 1],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_fd.0 = [(0, 1) -> 2147483648,
                                       else -> 16],
 @proc_table->struct.proc::stack.0 = [else -> 1],
 pages_owner.1 = [1 -> 1,
                  0 -> 1,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 0],
 k!463 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(2, Var(0)),
                If(ULE(65, Var(0)), 65, 2),
                1),
             0)],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 1],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0!471 = [(0, 1) ->
                                        2,
                                        else -> 4],
 @proc_table.3 = [else -> 0],
 dmapages_owner.1 = [else -> 8192],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 @proc_table->struct.proc::use_io_bitmap.0!470 = [(0, 2) ->
                                        0,
                                        else -> 1],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 1],
 procs_io_bitmap_a.1 = [1 -> 1,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else ->
                          procs_use_io_bitmap.1!469(k!463(Var(0)))],
 procs_nr_dmapages.3 = [1 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::state.0!472 = [(0, 1) -> 3,
                                        else -> 0],
 @proc_table->struct.proc::use_io_bitmap.0 = [else ->
                                        @proc_table->struct.proc::use_io_bitmap.0!470(Var(0),
                                        k!463(Var(1)))],
 files_type.1 = [else -> 8192],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [1 -> 2,
                 0 -> 4,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!471(Var(0),
                                        k!464(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 pci_owner.1 = [0 -> 0,
                else -> @pci_table.0(0, Concat(0, Var(0)))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 procs_page_table_root.1 = [1 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 procs_ofile.1 = [else ->
                  @proc_table.0(0,
                                Var(0),
                                Concat(0, Var(1)))],
 pcipages_valid.1 = [else -> False],
 @proc_table.0 = [else -> 8],
 @proc_table.4 = [else -> 0],
 @proc_table->struct.proc::state.0 = [else ->
                                      @proc_table->struct.proc::state.0!472(Var(0),
                                        k!463(Var(1)))],
 procs_ipc_fd.1 = [1 -> 2147483648,
                   else ->
                   @proc_table->struct.proc::ipc_fd.0(0,
                                        Var(0))],
 procs_nr_fds.3 = [1 -> 0,
                   2 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 4.929s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_reclaim_port:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_reclaim_port (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 3.155s

OK

Syscall sys_alloc_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pdpt (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 42.042s

OK

Syscall sys_free_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     4,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              5,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 4,
                      pages_type.1(to.0) == 5,
                      pages_owner.1(from.0) == current.0,
                      pages_owner.1(to.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pdpt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pdpt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 from.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 562036736,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 2064,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 8,
 page_index.1!1096 = 1,
 pn.3!1097 = 2064,
 pages_ptr_to_int.0 = 562036736,
 index.1 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::hvm.0!1727 = [(0, 2) -> 32,
                                        else -> 4096],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1722(Var(0),
                                        k!1716(Var(1)))],
 @proc_table->struct.proc::stack.0!1722 = [(0, 2) -> 1,
                                        else -> 8],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [16 -> 0,
                    32 -> 0,
                    4 -> 0,
                    10 -> 0,
                    9 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @proc_table->struct.proc::page_table_root.0!1726 = [(0, 2) ->
                                        256,
                                        else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 @proc_table->struct.proc::state.0!1724 = [(0, 8) -> 3,
                                        else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [(2064, 1) -> 65537, else -> 570490881],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1727(Var(0),
                                        k!1716(Var(1)))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1723(Var(0),
                                        k!1717(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [8 -> 0,
                            2 -> 256,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [16 -> 0,
                   32 -> 0,
                   4 -> 0,
                   10 -> 0,
                   9 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 procs_nr_ports.3 = [16 -> 0,
                     32 -> 0,
                     4 -> 0,
                     10 -> 0,
                     9 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [8 -> 8,
                  2 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [8 -> 4096,
                2 -> 32,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [8 -> 8,
                  4096 -> 8,
                  0 -> 8,
                  2064 -> 8,
                  1 -> 2,
                  32 -> 2,
                  256 -> 2,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 2064, 1) -> 65537,
             (0, 0, 0) -> 570490881,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 8],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [8 -> 3,
                  32 -> 0,
                  16 -> 0,
                  10 -> 0,
                  4 -> 0,
                  9 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1723 = [(0, 0) ->
                                        4,
                                        (0, 2064) -> 5,
                                        (0, 256) -> 4,
                                        else -> 2],
 procs_nr_vectors.3 = [16 -> 0,
                       32 -> 0,
                       4 -> 0,
                       10 -> 0,
                       9 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 k!1717 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(8, Var(0)),
                 If(ULE(32, Var(0)),
                    If(ULE(256, Var(0)),
                       If(ULE(2064, Var(0)),
                          If(ULE(4096, Var(0)),
                             If(ULE(8193, Var(0)),
                                8193,
                                4096),
                             2064),
                          256),
                       32),
                    8),
                 1),
              0)],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 k!1716 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(8, Var(0)),
                       If(ULE(9, Var(0)),
                          If(ULE(10, Var(0)),
                             If(ULE(16, Var(0)),
... != []

----------------------------------------------------------------------
Ran 1 test in 21.080s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall clone_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_clone_proc (__main__.HV6) ... ERROR

======================================================================
ERROR: test_clone_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 541, in _syscall_generic
    model = self._prove(z3.And(spec.state_equiv(self.ctx, newstate),
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/equiv.py", line 239, in state_equiv
    getattr(module, k + '_equiv')(conj, ctx, kernelstate)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/equiv.py", line 133, in pages_equiv
    kernelstate.pages[pn].data(idx))))
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 41, in __call__
    return self._imap(instance)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 105, in __call__
    return self.__get__(instance)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 100, in __get__
    return self.get(f, instance._path)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 246, in get
    return fn(*args)
  File "/root/hyperkernel/irpy/libirpy/util.py", line 180, in <lambda>
    return lambda *args, **kwargs: If(cond, a(*args, **kwargs), b(*args, **kwargs))
  File "/root/hyperkernel/irpy/libirpy/util.py", line 347, in inner
    return If(cond, value, fn(*args))
  File "/root/hyperkernel/irpy/libirpy/util.py", line 347, in inner
    return If(cond, value, fn(*args))
  File "/root/hyperkernel/irpy/libirpy/util.py", line 203, in If
    raise ValueError("Can not ite object of type {!r}".format(type(a)))
ValueError: Can not ite object of type <class 'hv6py.base.Accessor'>

----------------------------------------------------------------------
Ran 1 test in 27.932s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall send_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_send_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_send_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 70, in send_proc
    new.pages[new.procs[pid].ipc_page].data = lambda idx, oldfn: \
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 23.045s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall reply_wait_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_reply_wait_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_reply_wait_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 94, in reply_wait_proc
    new.procs[pid].ofile = lambda fd, oldfn: \
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 45.879s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_dup2:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_dup2 (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_dup2 (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 73, in sys_dup2
    new.procs[pid].nr_fds(newfd) - 1,
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 41, in __call__
    return self._imap(instance)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 271, in __call__
    assert len(instance._path) == 1
AssertionError

----------------------------------------------------------------------
Ran 1 test in 30.348s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_io_bitmap:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_io_bitmap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_io_bitmap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 70, in sys_alloc_io_bitmap
    new.pages[pn1].data = lambda idx, oldfn: dt.MAX_INT64
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 18.382s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall extintr:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_extintr (__main__.HV6) ... ERROR

======================================================================
ERROR: test_extintr (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 53, in extintr
    new.procs[pid].intr[word_idx] = new.procs[pid].intr(word_idx) | bit_mask
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 3135, in __or__
    return BitVecRef(Z3_mk_bvor(self.ctx_ref(), a.as_ast(), b.as_ast()), self.ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3core.py", line 1756, in Z3_mk_bvor
    raise Z3Exception(lib().Z3_get_error_msg(a0, err))
Z3Exception: Argument (bvshl #x01 (bvsmod vector.1 #x40)) at position 1 does not match declaration (declare-fun bvor ((_ BitVec 64) (_ BitVec 64)) (_ BitVec 64))

----------------------------------------------------------------------
Ran 1 test in 2.119s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_map_pml4:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_pml4 (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 18.890s

OK

Syscall sys_map_page_desc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_page_desc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 25.037s

OK

Syscall sys_map_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_proc (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 23.932s

OK

Syscall sys_map_dev:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_dev (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 23.640s

OK

Syscall sys_map_file:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_file (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 24.159s

OK

Syscall sys_alloc_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pd (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 39.661s

OK

Syscall sys_alloc_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pt (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 40.319s

OK

Syscall sys_alloc_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 37.674s

OK

Syscall sys_copy_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_copy_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_copy_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 59, in sys_copy_frame
    new.pages[to].data = lambda idx, oldfn: old.pages[frm].data(idx)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 11.424s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_protect_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_protect_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 12.093s

OK

Syscall sys_free_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     5,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              6,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 5,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 6,
                      pages_owner.1(to.0) == current.0,
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pd (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pd (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 page_index.1!1233 = 0,
 from.0 = 8,
 (uintptr)@file_table.0 = 0,
 pn.3!1234 = 2053,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 2251799805329408,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 2053,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 index.1 = 8,
 pages_ptr_to_int.0 = 2251799805329408,
 k!1639 = [else ->
           If(ULE(16, Var(0)),
              If(ULE(17, Var(0)),
                 If(ULE(20, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       20),
                    17),
                 16),
              1)],
 procs_nr_ports.3 = [1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [16 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [32 -> 256,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 2048],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_fd.0 = [(0, 16) -> 2147483648,
                                       else -> 16],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 pages_owner.1 = [0 -> 16,
                  32 -> 16,
                  8 -> 16,
                  2053 -> 16,
                  256 -> 32,
                  2048 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 @pages.0 = [(0, 2053, 0) -> 82433,
             (0, 8, 8) -> 2251799813738497,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [1 -> 0,
                    20 -> 0,
                    32 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  32 -> 0,
                  20 -> 0,
                  1 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       20 -> 0,
                       32 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::pid.0!1647 = [(0, 2048) ->
                                        32,
                                        (0, 256) -> 32,
                                        else -> 16],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 pages_data.1 = [(2053, 0) -> 82433,
                 else -> 2251799813738497],
 procs_nr_intremaps.3 = [1 -> 0,
                         20 -> 0,
                         32 -> 0,
                         17 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 32],
 procs_nr_children.3 = [1 -> 0,
                        20 -> 0,
                        32 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [32 -> 2048,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        20 -> 0,
                        32 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1645 = [(0, 32) ->
                                        4,
                                        (0, 8) -> 5,
                                        (0, 2053) -> 6,
                                        else -> 2],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [0 -> 2,
                 32 -> 4,
                 8 -> 5,
                 2053 -> 6,
                 256 -> 2,
                 2048 -> 2,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
... != []

----------------------------------------------------------------------
Ran 1 test in 20.438s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_free_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     6,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              7,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 6,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 7,
                      pages_owner.1(to.0) == current.0,
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 from.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 4398047039488,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 page_index.1!1235 = 64,
 to.0 = 17,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 8,
 pn.3!1236 = 17,
 index.1 = 0,
 pages_ptr_to_int.0 = 4398047039488,
 @proc_table->struct.proc::page_table_root.0!1802 = [(0, 32) ->
                                        32,
                                        else -> 1024],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 64],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1798(Var(0),
                                        k!1792(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    12 -> 0,
                    10 -> 0,
                    16 -> 0,
                    9 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::type.0!1799 = [(0,
                                        1024) ->
                                        4,
                                        (0, 0) -> 6,
                                        (0, 17) -> 7,
                                        (0, 32) -> 4,
                                        else -> 2],
 @proc_table->struct.proc::state.0!1800 = [(0, 8) -> 3,
                                        else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [(17, 64) -> 1, else -> 4398047109121],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1803(Var(0),
                                        k!1792(Var(1)))],
 procs_io_bitmap_a.1 = [10 -> 64,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1799(Var(0),
                                        k!1793(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 @page_desc_table->struct.page_desc::pid.0!1801 = [(0, 32) ->
                                        32,
                                        (0, 1) -> 32,
                                        (0, 128) -> 32,
                                        (0, 2) -> 10,
                                        (0, 64) -> 10,
                                        else -> 8],
 procs_page_table_root.1 = [8 -> 1024,
                            32 -> 32,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   12 -> 0,
                   10 -> 0,
                   16 -> 0,
                   9 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 2],
 procs_nr_ports.3 = [1 -> 0,
                     12 -> 0,
                     10 -> 0,
                     16 -> 0,
                     9 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [8 -> 512,
                  32 -> 128,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [8 -> 512,
                32 -> 1,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [10 -> 2,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [512 -> 8,
                  1024 -> 8,
                  0 -> 8,
                  17 -> 8,
                  128 -> 32,
                  1 -> 32,
                  32 -> 32,
                  2 -> 10,
                  64 -> 10,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 17, 64) -> 1,
             (0, 0, 0) -> 4398047109121,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 8],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [8 -> 3,
                  10 -> 0,
                  1 -> 0,
                  12 -> 0,
                  16 -> 0,
                  9 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       12 -> 0,
                       10 -> 0,
                       16 -> 0,
                       9 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [1 -> 0,
                     12 -> 0,
                     10 -> 0,
                     16 -> 0,
                     9 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         12 -> 0,
                         10 -> 0,
                         16 -> 0,
                         9 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
... != []

----------------------------------------------------------------------
Ran 1 test in 21.372s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_free_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     7,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              3,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 7,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 3,
                      pages_owner.1(to.0) == current.0,
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 page_index.1!1107 = 1,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 from.0 = 4096,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 32768,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pn.3!1108 = 1,
 to.0 = 1,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 32,
 index.1 = 0,
 pages_ptr_to_int.0 = 32768,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 36865],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1521(Var(0),
                                        k!1515(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 36865],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    48 -> 0,
                    36 -> 0,
                    33 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 36865],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 36865],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 36865],
 procs_ipc_size.1 = [else -> 36865],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 36865],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 36865],
 pages_data.1 = [(1, 1) -> 1, else -> 36865],
 files_refcnt.4 = [else -> 36865],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [32 -> 0,
                        48 -> 2,
                        36 -> 32,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1522(Var(0),
                                        k!1516(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 k!1516 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(16, Var(0)),
                       If(ULE(32, Var(0)),
                          If(ULE(512, Var(0)),
                             If(ULE(4096, Var(0)),
                                If(ULE(8193, Var(0)),
                                   8193,
                                   4096),
                                512),
                             32),
                          16),
                       4),
                    2),
                 1),
              0)],
 @page_desc_table->struct.page_desc::pid.0!1524 = [(0, 32) ->
                                        36,
                                        (0, 4) -> 36,
                                        (0, 2) -> 48,
                                        (0, 512) -> 48,
                                        else -> 32],
 procs_page_table_root.1 = [32 -> 16,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 k!1515 = [else ->
           If(ULE(32, Var(0)),
              If(ULE(33, Var(0)),
                 If(ULE(36, Var(0)),
                    If(ULE(48, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          48),
                       36),
                    33),
                 32),
              1)],
 procs_nr_fds.3 = [1 -> 0,
                   48 -> 0,
                   36 -> 0,
                   33 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::type.0!1522 = [(0, 16) ->
                                        4,
                                        (0, 4096) -> 7,
                                        (0, 1) -> 3,
                                        else -> 2],
 procs_intr.1 = [else -> 36865],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 36865],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1525(Var(0),
                                        k!1515(Var(1)))],
 procs_nr_ports.3 = [1 -> 0,
                     48 -> 0,
                     36 -> 0,
                     33 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 36865],
 procs_stack.1 = [32 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0!1521 = [(0, 36) ->
                                        32,
                                        (0, 48) -> 2,
                                        else -> 0],
 procs_hvm.1 = [32 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [32 -> 0,
                        48 -> 512,
                        36 -> 4,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 36865],
 pages_owner.1 = [0 -> 32,
                  16 -> 32,
                  4096 -> 32,
                  1 -> 32,
                  512 -> 48,
                  2 -> 48,
                  4 -> 36,
                  32 -> 36,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_b.0!1525 = [(0, 36) ->
                                        4,
                                        (0, 48) -> 512,
                                        else -> 0],
 @pages.0 = [(0, 1, 1) -> 1,
             (0, 4096, 0) -> 36865,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 32],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [32 -> 3,
                  1 -> 0,
                  36 -> 0,
                  48 -> 0,
                  33 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.577s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_reclaim_page:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(ULT(pn.3, 8192),
    pages_type.1(pn.3) != 0,
    And(UGT(pages_owner.1(pn.3), 0),
        ULT(pages_owner.1(pn.3), 64),
        procs_state.1(pages_owner.1(pn.3)) == 5),
    False) ==
(If(Not(ULE(8192, pn.3)),
    If(@page_desc_table->struct.page_desc::type.0(0, pn.3) ==
       0,
       4294967274,
       If(Not(ULE(63,
                  18446744073709551615 +
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        pn.3))),
          If(@proc_table->struct.proc::state.0(0,
                                        @page_desc_table->struct.page_desc::pid.0(0,
                                        pn.3)) ==
             5,
             If(@proc_table->struct.proc::nr_devs.0(0,
                                        @page_desc_table->struct.page_desc::pid.0(0,
                                        pn.3)) ==
                0,
                0,
                4294967280),
             4294967283),
          4294967283)),
    4294967274) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_page (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_page (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 pn.3 = 2,
 pages_ptr_to_int.0 = 0,
 @vector_table.0 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0!679 = [(0, 4) ->
                                        1024,
                                        else -> 8],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!679(Var(0),
                                        k!673(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [32 -> 0,
                    4 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 k!674 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(2, Var(0)),
                If(ULE(8, Var(0)),
                   If(ULE(1024, Var(0)),
                      If(ULE(2048, Var(0)),
                         If(ULE(8193, Var(0)), 8193, 2048),
                         1024),
                      8),
                   2),
                1),
             0)],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 k!673 = [else ->
          If(ULE(1, Var(0)),
             If(ULE(2, Var(0)),
                If(ULE(4, Var(0)),
                   If(ULE(32, Var(0)),
                      If(ULE(65, Var(0)), 65, 32),
                      4),
                   2),
                1),
             0)],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::type.0!680 = [(0, 0) ->
                                        4,
                                        (0, 2) -> 1,
                                        else -> 2],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 8],
 procs_io_bitmap_a.1 = [1 -> 8,
                        4 -> 1024,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!680(Var(0),
                                        k!674(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [1 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [4 -> 0,
                   2 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::pid.0!682 = [(0, 2) ->
                                        32,
                                        (0, 1024) -> 4,
                                        (0, 2048) -> 4,
                                        else -> 1],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!683(Var(0),
                                        k!673(Var(1)))],
 procs_nr_ports.3 = [4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [1 -> 8,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [1 -> 1,
                        4 -> 2048,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [1 -> 1,
                  8 -> 1,
                  0 -> 1,
                  2 -> 32,
                  2048 -> 4,
                  1024 -> 4,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  32 -> 5,
                  4 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [4 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [4 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 intremaps_vector.1 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
... != []

----------------------------------------------------------------------
Ran 1 test in 10.811s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_set_runnable:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_set_runnable (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_set_runnable (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 55, in sys_set_runnable
    new.procs[pid].ready.next = old.current
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 3.236s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall switch_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_switch_proc (__main__.HV6) ... ERROR

======================================================================
ERROR: test_switch_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 62, in switch_proc
    old.procs[old.current].ready.prev)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 6.877s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_kill:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_kill (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_kill (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 63, in sys_kill
    new.procs[pid].ready.prev,
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 4.457s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_reap:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reap (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_reap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 70, in sys_reap
    new.procs[pid].launched = z3.BoolVal(False)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 187, in __setattr__
    raise AttributeError("No such attribute: '{}'".format(attribute))
AttributeError: No such attribute: 'launched'

----------------------------------------------------------------------
Ran 1 test in 12.351s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_reparent:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(pid.3 > 0, pid.3 < 64),
    procs_state.1(procs_ppid.1(pid.3)) == 5,
    Or(procs_state.1(1) == 2, procs_state.1(1) == 3)) ==
(If(Not(ULE(63, 18446744073709551615 + pid.3)),
    If(Not(ULE(63,
               18446744073709551615 +
               @proc_table->struct.proc::ppid.0(0, pid.3))),
       If(@proc_table->struct.proc::state.0(0,
                                        @proc_table->struct.proc::ppid.0(0,
                                        pid.3)) ==
          5,
          If(Extract(63,
                     1,
                     @proc_table->struct.proc::state.0(0, 1)) ==
             1,
             0,
             4294967274),
          4294967274),
       4294967274),
    4294967293) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reparent (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reparent (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 pid.3 = 32,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 32],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1061(Var(0),
                                        k!1055(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [2 -> 0,
                    24 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 128],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 k!1056 = [else ->
           If(ULE(2, Var(0)),
              If(ULE(32, Var(0)),
                 If(ULE(64, Var(0)),
                    If(ULE(256, Var(0)),
                       If(ULE(512, Var(0)),
                          If(ULE(2048, Var(0)),
                             If(ULE(4096, Var(0)),
                                If(ULE(8193, Var(0)),
                                   8193,
                                   4096),
                                2048),
                             512),
                          256),
                       64),
                    32),
                 2),
              0)],
 @proc_table->struct.proc::page_table_root.0!1065 = [(0, 1) ->
                                        256,
                                        (0, 32) -> 2048,
                                        else -> 2],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 k!1055 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(16, Var(0)),
                    If(ULE(17, Var(0)),
                       If(ULE(24, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(65, Var(0)), 65, 32),
                             24),
                          17),
                       16),
                    2),
                 1),
              0)],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1066(Var(0),
                                        k!1055(Var(1)))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [(0, 32) -> 128,
                                     else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1062(Var(0),
                                        k!1056(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [16 -> 2,
                            1 -> 256,
                            32 -> 2048,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [2 -> 0,
                   24 -> 0,
                   17 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::type.0!1062 = [(0, 32) ->
                                        3,
                                        (0, 2) -> 4,
                                        (0, 256) -> 4,
                                        (0, 2048) -> 4,
                                        else -> 2],
 @proc_table->struct.proc::state.0!1063 = [(0, 16) -> 3,
                                        (0, 1) -> 2,
                                        else -> 0],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 procs_nr_ports.3 = [2 -> 0,
                     24 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [16 -> 0,
                  1 -> 64,
                  32 -> 512,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [16 -> 0,
                1 -> 64,
                32 -> 4096,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [0 -> 16,
                  2 -> 16,
                  64 -> 1,
                  256 -> 1,
                  32 -> 16,
                  512 -> 32,
                  4096 -> 32,
                  2048 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  128 -> 5,
                  1 -> 2,
                  2 -> 0,
                  24 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [2 -> 0,
                       24 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [16 -> 32,
                     else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [2 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 7.020s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall recv_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(pid.3 > 0, pid.3 < 64),
    procs_state.1(pid.3) == 2,
    ULT(pn.3, 8192),
    pages_owner.1(pn.3) == current.0,
    pages_type.1(pn.3) == 3,
    And(fd.3 >= 0, fd.3 < 16),
    Not(And(UGT(procs_ofile.1(current.0, fd.3), 0),
            ULT(procs_ofile.1(current.0, fd.3), 128))),
    current.0 != pid.3) ==
(If(Not(ULE(63, 18446744073709551615 + pid.3)),
    If(And(Not(ULE(8192, pn.3)),
           @proc_table->struct.proc::state.0(0, pid.3) == 2),
       If(@page_desc_table->struct.page_desc::pid.0(0, pn.3) ==
          @current.0(0),
          If(@page_desc_table->struct.page_desc::type.0(0,
                                        pn.3) ==
             3,
             If(Not(ULE(16, fd.3)),
                If(Not(ULE(127,
                           18446744073709551615 +
                           @proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, fd.3)))),
                   4294967274,
                   0),
                0),
             4294967274),
          4294967283),
       4294967274),
    4294967293) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_recv_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_recv_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 fd.3 = 67108864,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 pid.3 = 32,
 pn.3 = 0,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::hvm.0!1350 = [(0, 32) -> 2,
                                        else -> 1024],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 2048],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1345(Var(0),
                                        k!1339(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    20 -> 0,
                    33 -> 0,
                    36 -> 0,
                    18 -> 0,
                    34 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 @proc_table->struct.proc::state.0!1347 = [(0, 16) -> 3,
                                        (0, 32) -> 2,
                                        (0, 48) -> 5,
                                        else -> 0],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::type.0!1346 = [(0, 1) ->
                                        4,
                                        (0, 0) -> 3,
                                        (0, 512) -> 4,
                                        else -> 2],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1350(Var(0),
                                        k!1339(Var(1)))],
 procs_io_bitmap_a.1 = [17 -> 2048,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1346(Var(0),
                                        k!1340(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [16 -> 1,
                            32 -> 512,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   20 -> 0,
                   33 -> 0,
                   36 -> 0,
                   18 -> 0,
                   34 -> 0,
                   17 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 128],
 procs_nr_ports.3 = [1 -> 0,
                     20 -> 0,
                     33 -> 0,
                     36 -> 0,
                     18 -> 0,
                     34 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 k!1340 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(128, Var(0)),
                       If(ULE(512, Var(0)),
                          If(ULE(1024, Var(0)),
                             If(ULE(2048, Var(0)),
                                If(ULE(8193, Var(0)),
                                   8193,
                                   2048),
                                1024),
                             512),
                          128),
                       4),
                    2),
                 1),
              0)],
 procs_stack.1 = [16 -> 1024,
                  32 -> 4,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_hvm.1 = [16 -> 1024,
                32 -> 2,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 k!1339 = [else ->
           If(ULE(16, Var(0)),
              If(ULE(17, Var(0)),
                 If(ULE(18, Var(0)),
                    If(ULE(20, Var(0)),
                       If(ULE(32, Var(0)),
                          If(ULE(33, Var(0)),
                             If(ULE(34, Var(0)),
                                If(ULE(36, Var(0)),
                                   If(ULE(48, Var(0)),
                                      If(ULE(64, Var(0)),
                                        If(ULE(65, Var(0)),
                                        65,
                                        64),
                                        48),
                                      36),
                                   34),
                                33),
                             32),
                          20),
                       18),
                    17),
                 16),
              1)],
 procs_io_bitmap_b.1 = [17 -> 128,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [1024 -> 16,
                  1 -> 16,
                  0 -> 16,
                  4 -> 32,
                  2 -> 32,
                  512 -> 32,
                  128 -> 17,
                  2048 -> 17,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 @page_desc_table->struct.page_desc::pid.0!1348 = [(0, 512) ->
                                        32,
                                        (0, 2) -> 32,
... != []

----------------------------------------------------------------------
Ran 1 test in 16.475s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall call_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_call_proc (__main__.HV6) ... ERROR

======================================================================
ERROR: test_call_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 94, in call_proc
    new.procs[old.current].ready.prev = z3.BitVecVal(0, dt.pid_t)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 178, in __getattribute__
    return super(Struct, self).__getattribute__(arg)
AttributeError: 'Proc' object has no attribute 'ready'

----------------------------------------------------------------------
Ran 1 test in 32.216s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_create:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_create (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 5.499s

OK

Syscall sys_close:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_close (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 17.816s

OK

Syscall sys_dup:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_dup (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 19.228s

OK

Syscall sys_lseek:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_lseek (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 3.647s

OK

Syscall sys_map_pcipage:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_map_pcipage (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_map_pcipage (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 43, in sys_map_pcipage
    old.pcipages[pcipn].owner == old.pci[old.pcipages[pcipn].owner].owner,
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 823, in __eq__
    return BoolRef(Z3_mk_eq(self.ctx_ref(), a.as_ast(), b.as_ast()), self.ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3core.py", line 1560, in Z3_mk_eq
    raise Z3Exception(lib().Z3_get_error_msg(a0, err))
Z3Exception: Sorts (_ BitVec 16) and (_ BitVec 64) are incompatible

----------------------------------------------------------------------
Ran 1 test in 10.195s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_root:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_iommu_root (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 9.313s

OK

Syscall sys_alloc_iommu_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           8,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 0,
                      Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 8,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pdpt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pdpt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 pn.3!1109 = 2048,
 (uintptr)@proc_table.0 = 0,
 page_index.1!1108 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 2048,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 220059393926156,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 32,
 index.1 = 0,
 pages_ptr_to_int.0 = 220059393926156,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 512],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1533(Var(0),
                                        k!1527(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    33 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @proc_table->struct.proc::page_table_root.0!1537 = [(0, 48) ->
                                        1152,
                                        else -> 128],
 k!1528 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(8, Var(0)),
                    If(ULE(128, Var(0)),
                       If(ULE(256, Var(0)),
                          If(ULE(512, Var(0)),
                             If(ULE(1024, Var(0)),
                                If(ULE(1152, Var(0)),
                                   If(ULE(2048, Var(0)),
                                      If(ULE(8193, Var(0)),
                                        8193,
                                        2048),
                                      1152),
                                   1024),
                                512),
                             256),
                          128),
                       8),
                    2),
                 1),
              0)],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 k!1527 = [else ->
           If(ULE(32, Var(0)),
              If(ULE(33, Var(0)),
                 If(ULE(36, Var(0)),
                    If(ULE(48, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          48),
                       36),
                    33),
                 32),
              1)],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1538(Var(0),
                                        k!1527(Var(1)))],
 procs_io_bitmap_a.1 = [32 -> 512,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1534(Var(0),
                                        k!1528(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [32 -> 128,
                            48 -> 1152,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [1 -> 0,
                   33 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 @page_desc_table->struct.page_desc::pid.0!1536 = [(0, 0) ->
                                        0,
                                        (0, 1152) -> 48,
                                        (0, 256) -> 48,
                                        (0, 8) -> 48,
                                        else -> 32],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 2],
 procs_nr_ports.3 = [1 -> 0,
                     33 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [32 -> 1,
                  48 -> 8,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [32 -> 1024,
                48 -> 256,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [32 -> 2,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [1 -> 32,
                  1024 -> 32,
                  128 -> 32,
                  2048 -> 32,
                  0 -> 0,
                  2 -> 32,
                  512 -> 32,
                  8 -> 48,
                  256 -> 48,
                  1152 -> 48,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [(0, 2048, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 32],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [32 -> 3,
                  36 -> 33554432,
                  1 -> 0,
                  33 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @proc_table->struct.proc::stack.0!1533 = [(0, 48) -> 8,
                                        else -> 1],
 procs_nr_vectors.3 = [1 -> 0,
                       33 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [1 -> 0,
                     33 -> 0,
... != []

----------------------------------------------------------------------
Ran 1 test in 22.025s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_pd:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           9,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(from.0) == 9,
                      pages_owner.1(from.0) == current.0,
                      pages_type.1(to.0) == 0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0 |
                        12 - 1 - 9,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pd (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pd (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 pn.3!1109 = 4,
 (uintptr)@proc_table.0 = 0,
 page_index.1!1108 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 4,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 4792320,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 16,
 index.1 = 0,
 pages_ptr_to_int.0 = 4792320,
 procs_nr_ports.3 = [18 -> 0,
                     1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 17],
 procs_stack.1 = [16 -> 64,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [16 -> 512,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 17],
 procs_io_bitmap_b.1 = [1 -> 0,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 17],
 @proc_table->struct.proc::ipc_page.0 = [else -> 17],
 @proc_table->struct.proc::stack.0 = [else -> 64],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [64 -> 16,
                  512 -> 16,
                  16 -> 16,
                  4 -> 16,
                  0 -> 0,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 k!1658 = [else ->
           If(ULE(4, Var(0)),
              If(ULE(16, Var(0)),
                 If(ULE(64, Var(0)),
                    If(ULE(512, Var(0)),
                       If(ULE(8193, Var(0)), 8193, 512),
                       64),
                    16),
                 4),
              0)],
 @io_table.0 = [else -> 17],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 k!1657 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(16, Var(0)),
                 If(ULE(17, Var(0)),
                    If(ULE(18, Var(0)),
                       If(ULE(20, Var(0)),
                          If(ULE(32, Var(0)),
                             If(ULE(64, Var(0)),
                                If(ULE(65, Var(0)), 65, 64),
                                32),
                             20),
                          18),
                       17),
                    16),
                 1),
              0)],
 @pages.0 = [(0, 4, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [18 -> 0,
                    1 -> 0,
                    20 -> 0,
                    32 -> 0,
                    17 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 16],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 17],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [16 -> 3,
                  18 -> 0,
                  1 -> 0,
                  32 -> 0,
                  20 -> 0,
                  17 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 17],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 17],
 procs_ipc_size.1 = [else -> 17],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [18 -> 0,
                       1 -> 0,
                       20 -> 0,
                       32 -> 0,
                       17 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 17],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 17],
 procs_nr_pages.3 = [18 -> 0,
                     1 -> 0,
                     20 -> 0,
                     32 -> 0,
                     17 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1664 = [(0, 16) -> 3,
                                        else -> 0],
 pages_data.1 = [else -> 0],
 procs_nr_intremaps.3 = [18 -> 0,
                         1 -> 0,
                         20 -> 0,
                         32 -> 0,
                         17 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 16],
 procs_nr_children.3 = [18 -> 0,
                        1 -> 0,
                        20 -> 0,
                        32 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 files_refcnt.4 = [else -> 17],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 512],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 @page_desc_table->struct.page_desc::pid.0!1665 = [(0, 0) ->
                                        0,
                                        else -> 16],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [18 -> 0,
                        1 -> 0,
                        20 -> 0,
                        32 -> 0,
                        17 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 17],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
... != []

----------------------------------------------------------------------
Ran 1 test in 19.227s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_pt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, to.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           10,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(pn.3 == to.0,
                                        Extract(63,
                                        9,
                                        page_index.1) ==
                                        0),
                                       0,
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        (uintptr)@pages.0 +
                                        (to.0*32768)/8 |
                                        perm.0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 0,
                      pages_type.1(from.0) == 10,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(to.0 == pn.3,
                     0,
                     If(And(from.0 == pn.3,
                            index.1 == page_index.1),
                        UDiv(pages_ptr_to_int.0, 4096) +
                        to.0 <<
                        12 |
                        perm.0 |
                        12 - 1 - 10,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_pt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_pt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 2,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 4792320,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pn.3!1118 = 2,
 page_index.1!1117 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 to.0 = 1,
 index.1 = 0,
 pages_ptr_to_int.0 = 4792320,
 procs_nr_ports.3 = [32 -> 0,
                     4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [1 -> 16,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [1 -> 32,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 @pci_table.0 = [else -> 8192],
 procs_io_bitmap_b.1 = [4 -> 64,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 512],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 16],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [16 -> 1,
                  32 -> 1,
                  0 -> 1,
                  2 -> 1,
                  1 -> 0,
                  64 -> 4,
                  512 -> 4,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 k!1529 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(16, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(512, Var(0)),
                             If(ULE(8193, Var(0)),
                                8193,
                                512),
                             64),
                          32),
                       16),
                    2),
                 1),
              0)],
 @pages.0 = [(0, 2, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [32 -> 0,
                    4 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 k!1528 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    2),
                 1),
              0)],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  4 -> 0,
                  32 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [32 -> 0,
                       4 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [32 -> 0,
                     4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 pages_data.1 = [else -> 0],
 procs_nr_intremaps.3 = [32 -> 0,
                         4 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 procs_nr_children.3 = [32 -> 0,
                        4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 32],
 procs_io_bitmap_a.1 = [4 -> 512,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [32 -> 0,
                        4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::state.0!1535 = [(0, 1) -> 3,
                                        else -> 0],
 @page_desc_table->struct.page_desc::type.0!1534 = [(0, 0) ->
                                        4,
                                        (0, 1) -> 0,
                                        (0, 2) -> 10,
                                        else -> 2],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [16 -> 2,
                 32 -> 2,
                 0 -> 4,
                 1 -> 0,
                 2 -> 10,
... != []

----------------------------------------------------------------------
Ran 1 test in 20.230s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(512, to.0)),
                  If(@dmapage_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                     0,
                     If(Not(ULE(8192, from.0)),
                        If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                           11,
                           If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                              @current.0(0),
                              If(Or(Not(Extract(63,
                                        9,
                                        index.1) ==
                                        0),
                                    Not(Extract(63,
                                        2,
                                        perm.0) ==
                                        0)),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                 If(@pages.0(0,
                                        from.0,
                                        index.1) ==
                                    0,
                                    If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                       (uintptr)@dmapages.0 +
                                       (to.0*32768)/8 |
                                       perm.0,
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(512, to.0)),
                      dmapages_type.1(to.0) == 0,
                      Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 11,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Extract(63, 2, perm.0) == 0,
                      pages_data.1(from.0, index.1) == 0),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     dmapages_ptr_to_int.0 + to.0 << 12 |
                     perm.0,
                     pages_data.1(pn.3, page_index.1)),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_iommu_frame (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_iommu_frame (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 pn.3!1109 = 1,
 (uintptr)@proc_table.0 = 0,
 page_index.1!1108 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 perm.0 = 0,
 from.0 = 1,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 70368746274888,
 file_table_ptr_to_int.0 = 0,
 to.0 = 0,
 (uintptr)@dmapages.0 = 70368746274888,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_a.0!1520(Var(0),
                                        k!1514(Var(1)))],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [4 -> 0,
                    32 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 0],
 pages_data.1 = [else -> 0],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [4 -> 4,
                        32 -> 32,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [(0, 0) ->
                                        0,
                                        else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1521(Var(0),
                                        k!1515(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table->struct.proc::io_bitmap_a.0!1520 = [(0, 4) -> 4,
                                        else -> 32],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 @page_desc_table->struct.page_desc::type.0!1521 = [(0, 512) ->
                                        4,
                                        (0, 1) -> 11,
                                        else -> 2],
 procs_page_table_root.1 = [1 -> 512,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 k!1515 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(4, Var(0)),
                 If(ULE(32, Var(0)),
                    If(ULE(128, Var(0)),
                       If(ULE(512, Var(0)),
                          If(ULE(8193, Var(0)), 8193, 512),
                          128),
                       32),
                    4),
                 1),
              0)],
 procs_nr_fds.3 = [4 -> 0,
                   32 -> 0,
                   2 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 k!1514 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    2),
                 1),
              0)],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else ->
                                        @proc_table->struct.proc::io_bitmap_b.0!1524(Var(0),
                                        k!1514(Var(1)))],
 procs_nr_ports.3 = [4 -> 0,
                     32 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [1 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [4 -> 4,
                        32 -> 128,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [0 -> 1,
                  512 -> 1,
                  1 -> 1,
                  4 -> 4,
                  128 -> 32,
                  32 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1522 = [(0, 1) -> 3,
                                        else -> 0],
 @proc_table->struct.proc::io_bitmap_b.0!1524 = [(0, 4) -> 4,
                                        else -> 128],
 @pages.0 = [(0, 1, 0) -> 0,
             else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  4 -> 0,
                  32 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [4 -> 0,
                       32 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [4 -> 0,
                     32 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [4 -> 0,
                         32 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
... != []

----------------------------------------------------------------------
Ran 1 test in 15.430s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_map_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_iommu_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 11.540s

OK

Syscall sys_reclaim_iommu_frame:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_reclaim_iommu_frame (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 7.189s

OK

Syscall sys_reclaim_iommu_root:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_reclaim_iommu_root (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 5.484s

OK

Syscall sys_alloc_vector:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_vector (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 2.590s

OK

Syscall sys_reclaim_vector:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
True
does not imply
And(And(vectors_owner.1(vector.1) > 0,
        vectors_owner.1(vector.1) < 64),
    procs_state.1(vectors_owner.1(vector.1)) == 5,
    False) ==
(If(Not(ULE(63,
            18446744073709551615 +
            @vector_table.0(0, Concat(0, vector.1)))),
    If(@proc_table->struct.proc::state.0(0,
                                        @vector_table.0(0,
                                        Concat(0, vector.1))) ==
       5,
       If(@proc_table->struct.proc::nr_intremaps.0(0,
                                        @vector_table.0(0,
                                        Concat(0, vector.1))) ==
          0,
          0,
          4294967280),
       4294967283),
    4294967283) ==
 0)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_vector (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_vector (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 vector.1 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 40,
 pages_ptr_to_int.0 = 0,
 procs_nr_ports.3 = [1 -> 0,
                     48 -> 0,
                     44 -> 0,
                     41 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [40 -> 1,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [40 -> 1,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [1 -> 40,
                  0 -> 40,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    48 -> 0,
                    44 -> 0,
                    41 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 40],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [40 -> 3,
                  32 -> 5,
                  1 -> 0,
                  48 -> 0,
                  44 -> 0,
                  41 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       48 -> 0,
                       44 -> 0,
                       41 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     48 -> 0,
                     44 -> 0,
                     41 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [32 -> 0,
                         1 -> 0,
                         48 -> 0,
                         44 -> 0,
                         41 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        48 -> 0,
                        44 -> 0,
                        41 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 0],
 vectors_owner.1 = [0 -> 32,
                    else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 1],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        48 -> 0,
                        44 -> 0,
                        41 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::state.0!879 = [(0, 40) -> 3,
                                        (0, 32) -> 5,
                                        else -> 0],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 files_type.1 = [else -> 8192],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [1 -> 2,
                 0 -> 4,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!878(Var(0),
                                        k!873(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [40 -> 0,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 procs_ofile.1 = [else ->
                  @proc_table.0(0,
                                Var(0),
                                Concat(0, Var(1)))],
 pcipages_valid.1 = [else -> False],
 @proc_table.0 = [else -> 1],
 @proc_table.4 = [else -> 0],
 @proc_table->struct.proc::state.0 = [else ->
                                      @proc_table->struct.proc::state.0!879(Var(0),
                                        k!872(Var(1)))],
 procs_nr_fds.3 = [1 -> 0,
                   48 -> 0,
                   44 -> 0,
                   41 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_ipc_fd.1 = [else ->
                   @proc_table->struct.proc::ipc_fd.0(0,
... != []

----------------------------------------------------------------------
Ran 1 test in 4.173s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_intremap:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
iotlbinv.0 == iotlbinv.1
does not imply
iotlbinv.0 ==
If(And(Not(ULE(8, index.1)),
       intremaps_state.1(index.1) == 0,
       pci_owner.1(devid.1) == current.0,
       vectors_owner.1(vector.1) == current.0),
   True,
   iotlbinv.1)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_intremap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_intremap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 devid.1 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 vector.1 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 4,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 @pci_table.0 = [else -> 4],
 procs_nr_ports.3 = [1 -> 0,
                     6 -> 0,
                     8 -> 0,
                     16 -> 0,
                     32 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [4 -> 2048,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 intremaps_state.1 = [else -> 0],
 procs_hvm.1 = [4 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @intremap_table->struct.intremap::state.0 = [(0, 0) -> 0,
                                        else ->
                                        intremaps_state.1(Var(1))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 2048],
 @io_table.0 = [else -> 0],
 pages_owner.1 = [2048 -> 4,
                  0 -> 4,
                  512 -> 4,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [1 -> 0,
                    6 -> 0,
                    8 -> 0,
                    16 -> 0,
                    32 -> 0,
                    5 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 4],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [4 -> 3,
                  16 -> 0,
                  32 -> 0,
                  6 -> 0,
                  1 -> 0,
                  8 -> 0,
                  5 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 @page_desc_table->struct.page_desc::type.0!1758 = [(0, 512) ->
                                        4,
                                        else -> 2],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [1 -> 0,
                       6 -> 0,
                       8 -> 0,
                       16 -> 0,
                       32 -> 0,
                       5 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 @proc_table->struct.proc::state.0!1759 = [(0, 4) -> 3,
                                        else -> 0],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [1 -> 0,
                     6 -> 0,
                     8 -> 0,
                     16 -> 0,
                     32 -> 0,
                     5 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [1 -> 0,
                         6 -> 0,
                         8 -> 0,
                         16 -> 0,
                         32 -> 0,
                         5 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [1 -> 0,
                        6 -> 0,
                        8 -> 0,
                        16 -> 0,
                        32 -> 0,
                        5 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 512],
 vectors_owner.1 = [0 -> 4,
                    else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [1 -> 0,
                        6 -> 0,
                        8 -> 0,
                        16 -> 0,
                        32 -> 0,
                        5 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 k!1753 = [else ->
           If(ULE(512, Var(0)),
              If(ULE(2048, Var(0)),
                 If(ULE(8193, Var(0)), 8193, 2048),
                 512),
              0)],
 pages_type.1 = [2048 -> 2,
                 0 -> 2,
                 512 -> 4,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 k!1752 = [else ->
           If(ULE(4, Var(0)),
              If(ULE(5, Var(0)),
                 If(ULE(6, Var(0)),
... != []

----------------------------------------------------------------------
Ran 1 test in 8.943s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_reclaim_intremap:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
iotlbinv.0 == iotlbinv.1
does not imply
iotlbinv.0 ==
If(And(Not(ULE(8, index.1)),
       intremaps_state.1(index.1) == 1,
       And(procs_state.1(pci_owner.1(intremaps_devid.1(index.1))) ==
           5,
           Not(pci_owner.1(intremaps_devid.1(index.1)) <= 0),
           Not(64 <= pci_owner.1(intremaps_devid.1(index.1))))),
   True,
   iotlbinv.1)
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_reclaim_intremap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_reclaim_intremap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 48,
 index.1 = 0,
 pages_ptr_to_int.0 = 0,
 intremaps_state.1 = [else -> 1],
 @intremap_table->struct.intremap::state.0 = [(0, 0) -> 1,
                                        else ->
                                        intremaps_state.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0!1384 = [(0, 0) ->
                                        2,
                                        else -> 4],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [52 -> 0,
                    56 -> 0,
                    49 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 @proc_table->struct.proc::state.0!1385 = [(0, 48) -> 3,
                                        (0, 1) -> 5,
                                        else -> 0],
 dmapages_type.1 = [else -> 8192],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 0],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 procs_killed.1 = [else -> False],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1384(Var(0),
                                        k!1379(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 pci_owner.1 = [0 -> 1,
                else -> @pci_table.0(0, Concat(0, Var(0)))],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 procs_page_table_root.1 = [48 -> 2048,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [52 -> 0,
                   56 -> 0,
                   49 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 @pci_table.0 = [else -> 1],
 procs_nr_ports.3 = [52 -> 0,
                     56 -> 0,
                     49 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 procs_stack.1 = [48 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [48 -> 0,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 0],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [0 -> 48,
                  2048 -> 48,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 48],
 io_owner.1 = [0 -> 0,
               else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 k!1379 = [else ->
           If(ULE(2048, Var(0)),
              If(ULE(8193, Var(0)), 8193, 2048),
              0)],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [48 -> 3,
                  1 -> 5,
                  56 -> 0,
                  52 -> 0,
                  49 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 k!1378 = [else ->
           If(ULE(48, Var(0)),
              If(ULE(49, Var(0)),
                 If(ULE(52, Var(0)),
                    If(ULE(56, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          56),
                       52),
                    49),
                 48),
              1)],
 procs_nr_vectors.3 = [52 -> 0,
                       56 -> 0,
                       49 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 procs_nr_pages.3 = [52 -> 0,
                     56 -> 0,
                     49 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [52 -> 0,
                         56 -> 0,
                         49 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [52 -> 0,
                        56 -> 0,
                        49 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 2048],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 intremaps_vector.1 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @intremap_table->struct.intremap::devid.0 = [(0, 0) -> 0,
                                        else ->
                                        intremaps_devid.1(Var(1))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_nr_dmapages.3 = [52 -> 0,
                        56 -> 0,
                        49 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 files_type.1 = [else -> 8192],
 intremaps_devid.1 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
... != []

----------------------------------------------------------------------
Ran 1 test in 43.242s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_ack_intr:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_ack_intr (__main__.HV6) ... ERROR

======================================================================
ERROR: test_sys_ack_intr (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 47, in sys_ack_intr
    new.procs[new.current].intr[idx] = new.procs[new.current].intr(idx) & ~mask
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 3158, in __and__
    return BitVecRef(Z3_mk_bvand(self.ctx_ref(), a.as_ast(), b.as_ast()), self.ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3core.py", line 1749, in Z3_mk_bvand
    raise Z3Exception(lib().Z3_get_error_msg(a0, err))
Z3Exception: Argument (bvnot (bvshl #x01 (bvsmod vector.1 #x40))) at position 1 does not match declaration (declare-fun bvand ((_ BitVec 64) (_ BitVec 64)) (_ BitVec 64))

----------------------------------------------------------------------
Ran 1 test in 0.886s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_port:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_port (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 108.451s

OK

Syscall sys_reclaim_port:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_reclaim_port (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 2.918s

OK

Syscall sys_alloc_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_alloc_pdpt (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 42.045s

OK

Syscall sys_free_pdpt:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pn.0, page_index.0],
       Implies(And(ULT(pn.0, 8192), ULT(page_index.0, 512)),
               @pages.0(0, pn.0, page_index.0) ==
               pages_data.1(pn.0, page_index.0)))
does not imply
ForAll([pn.3, page_index.1],
       Implies(And(ULT(pn.3, 8192), ULT(page_index.1, 512)),
               If(Not(ULE(8192, from.0)),
                  If(@page_desc_table->struct.page_desc::type.0(0,
                                        from.0) ==
                     4,
                     If(@page_desc_table->struct.page_desc::pid.0(0,
                                        from.0) ==
                        @current.0(0),
                        If(And(Not(ULE(512, index.1)),
                               Not(ULE(8192, to.0))),
                           If(@page_desc_table->struct.page_desc::type.0(0,
                                        to.0) ==
                              5,
                              If(@page_desc_table->struct.page_desc::pid.0(0,
                                        to.0) ==
                                 @current.0(0),
                                 If(Extract(0,
                                        0,
                                        @pages.0(0,
                                        from.0,
                                        index.1)) ==
                                    0,
                                    @pages.0(0,
                                        pn.3,
                                        page_index.1),
                                    If(to.0 +
                                       Concat(0,
                                        Extract(63,
                                        12,
                                        (uintptr)@pages.0)) ==
                                       Concat(0,
                                        Extract(51,
                                        12,
                                        @pages.0(0,
                                        from.0,
                                        index.1))),
                                       If(And(from.0 == pn.3,
                                        index.1 ==
                                        page_index.1),
                                        0,
                                        @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                                       @pages.0(0,
                                        pn.3,
                                        page_index.1))),
                                 @pages.0(0,
                                        pn.3,
                                        page_index.1)),
                              @pages.0(0,
                                       pn.3,
                                       page_index.1)),
                           @pages.0(0, pn.3, page_index.1)),
                        @pages.0(0, pn.3, page_index.1)),
                     @pages.0(0, pn.3, page_index.1)),
                  @pages.0(0, pn.3, page_index.1)) ==
               If(And(Not(ULE(8192, from.0)),
                      pages_type.1(from.0) == 4,
                      pages_owner.1(from.0) == current.0,
                      Not(ULE(512, index.1)),
                      Not(ULE(8192, to.0)),
                      pages_type.1(to.0) == 5,
                      pages_owner.1(to.0) == current.0,
                      Not(Extract(0,
                                  0,
                                  pages_data.1(from.0,
                                        index.1)) ==
                          0),
                      Extract(63,
                              40,
                              Concat(0,
                                     Extract(63,
                                        12,
                                        pages_ptr_to_int.0)) +
                              to.0) ==
                      0,
                      Extract(51, 12, pages_ptr_to_int.0) +
                      Extract(39, 0, to.0) ==
                      Extract(51,
                              12,
                              pages_data.1(from.0, index.1))),
                  If(And(from.0 == pn.3,
                         index.1 == page_index.1),
                     0,
                     If(to.0 == pn.3,
                        0,
                        pages_data.1(pn.3, page_index.1))),
                  pages_data.1(pn.3, page_index.1))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_free_pdpt (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_free_pdpt (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 page_index.1!1101 = 4,
 (uintptr)@file_table.0 = 0,
 pn.3!1102 = 5124,
 from.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 1688849862377472,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 to.0 = 5124,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 index.1 = 0,
 pages_ptr_to_int.0 = 1688849862377472,
 procs_nr_ports.3 = [32 -> 0,
                     4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 1024,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [1 -> 8,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [2 -> 256,
                        else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 16],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 1024],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [1024 -> 1,
                  8 -> 1,
                  513 -> 1,
                  0 -> 1,
                  5124 -> 1,
                  256 -> 2,
                  16 -> 2,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 @pages.0 = [(0, 5124, 4) -> 1152921504606846976,
             (0, 0, 0) -> 1688849883365377,
             else -> pages_data.1(Var(1), Var(2))],
 procs_nr_devs.3 = [32 -> 0,
                    4 -> 0,
                    2 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 k!1507 = [else ->
           If(ULE(8, Var(0)),
              If(ULE(16, Var(0)),
                 If(ULE(256, Var(0)),
                    If(ULE(513, Var(0)),
                       If(ULE(1024, Var(0)),
                          If(ULE(5124, Var(0)),
                             If(ULE(8193, Var(0)),
                                8193,
                                5124),
                             1024),
                          513),
                       256),
                    16),
                 8),
              0)],
 procs_ipc_val.1 = [else -> 8192],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  32 -> 0,
                  4 -> 0,
                  2 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 k!1506 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          32),
                       4),
                    2),
                 1),
              0)],
 @proc_table.3 = [else -> 0],
 dmapages_owner.1 = [else -> 8192],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [32 -> 0,
                       4 -> 0,
                       2 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::pid.0!1514 = [(0, 16) ->
                                        2,
                                        (0, 256) -> 2,
                                        else -> 1],
 procs_nr_pages.3 = [32 -> 0,
                     4 -> 0,
                     2 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 pages_data.1 = [(5124, 4) -> 1152921504606846976,
                 else -> 1688849883365377],
 procs_nr_intremaps.3 = [32 -> 0,
                         4 -> 0,
                         2 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 513],
 procs_nr_children.3 = [32 -> 0,
                        4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::state.0!1513 = [(0, 1) -> 3,
                                        else -> 0],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 8],
 procs_io_bitmap_a.1 = [2 -> 16,
                        else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 files_refcnt.4 = [else -> 8192],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [32 -> 0,
                        4 -> 0,
                        2 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [1024 -> 2,
                 8 -> 2,
                 513 -> 4,
                 0 -> 4,
                 5124 -> 5,
... != []

----------------------------------------------------------------------
Ran 1 test in 21.291s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall clone_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_clone_proc (__main__.HV6) ... ERROR

======================================================================
ERROR: test_clone_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 541, in _syscall_generic
    model = self._prove(z3.And(spec.state_equiv(self.ctx, newstate),
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/equiv.py", line 239, in state_equiv
    getattr(module, k + '_equiv')(conj, ctx, kernelstate)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/equiv.py", line 133, in pages_equiv
    kernelstate.pages[pn].data(idx))))
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 41, in __call__
    return self._imap(instance)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 105, in __call__
    return self.__get__(instance)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 100, in __get__
    return self.get(f, instance._path)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 246, in get
    return fn(*args)
  File "/root/hyperkernel/irpy/libirpy/util.py", line 180, in <lambda>
    return lambda *args, **kwargs: If(cond, a(*args, **kwargs), b(*args, **kwargs))
  File "/root/hyperkernel/irpy/libirpy/util.py", line 347, in inner
    return If(cond, value, fn(*args))
  File "/root/hyperkernel/irpy/libirpy/util.py", line 347, in inner
    return If(cond, value, fn(*args))
  File "/root/hyperkernel/irpy/libirpy/util.py", line 203, in If
    raise ValueError("Can not ite object of type {!r}".format(type(a)))
ValueError: Can not ite object of type <class 'hv6py.base.Accessor'>

----------------------------------------------------------------------
Ran 1 test in 27.641s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall send_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_send_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_send_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 73, in send_proc
    new.pages[new.procs[pid].ipc_page].data = lambda idx, oldfn: \
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 23.118s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall reply_wait_proc:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_reply_wait_proc (__main__.HV6) ... FAIL

======================================================================
FAIL: test_reply_wait_proc (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 97, in reply_wait_proc
    new.procs[pid].ofile = lambda fd, oldfn: \
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 188, in __setattr__
    return super(Struct, self).__setattr__(attribute, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 109, in __set__
    instance._fields[self._name] = self.set(instance._fields[self._name], instance._path, value)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/base.py", line 253, in set
    assert not args
AssertionError

----------------------------------------------------------------------
Ran 1 test in 46.470s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_dup2:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll([pid.0, fd.0],
       Implies(And(And(pid.0 > 0, pid.0 < 64),
                   And(fd.0 >= 0, fd.0 < 16)),
               @proc_table.0(0, pid.0, ZeroExt(32, fd.0)) ==
               procs_ofile.1(pid.0, fd.0)))
does not imply
ForAll([pid.4, fd.3],
       Implies(And(And(pid.4 > 0, pid.4 < 64),
                   And(fd.3 >= 0, fd.3 < 16)),
               If(Not(ULE(63, 18446744073709551615 + pid.3)),
                  If(@current.0(0) == pid.3,
                     If(Not(ULE(16, oldfd.0)),
                        If(And(Not(ULE(16, newfd.0)),
                               Not(@proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, oldfd.0)) ==
                                   0)),
                           If(And(oldfd.0 == newfd.0,
                                  @current.0(0) == pid.3),
                              @proc_table.0(0,
                                        pid.4,
                                        ZeroExt(32, fd.3)),
                              If(And(pid.3 == pid.4,
                                     SignExt(32, newfd.0) ==
                                     Concat(0, fd.3)),
                                 @proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, oldfd.0)),
                                 @proc_table.0(0,
                                        pid.4,
                                        ZeroExt(32, fd.3)))),
                           @proc_table.0(0,
                                        pid.4,
                                        ZeroExt(32, fd.3))),
                        @proc_table.0(0,
                                      pid.4,
                                      ZeroExt(32, fd.3))),
                     If(@proc_table->struct.proc::ppid.0(0,
                                        pid.3) ==
                        @current.0(0),
                        If(@proc_table->struct.proc::state.0(0,
                                        pid.3) ==
                           1,
                           If(Not(ULE(16, oldfd.0)),
                              If(And(Not(ULE(16, newfd.0)),
                                     Not(@proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, oldfd.0)) ==
                                        0)),
                                 If(And(pid.3 == pid.4,
                                        SignExt(32, newfd.0) ==
                                        Concat(0, fd.3)),
                                    @proc_table.0(0,
                                        @current.0(0),
                                        SignExt(32, oldfd.0)),
                                    @proc_table.0(0,
                                        pid.4,
                                        ZeroExt(32, fd.3))),
                                 @proc_table.0(0,
                                        pid.4,
                                        ZeroExt(32, fd.3))),
                              @proc_table.0(0,
                                        pid.4,
                                        ZeroExt(32, fd.3))),
                           @proc_table.0(0,
                                        pid.4,
                                        ZeroExt(32, fd.3))),
                        @proc_table.0(0,
                                      pid.4,
                                      ZeroExt(32, fd.3)))),
                  @proc_table.0(0, pid.4, ZeroExt(32, fd.3))) ==
               If(And(And(Not(pid.3 <= 0), Not(64 <= pid.3)),
                      Or(pid.3 == current.0,
                         And(procs_ppid.1(pid.3) ==
                             current.0,
                             procs_state.1(pid.3) == 1)),
                      And(0 <= oldfd.0, Not(16 <= oldfd.0)),
                      And(0 <= newfd.0, Not(16 <= newfd.0)),
                      And(Not(procs_ofile.1(current.0,
                                        oldfd.0) ==
                              0),
                          Not(ULE(128,
                                  procs_ofile.1(current.0,
                                        oldfd.0))))),
                  If(And(current.0 == pid.3,
                         oldfd.0 == newfd.0),
                     procs_ofile.1(pid.4, fd.3),
                     If(And(Not(procs_ofile.1(pid.3,
                                        newfd.0) ==
                                0),
                            Not(ULE(128,
                                    procs_ofile.1(pid.3,
                                        newfd.0)))),
                        If(And(pid.3 == pid.4,
                               newfd.0 == fd.3),
                           0,
                           procs_ofile.1(pid.4, fd.3)),
                        If(And(pid.3 == pid.4,
                               newfd.0 == fd.3),
                           procs_ofile.1(current.0, oldfd.0),
                           procs_ofile.1(pid.4, fd.3)))),
                  procs_ofile.1(pid.4, fd.3))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_dup2 (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_dup2 (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 newfd.0 = 0,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 pid.4!1369 = 32,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 1,
 fd.3!1368 = 0,
 pid.3 = 32,
 pages_ptr_to_int.0 = 0,
 oldfd.0 = 1,
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 intremaps_state.1 = [else -> 8192],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else ->
                                      @proc_table->struct.proc::stack.0!1954(Var(0),
                                        k!1948(Var(1)))],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [4 -> 0,
                    34 -> 0,
                    36 -> 0,
                    2 -> 0,
                    33 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 procs_ipc_val.1 = [else -> 8192],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 1],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_ipc_from.1 = [else -> 8192],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 dmapages_type.1 = [else -> 8192],
 k!1951 = [else ->
           If(ULE(32, Var(0)),
              If(ULE(65, Var(0)), 65, 32),
              1)],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else ->
                                    @proc_table->struct.proc::hvm.0!1960(Var(0),
                                        k!1948(Var(1)))],
 k!1949 = [else ->
           If(ULE(4, Var(0)),
              If(ULE(32, Var(0)),
                 If(ULE(512, Var(0)),
                    If(ULE(4128, Var(0)),
                       If(ULE(8193, Var(0)), 8193, 4128),
                       512),
                    32),
                 4),
              0)],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 k!1948 = [else ->
           If(ULE(1, Var(0)),
              If(ULE(2, Var(0)),
                 If(ULE(4, Var(0)),
                    If(ULE(32, Var(0)),
                       If(ULE(33, Var(0)),
                          If(ULE(34, Var(0)),
                             If(ULE(36, Var(0)),
                                If(ULE(64, Var(0)),
                                   If(ULE(65, Var(0)),
                                      65,
                                      64),
                                   36),
                                34),
                             33),
                          32),
                       4),
                    2),
                 1),
              0)],
 procs_use_io_bitmap.1 = [else -> False],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 @proc_table->struct.proc::ppid.0 = [(0, 32) -> 1,
                                     else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1955(Var(0),
                                        k!1949(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table.0!1956 = [(0, 1, 1) -> 64, else -> 1],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
 pci_owner.1 = [else -> @pci_table.0(0, Concat(0, Var(0)))],
 procs_page_table_root.1 = [1 -> 4128,
                            32 -> 32,
                            else ->
                            @proc_table->struct.proc::page_table_root.0(0,
                                        Var(0))],
 @file_table->struct.file::type.0 = [else ->
                                     files_type.1(Var(1))],
 pcipages_valid.1 = [else -> False],
 procs_nr_fds.3 = [4 -> 0,
                   34 -> 0,
                   36 -> 0,
                   2 -> 0,
                   33 -> 0,
                   else ->
                   @proc_table->struct.proc::nr_fds.0(0,
                                        Var(0))],
 procs_intr.1 = [else -> 8192],
 @file_table->struct.file::value.0 = [else ->
                                      files_value.1(Var(1))],
 files_value.1 = [else -> 8192],
 @proc_table->struct.proc::state.0!1957 = [(0, 1) -> 3,
                                        (0, 32) -> 1,
                                        else -> 0],
 @proc_table->struct.proc::io_bitmap_b.0 = [else -> 8192],
 procs_nr_ports.3 = [4 -> 0,
                     34 -> 0,
                     36 -> 0,
                     2 -> 0,
                     33 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 @pci_table.0 = [else -> 8192],
 procs_stack.1 = [1 -> 0,
                  32 -> 4,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 procs_hvm.1 = [1 -> 0,
                32 -> 512,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 @io_table.0 = [else -> 8192],
 pages_owner.1 = [0 -> 1,
                  4128 -> 1,
                  4 -> 32,
                  512 -> 32,
                  32 -> 32,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 1],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 @proc_table->struct.proc::stack.0!1954 = [(0, 32) -> 4,
                                        else -> 0],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [1 -> 3,
                  32 -> 1,
                  36 -> 0,
                  34 -> 0,
                  4 -> 0,
                  2 -> 0,
                  33 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 procs_nr_vectors.3 = [4 -> 0,
                       34 -> 0,
                       36 -> 0,
                       2 -> 0,
                       33 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 @page_desc_table.0 = [else -> 0],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
... != []

----------------------------------------------------------------------
Ran 1 test in 37.952s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall sys_alloc_io_bitmap:
     PY2      hv6-verify
Using z3 v4.5.0.0
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Could not prove, trying to find a minimal ce
Can not minimize condition further
Precondition
ForAll(pn.0,
       Implies(ULT(pn.0, 8192),
               @page_desc_table->struct.page_desc::type.0(0,
                                        pn.0) ==
               pages_type.1(pn.0)))
does not imply
ForAll(pn.6,
       Implies(ULT(pn.6, 8192),
               If(And(pn.3 == 18446744073709551615 + pn.4,
                      pn.4 == 18446744073709551615 + pn.5),
                  If(@proc_table->struct.proc::use_io_bitmap.0(0,
                                        @current.0(0)) ==
                     0,
                     If(Not(ULE(8192, pn.3)),
                        If(And(Not(ULE(8192, pn.4)),
                               @page_desc_table->struct.page_desc::type.0(0,
                                        pn.3) ==
                               0),
                           If(And(Not(ULE(8192, pn.5)),
                                  @page_desc_table->struct.page_desc::type.0(0,
                                        pn.4) ==
                                  0),
                              If(@page_desc_table->struct.page_desc::type.0(0,
                                        pn.5) ==
                                 0,
                                 If(pn.5 == pn.6,
                                    2,
                                    If(pn.4 == pn.6,
                                       2,
                                       If(pn.3 == pn.6,
                                        2,
                                        @page_desc_table->struct.page_desc::type.0(0,
                                        pn.6)))),
                                 @page_desc_table->struct.page_desc::type.0(0,
                                        pn.6)),
                              @page_desc_table->struct.page_desc::type.0(0,
                                        pn.6)),
                           @page_desc_table->struct.page_desc::type.0(0,
                                        pn.6)),
                        @page_desc_table->struct.page_desc::type.0(0,
                                        pn.6)),
                     @page_desc_table->struct.page_desc::type.0(0,
                                        pn.6)),
                  @page_desc_table->struct.page_desc::type.0(0,
                                        pn.6)) ==
               If(And(pn.3 == 18446744073709551615 + pn.4,
                      pn.4 == 18446744073709551615 + pn.5,
                      Not(ULE(8192, pn.3)),
                      Not(ULE(8192, pn.4)),
                      Not(ULE(8192, pn.5)),
                      Not(procs_use_io_bitmap.1(current.0)),
                      pages_type.1(pn.3) == 0,
                      pages_type.1(pn.4) == 0,
                      pages_type.1(pn.5) == 0),
                  If(pn.4 == pn.6,
                     2,
                     If(pn.3 == pn.6, 2, pages_type.1(pn.6))),
                  pages_type.1(pn.6))))
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_sys_alloc_io_bitmap (__main__.HV6) ... FAIL

======================================================================
FAIL: test_sys_alloc_io_bitmap (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 544, in _syscall_generic
    return_model=INTERACTIVE)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 443, in _prove
    self._prove(i[0], pre=i[1])
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 454, in _prove
    self.assertEquals(model, [])
AssertionError: [devices_ptr_to_int.0 = 0,
 (uintptr)@page_desc_table.0 = 0,
 pn.5 = 4096,
 proc_table_ptr_to_int.0 = 0,
 (uintptr)@proc_table.0 = 0,
 page_desc_table_ptr_to_int.0 = 0,
 pn.6!1250 = 4096,
 (uintptr)@file_table.0 = 0,
 iotlbinv.0 = False,
 (uintptr)@pages.0 = 0,
 dmapages_ptr_to_int.0 = 0,
 file_table_ptr_to_int.0 = 0,
 (uintptr)@dmapages.0 = 0,
 (uintptr)@devices.1 = 0,
 iotlbinv.1 = False,
 current.0 = 36,
 pn.3 = 4094,
 pn.4 = 4095,
 pages_ptr_to_int.0 = 0,
 procs_nr_ports.3 = [48 -> 0,
                     1 -> 0,
                     40 -> 0,
                     37 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_ports.0(0,
                                        Var(0))],
 k!1660 = [else ->
           If(ULE(36, Var(0)),
              If(ULE(37, Var(0)),
                 If(ULE(40, Var(0)),
                    If(ULE(48, Var(0)),
                       If(ULE(64, Var(0)),
                          If(ULE(65, Var(0)), 65, 64),
                          48),
                       40),
                    37),
                 36),
              1)],
 procs_stack.1 = [36 -> 0,
                  else ->
                  @proc_table->struct.proc::stack.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::state.0 = [else ->
                                        intremaps_state.1(Var(1))],
 procs_hvm.1 = [36 -> 64,
                else ->
                @proc_table->struct.proc::hvm.0(0, Var(0))],
 @proc_table->struct.proc::killed.0 = [else -> 0],
 @pci_table.0 = [else -> 8192],
 intremaps_state.1 = [else -> 8192],
 procs_io_bitmap_b.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_b.0(0,
                                        Var(0))],
 @proc_table->struct.proc::io_bitmap_a.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_page.0 = [else -> 8192],
 @proc_table->struct.proc::stack.0 = [else -> 0],
 @proc_table->struct.proc::ipc_fd.0 = [else -> 16],
 pages_owner.1 = [0 -> 36,
                  64 -> 36,
                  16 -> 36,
                  4094 -> 576460752303423488,
                  4095 -> 576460752303423488,
                  4096 -> 9223372036854775824,
                  else ->
                  @page_desc_table->struct.page_desc::pid.0(0,
                                        Var(0))],
 @io_table.0 = [else -> 8192],
 @proc_table->struct.proc::ipc_from.0 = [else ->
                                        procs_ipc_from.1(Var(1))],
 procs_nr_devs.3 = [48 -> 0,
                    1 -> 0,
                    40 -> 0,
                    37 -> 0,
                    else ->
                    @proc_table->struct.proc::nr_devs.0(0,
                                        Var(0))],
 @pages.0 = [else -> pages_data.1(Var(1), Var(2))],
 @current.0 = [else -> 36],
 io_owner.1 = [else -> @io_table.0(0, Concat(0, Var(0)))],
 @proc_table->struct.proc::nr_dmapages.0 = [else -> 0],
 procs_ipc_val.1 = [else -> 8192],
 @page_desc_table->struct.page_desc::pid.0!1668 = [(0, 4094) ->
                                        576460752303423488,
                                        (0, 4095) ->
                                        576460752303423488,
                                        (0, 4096) ->
                                        9223372036854775824,
                                        else -> 36],
 procs_tlbinv.1 = [else -> False],
 procs_state.1 = [36 -> 3,
                  48 -> 0,
                  1 -> 0,
                  40 -> 0,
                  37 -> 0,
                  else ->
                  @proc_table->struct.proc::state.0(0,
                                        Var(0))],
 @proc_table->struct.proc::nr_ports.0 = [else -> 0],
 @intremap_table->struct.intremap::vector.0 = [else ->
                                        intremaps_vector.1(Var(1))],
 dmapages_owner.1 = [else -> 8192],
 @proc_table.3 = [else -> 0],
 procs_ppid.1 = [else -> 8192],
 procs_ipc_size.1 = [else -> 8192],
 @proc_table->struct.proc::nr_children.0 = [else -> 0],
 procs_nr_vectors.3 = [48 -> 0,
                       1 -> 0,
                       40 -> 0,
                       37 -> 0,
                       else ->
                       @proc_table->struct.proc::nr_vectors.0(0,
                                        Var(0))],
 procs_ipc_from.1 = [else -> 8192],
 @page_desc_table.0 = [else -> 0],
 @file_table->struct.file::omode.0 = [else ->
                                      files_omode.1(Var(1))],
 procs_ipc_page.1 = [else ->
                     @proc_table->struct.proc::ipc_page.0(0,
                                        Var(0))],
 dmapages_type.1 = [else -> 8192],
 procs_nr_pages.3 = [48 -> 0,
                     1 -> 0,
                     40 -> 0,
                     37 -> 0,
                     else ->
                     @proc_table->struct.proc::nr_pages.0(0,
                                        Var(0))],
 procs_nr_intremaps.3 = [48 -> 0,
                         1 -> 0,
                         40 -> 0,
                         37 -> 0,
                         else ->
                         @proc_table->struct.proc::nr_intremaps.0(0,
                                        Var(0))],
 procs_nr_children.3 = [48 -> 0,
                        1 -> 0,
                        40 -> 0,
                        37 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_children.0(0,
                                        Var(0))],
 @proc_table->struct.proc::page_table_root.0 = [else -> 16],
 vectors_owner.1 = [else ->
                    @vector_table.0(0, Concat(0, Var(0)))],
 pages_data.1 = [else -> 8192],
 files_refcnt.4 = [else -> 8192],
 @proc_table->struct.proc::nr_vectors.0 = [else -> 0],
 @proc_table->struct.proc::nr_pages.0 = [else -> 0],
 @page_desc_table.1 = [else -> 0],
 @proc_table->struct.proc::hvm.0 = [else -> 64],
 @proc_table->struct.proc::ipc_size.0 = [else ->
                                        procs_ipc_size.1(Var(1))],
 procs_io_bitmap_a.1 = [else ->
                        @proc_table->struct.proc::io_bitmap_a.0(0,
                                        Var(0))],
 @intremap_table->struct.intremap::devid.0 = [else ->
                                        intremaps_devid.1(Var(1))],
 pcipages_owner.1 = [else -> 0],
 intremaps_vector.1 = [else -> 0],
 @proc_table->struct.proc::ipc_val.0 = [else ->
                                        procs_ipc_val.1(Var(1))],
 procs_use_io_bitmap.1 = [else -> False],
 procs_nr_dmapages.3 = [48 -> 0,
                        1 -> 0,
                        40 -> 0,
                        37 -> 0,
                        else ->
                        @proc_table->struct.proc::nr_dmapages.0(0,
                                        Var(0))],
 @dmapage_desc_table->struct.page_desc::type.0 = [else ->
                                        dmapages_type.1(Var(1))],
 @file_table->struct.file::refcnt.0 = [else ->
                                       files_refcnt.4(Var(1))],
 procs_killed.1 = [else -> False],
 files_type.1 = [else -> 8192],
 @proc_table->struct.proc::use_io_bitmap.0 = [else -> 0],
 intremaps_devid.1 = [else -> 0],
 @proc_table->struct.proc::nr_devs.0 = [else -> 0],
 @file_table->struct.file::offset.0 = [else ->
                                       files_offset.1(Var(1))],
 @proc_table->struct.proc::nr_fds.0 = [else -> 0],
 pages_type.1 = [0 -> 2,
                 64 -> 2,
                 16 -> 4,
                 4094 -> 0,
                 4095 -> 0,
                 4096 -> 0,
                 else ->
                 @page_desc_table->struct.page_desc::type.0(0,
                                        Var(0))],
 @proc_table->struct.proc::ppid.0 = [else ->
                                     procs_ppid.1(Var(1))],
 @page_desc_table->struct.page_desc::type.0 = [else ->
                                        @page_desc_table->struct.page_desc::type.0!1666(Var(0),
                                        k!1661(Var(1)))],
 @pcipages->struct.pcipage_desc::devid.0 = [else ->
                                        pcipages_owner.1(Var(1))],
 @proc_table->struct.proc::state.0!1667 = [(0, 36) -> 3,
                                        else -> 0],
 @proc_table.1 = [else -> procs_intr.1(Var(1), Var(2))],
... != []

----------------------------------------------------------------------
Ran 1 test in 27.535s

FAILED (failures=1)
make: *** [hv6-verify] Error 1

Syscall extintr:
     PY2      hv6-verify
Using z3 v4.5.0.0
hv6/Makefrag:169: recipe for target 'hv6-verify' failed

test_extintr (__main__.HV6) ... ERROR

======================================================================
ERROR: test_extintr (__main__.HV6)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 407, in <lambda>
    self._syscall_generic(syscall)
  File "o.x86_64/hv6/hv6py/kernel/spec/main.py", line 540, in _syscall_generic
    cond, newstate = getattr(spec, name)(self.state, *args)
  File "/root/hyperkernel/o.x86_64/hv6/hv6py/kernel/spec/spec/specs.py", line 53, in extintr
    new.procs[pid].intr[word_idx] = new.procs[pid].intr(word_idx) | bit_mask
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3.py", line 3135, in __or__
    return BitVecRef(Z3_mk_bvor(self.ctx_ref(), a.as_ast(), b.as_ast()), self.ctx)
  File "/root/Projects/z3-z3-4.5.0/build/python/z3/z3core.py", line 1756, in Z3_mk_bvor
    raise Z3Exception(lib().Z3_get_error_msg(a0, err))
Z3Exception: Argument (bvshl #x01 (bvsmod vector.1 #x40)) at position 1 does not match declaration (declare-fun bvor ((_ BitVec 64) (_ BitVec 64)) (_ BitVec 64))

----------------------------------------------------------------------
Ran 1 test in 2.137s

FAILED (errors=1)
make: *** [hv6-verify] Error 1

Syscall sys_map_pml4:
     PY2      hv6-verify
Using z3 v4.5.0.0

test_sys_map_pml4 (__main__.HV6) ... ok

----------------------------------------------------------------------
Ran 1 test in 19.138s

OK
